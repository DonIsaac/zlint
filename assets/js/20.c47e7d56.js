/*! For license information please see 20.c47e7d56.js.LICENSE.txt */
(self.webpackChunkzlint=self.webpackChunkzlint||[]).push([[20],{4336:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});n(6540);var r=n(4164),i=n(1312),s=n(7559),o=n(8774);const a={iconEdit:"iconEdit_Z9Sw"};var c=n(4848);function l({className:e,...t}){return(0,c.jsx)("svg",{fill:"currentColor",height:"20",width:"20",viewBox:"0 0 40 40",className:(0,r.A)(a.iconEdit,e),"aria-hidden":"true",...t,children:(0,c.jsx)("g",{children:(0,c.jsx)("path",{d:"m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"})})})}function d({editUrl:e}){return(0,c.jsxs)(o.A,{to:e,className:s.G.common.editThisPage,children:[(0,c.jsx)(l,{}),(0,c.jsx)(i.A,{id:"theme.common.editThisPage",description:"The link label to edit the current page",children:"Edit this page"})]})}var u=n(6266);function h({lastUpdatedAt:e}){const t=new Date(e),n=(0,u.i)({day:"numeric",month:"short",year:"numeric",timeZone:"UTC"}).format(t);return(0,c.jsx)(i.A,{id:"theme.lastUpdated.atDate",description:"The words used to describe on which date a page has been last updated",values:{date:(0,c.jsx)("b",{children:(0,c.jsx)("time",{dateTime:t.toISOString(),itemProp:"dateModified",children:n})})},children:" on {date}"})}function p({lastUpdatedBy:e}){return(0,c.jsx)(i.A,{id:"theme.lastUpdated.byUser",description:"The words used to describe by who the page has been last updated",values:{user:(0,c.jsx)("b",{children:e})},children:" by {user}"})}function f({lastUpdatedAt:e,lastUpdatedBy:t}){return(0,c.jsxs)("span",{className:s.G.common.lastUpdated,children:[(0,c.jsx)(i.A,{id:"theme.lastUpdated.lastUpdatedAtBy",description:"The sentence used to display when a page has been last updated, and by who",values:{atDate:e?(0,c.jsx)(h,{lastUpdatedAt:e}):"",byUser:t?(0,c.jsx)(p,{lastUpdatedBy:t}):""},children:"Last updated{atDate}{byUser}"}),!1]})}const m={lastUpdated:"lastUpdated_JAkA"};function g({className:e,editUrl:t,lastUpdatedAt:n,lastUpdatedBy:i}){return(0,c.jsxs)("div",{className:(0,r.A)("row",e),children:[(0,c.jsx)("div",{className:"col",children:t&&(0,c.jsx)(d,{editUrl:t})}),(0,c.jsx)("div",{className:(0,r.A)("col",m.lastUpdated),children:(n||i)&&(0,c.jsx)(f,{lastUpdatedAt:n,lastUpdatedBy:i})})]})}},4722:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(6540);const i=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),o=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const c=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:l,iconNode:d,...u},h)=>(0,r.createElement)("svg",{ref:h,...a,width:t,height:t,stroke:e,strokeWidth:i?24*Number(n)/Number(t):n,className:s("lucide",c),...!l&&!o(u)&&{"aria-hidden":"true"},...u},[...d.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(l)?l:[l]])),l=(e,t)=>{const n=(0,r.forwardRef)(({className:n,...o},a)=>{return(0,r.createElement)(c,{ref:a,iconNode:t,className:s(`lucide-${l=i(e),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...o});var l});return n.displayName=i(e),n}},5184:(e,t,n)=>{"use strict";n.d(t,{A:()=>Re});var r=n(6540),i=n(5260),s=n(2303),o=n(4164),a=n(5293),c=n(6342);function l(){const{prism:e}=(0,c.p)(),{colorMode:t}=(0,a.G)(),n=e.theme,r=e.darkTheme||n;return"dark"===t?r:n}var d=n(7559),u=n(8426),h=n.n(u),p=n(9532),f=n(4848);const m=/title=(?<quote>["'])(?<title>.*?)\1/,g=/\{(?<range>[\d,-]+)\}/,b={js:{start:"\\/\\/",end:""},jsBlock:{start:"\\/\\*",end:"\\*\\/"},jsx:{start:"\\{\\s*\\/\\*",end:"\\*\\/\\s*\\}"},bash:{start:"#",end:""},html:{start:"\x3c!--",end:"--\x3e"}},y={...b,lua:{start:"--",end:""},wasm:{start:"\\;\\;",end:""},tex:{start:"%",end:""},vb:{start:"['\u2018\u2019]",end:""},vbnet:{start:"(?:_\\s*)?['\u2018\u2019]",end:""},rem:{start:"[Rr][Ee][Mm]\\b",end:""},f90:{start:"!",end:""},ml:{start:"\\(\\*",end:"\\*\\)"},cobol:{start:"\\*>",end:""}},x=Object.keys(b);function v(e,t){const n=e.map(e=>{const{start:n,end:r}=y[e];return`(?:${n}\\s*(${t.flatMap(e=>[e.line,e.block?.start,e.block?.end].filter(Boolean)).join("|")})\\s*${r})`}).join("|");return new RegExp(`^\\s*(?:${n})\\s*$`)}function $({showLineNumbers:e,metastring:t}){return"boolean"==typeof e?e?1:void 0:"number"==typeof e?e:function(e){const t=e?.split(" ").find(e=>e.startsWith("showLineNumbers"));if(t){if(t.startsWith("showLineNumbers=")){const e=t.replace("showLineNumbers=","");return parseInt(e,10)}return 1}}(t)}function k(e,t){const{language:n,magicComments:r}=t;if(void 0===n)return{lineClassNames:{},code:e};const i=function(e,t){switch(e){case"js":case"javascript":case"ts":case"typescript":return v(["js","jsBlock"],t);case"jsx":case"tsx":return v(["js","jsBlock","jsx"],t);case"html":return v(["js","jsBlock","html"],t);case"python":case"py":case"bash":return v(["bash"],t);case"markdown":case"md":return v(["html","jsx","bash"],t);case"tex":case"latex":case"matlab":return v(["tex"],t);case"lua":case"haskell":return v(["lua"],t);case"sql":return v(["lua","jsBlock"],t);case"wasm":return v(["wasm"],t);case"vb":case"vba":case"visual-basic":return v(["vb","rem"],t);case"vbnet":return v(["vbnet","rem"],t);case"batch":return v(["rem"],t);case"basic":return v(["rem","f90"],t);case"fsharp":return v(["js","ml"],t);case"ocaml":case"sml":return v(["ml"],t);case"fortran":return v(["f90"],t);case"cobol":return v(["cobol"],t);default:return v(x,t)}}(n,r),s=e.split(/\r?\n/),o=Object.fromEntries(r.map(e=>[e.className,{start:0,range:""}])),a=Object.fromEntries(r.filter(e=>e.line).map(({className:e,line:t})=>[t,e])),c=Object.fromEntries(r.filter(e=>e.block).map(({className:e,block:t})=>[t.start,e])),l=Object.fromEntries(r.filter(e=>e.block).map(({className:e,block:t})=>[t.end,e]));for(let u=0;u<s.length;){const e=s[u].match(i);if(!e){u+=1;continue}const t=e.slice(1).find(e=>void 0!==e);a[t]?o[a[t]].range+=`${u},`:c[t]?o[c[t]].start=u:l[t]&&(o[l[t]].range+=`${o[l[t]].start}-${u-1},`),s.splice(u,1)}const d={};return Object.entries(o).forEach(([e,{range:t}])=>{h()(t).forEach(t=>{d[t]??=[],d[t].push(e)})}),{code:s.join("\n"),lineClassNames:d}}function w(e,t){const n=e.replace(/\r?\n$/,"");return function(e,{metastring:t,magicComments:n}){if(t&&g.test(t)){const r=t.match(g).groups.range;if(0===n.length)throw new Error(`A highlight range has been given in code block's metastring (\`\`\` ${t}), but no magic comment config is available. Docusaurus applies the first magic comment entry's className for metastring ranges.`);const i=n[0].className,s=h()(r).filter(e=>e>0).map(e=>[e-1,[i]]);return{lineClassNames:Object.fromEntries(s),code:e}}return null}(n,{...t})??k(n,{...t})}function A(e){const t=function(e){return t=e.language??function(e){if(!e)return;const t=e.split(" ").find(e=>e.startsWith("language-"));return t?.replace(/language-/,"")}(e.className)??e.defaultLanguage,t?.toLowerCase()??"text";var t}({language:e.language,defaultLanguage:e.defaultLanguage,className:e.className}),{lineClassNames:n,code:r}=w(e.code,{metastring:e.metastring,magicComments:e.magicComments,language:t}),i=function({className:e,language:t}){return(0,o.A)(e,t&&!e?.includes(`language-${t}`)&&`language-${t}`)}({className:e.className,language:t}),s=(a=e.metastring,(a?.match(m)?.groups.title??"")||e.title);var a;const c=$({showLineNumbers:e.showLineNumbers,metastring:e.metastring});return{codeInput:e.code,code:r,className:i,language:t,title:s,lineNumbersStart:c,lineClassNames:n}}const j=(0,r.createContext)(null);function N({metadata:e,wordWrap:t,children:n}){const i=(0,r.useMemo)(()=>({metadata:e,wordWrap:t}),[e,t]);return(0,f.jsx)(j.Provider,{value:i,children:n})}function I(){const e=(0,r.useContext)(j);if(null===e)throw new p.dV("CodeBlockContextProvider");return e}const O="codeBlockContainer_Ckt0";function S({as:e,...t}){const n=function(e){const t={color:"--prism-color",backgroundColor:"--prism-background-color"},n={};return Object.entries(e.plain).forEach(([e,r])=>{const i=t[e];i&&"string"==typeof r&&(n[i]=r)}),n}(l());return(0,f.jsx)(e,{...t,style:n,className:(0,o.A)(t.className,O,d.G.common.codeBlock)})}const C="codeBlock_bY9V",q="codeBlockStandalone_MEMb",B="codeBlockLines_e6Vv",R="codeBlockLinesWithNumbering_o6Pm";function E({children:e,className:t}){return(0,f.jsx)(S,{as:"pre",tabIndex:0,className:(0,o.A)(q,"thin-scrollbar",t),children:(0,f.jsx)("code",{className:B,children:e})})}const K={attributes:!0,characterData:!0,childList:!0,subtree:!0};function L(e,t){const[n,i]=(0,r.useState)(),s=(0,r.useCallback)(()=>{i(e.current?.closest("[role=tabpanel][hidden]"))},[e,i]);(0,r.useEffect)(()=>{s()},[s]),function(e,t,n=K){const i=(0,p._q)(t),s=(0,p.Be)(n);(0,r.useEffect)(()=>{const t=new MutationObserver(i);return e&&t.observe(e,s),()=>t.disconnect()},[e,i,s])}(n,e=>{e.forEach(e=>{"attributes"===e.type&&"hidden"===e.attributeName&&(t(),s())})},{attributes:!0,characterData:!1,childList:!1,subtree:!1})}function D({children:e}){return e}var M=n(1765);function z({line:e,token:t,...n}){return(0,f.jsx)("span",{...n})}const U="codeLine_lJS_",F="codeLineNumber_Tfdd",T="codeLineContent_feaV";function P({line:e,classNames:t,showLineNumbers:n,getLineProps:r,getTokenProps:i}){const s=function(e){const t=1===e.length&&"\n"===e[0].content?e[0]:void 0;return t?[{...t,content:""}]:e}(e),a=r({line:s,className:(0,o.A)(t,n&&U)}),c=s.map((e,t)=>{const n=i({token:e});return(0,f.jsx)(z,{...n,line:s,token:e,children:n.children},t)});return(0,f.jsxs)("span",{...a,children:[n?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{className:F}),(0,f.jsx)("span",{className:T,children:c})]}):c,(0,f.jsx)("br",{})]})}const _=r.forwardRef((e,t)=>(0,f.jsx)("pre",{ref:t,tabIndex:0,...e,className:(0,o.A)(e.className,C,"thin-scrollbar")}));function J(e){const{metadata:t}=I();return(0,f.jsx)("code",{...e,className:(0,o.A)(e.className,B,void 0!==t.lineNumbersStart&&R),style:{...e.style,counterReset:void 0===t.lineNumbersStart?void 0:"line-count "+(t.lineNumbersStart-1)}})}function V({className:e}){const{metadata:t,wordWrap:n}=I(),r=l(),{code:i,language:s,lineNumbersStart:a,lineClassNames:c}=t;return(0,f.jsx)(M.f4,{theme:r,code:i,language:s,children:({className:t,style:r,tokens:i,getLineProps:s,getTokenProps:l})=>(0,f.jsx)(_,{ref:n.codeBlockRef,className:(0,o.A)(e,t),style:r,children:(0,f.jsx)(J,{children:i.map((e,t)=>(0,f.jsx)(P,{line:e,getLineProps:s,getTokenProps:l,classNames:c[t],showLineNumbers:void 0!==a},t))})})})}function W({children:e,fallback:t}){return(0,s.A)()?(0,f.jsx)(f.Fragment,{children:e?.()}):t??null}var H=n(1312);function G({className:e,...t}){return(0,f.jsx)("button",{type:"button",...t,className:(0,o.A)("clean-btn",e)})}function Z(e){return(0,f.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,f.jsx)("path",{fill:"currentColor",d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"})})}function Y(e){return(0,f.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,f.jsx)("path",{fill:"currentColor",d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})})}const Q={copyButtonCopied:"copyButtonCopied_Vdqa",copyButtonIcons:"copyButtonIcons_IEyt",copyButtonIcon:"copyButtonIcon_TrPX",copyButtonSuccessIcon:"copyButtonSuccessIcon_cVMy"};function X(e){return e?(0,H.T)({id:"theme.CodeBlock.copied",message:"Copied",description:"The copied button label on code blocks"}):(0,H.T)({id:"theme.CodeBlock.copyButtonAriaLabel",message:"Copy code to clipboard",description:"The ARIA label for copy code blocks button"})}function ee(){const{metadata:{code:e}}=I(),[t,n]=(0,r.useState)(!1),i=(0,r.useRef)(void 0),s=(0,r.useCallback)(()=>{!function(e,{target:t=document.body}={}){if("string"!=typeof e)throw new TypeError(`Expected parameter \`text\` to be a \`string\`, got \`${typeof e}\`.`);const n=document.createElement("textarea"),r=document.activeElement;n.value=e,n.setAttribute("readonly",""),n.style.contain="strict",n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt";const i=document.getSelection(),s=i.rangeCount>0&&i.getRangeAt(0);t.append(n),n.select(),n.selectionStart=0,n.selectionEnd=e.length;let o=!1;try{o=document.execCommand("copy")}catch{}n.remove(),s&&(i.removeAllRanges(),i.addRange(s)),r&&r.focus()}(e),n(!0),i.current=window.setTimeout(()=>{n(!1)},1e3)},[e]);return(0,r.useEffect)(()=>()=>window.clearTimeout(i.current),[]),{copyCode:s,isCopied:t}}function te({className:e}){const{copyCode:t,isCopied:n}=ee();return(0,f.jsx)(G,{"aria-label":X(n),title:(0,H.T)({id:"theme.CodeBlock.copy",message:"Copy",description:"The copy button label on code blocks"}),className:(0,o.A)(e,Q.copyButton,n&&Q.copyButtonCopied),onClick:t,children:(0,f.jsxs)("span",{className:Q.copyButtonIcons,"aria-hidden":"true",children:[(0,f.jsx)(Z,{className:Q.copyButtonIcon}),(0,f.jsx)(Y,{className:Q.copyButtonSuccessIcon})]})})}function ne(e){return(0,f.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,f.jsx)("path",{fill:"currentColor",d:"M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"})})}const re="wordWrapButtonIcon_b1P5",ie="wordWrapButtonEnabled_uzNF";function se({className:e}){const{wordWrap:t}=I();if(!(t.isEnabled||t.isCodeScrollable))return!1;const n=(0,H.T)({id:"theme.CodeBlock.wordWrapToggle",message:"Toggle word wrap",description:"The title attribute for toggle word wrapping button of code block lines"});return(0,f.jsx)(G,{onClick:()=>t.toggle(),className:(0,o.A)(e,t.isEnabled&&ie),"aria-label":n,title:n,children:(0,f.jsx)(ne,{className:re,"aria-hidden":"true"})})}const oe="buttonGroup_M5ko";function ae({className:e}){return(0,f.jsx)(W,{children:()=>(0,f.jsxs)("div",{className:(0,o.A)(e,oe),children:[(0,f.jsx)(se,{}),(0,f.jsx)(te,{})]})})}const ce="codeBlockContent_QJqH",le="codeBlockTitle_OeMC";function de({className:e}){const{metadata:t}=I();return(0,f.jsxs)(S,{as:"div",className:(0,o.A)(e,t.className),children:[t.title&&(0,f.jsx)("div",{className:le,children:(0,f.jsx)(D,{children:t.title})}),(0,f.jsxs)("div",{className:ce,children:[(0,f.jsx)(V,{}),(0,f.jsx)(ae,{})]})]})}function ue(e){const t=function(e){const{prism:t}=(0,c.p)();return A({code:e.children,className:e.className,metastring:e.metastring,magicComments:t.magicComments,defaultLanguage:t.defaultLanguage,language:e.language,title:e.title,showLineNumbers:e.showLineNumbers})}(e),n=function(){const[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),s=(0,r.useRef)(null),o=(0,r.useCallback)(()=>{const n=s.current.querySelector("code");e?n.removeAttribute("style"):(n.style.whiteSpace="pre-wrap",n.style.overflowWrap="anywhere"),t(e=>!e)},[s,e]),a=(0,r.useCallback)(()=>{const{scrollWidth:e,clientWidth:t}=s.current,n=e>t||s.current.querySelector("code").hasAttribute("style");i(n)},[s]);return L(s,a),(0,r.useEffect)(()=>{a()},[e,a]),(0,r.useEffect)(()=>(window.addEventListener("resize",a,{passive:!0}),()=>{window.removeEventListener("resize",a)}),[a]),{codeBlockRef:s,isEnabled:e,isCodeScrollable:n,toggle:o}}();return(0,f.jsx)(N,{metadata:t,wordWrap:n,children:(0,f.jsx)(de,{})})}function he({children:e,...t}){const n=(0,s.A)(),i=function(e){return r.Children.toArray(e).some(e=>(0,r.isValidElement)(e))?e:Array.isArray(e)?e.join(""):e}(e),o="string"==typeof i?ue:E;return(0,f.jsx)(o,{...t,children:i},String(n))}function pe(e){return(0,f.jsx)("code",{...e})}var fe=n(8774);var me=n(3427),ge=n(1422);const be="details_lb9f",ye="isBrowser_bmU9",xe="collapsibleContent_i85q";function ve(e){return!!e&&("SUMMARY"===e.tagName||ve(e.parentElement))}function $e(e,t){return!!e&&(e===t||$e(e.parentElement,t))}function ke({summary:e,children:t,...n}){(0,me.A)().collectAnchor(n.id);const i=(0,s.A)(),a=(0,r.useRef)(null),{collapsed:c,setCollapsed:l}=(0,ge.u)({initialState:!n.open}),[d,u]=(0,r.useState)(n.open),h=r.isValidElement(e)?e:(0,f.jsx)("summary",{children:e??"Details"});return(0,f.jsxs)("details",{...n,ref:a,open:d,"data-collapsed":c,className:(0,o.A)(be,i&&ye,n.className),onMouseDown:e=>{ve(e.target)&&e.detail>1&&e.preventDefault()},onClick:e=>{e.stopPropagation();const t=e.target;ve(t)&&$e(t,a.current)&&(e.preventDefault(),c?(l(!1),u(!0)):l(!0))},children:[h,(0,f.jsx)(ge.N,{lazy:!1,collapsed:c,onCollapseTransitionEnd:e=>{l(e),u(!e)},children:(0,f.jsx)("div",{className:xe,children:t})})]})}const we="details_b_Ee";function Ae({...e}){return(0,f.jsx)(ke,{...e,className:(0,o.A)("alert alert--info",we,e.className)})}function je(e){const t=r.Children.toArray(e.children),n=t.find(e=>r.isValidElement(e)&&"summary"===e.type),i=(0,f.jsx)(f.Fragment,{children:t.filter(e=>e!==n)});return(0,f.jsx)(Ae,{...e,summary:n,children:i})}var Ne=n(1107);function Ie(e){return(0,f.jsx)(Ne.A,{...e})}const Oe="containsTaskList_mC6p";function Se(e){if(void 0!==e)return(0,o.A)(e,e?.includes("contains-task-list")&&Oe)}const Ce="img_ev3q";var qe=n(7293),Be=n(418);const Re={Head:i.A,details:je,Details:je,code:function(e){return function(e){return void 0!==e.children&&r.Children.toArray(e.children).every(e=>"string"==typeof e&&!e.includes("\n"))}(e)?(0,f.jsx)(pe,{...e}):(0,f.jsx)(he,{...e})},a:function(e){return(0,f.jsx)(fe.A,{...e})},pre:function(e){return(0,f.jsx)(f.Fragment,{children:e.children})},ul:function(e){return(0,f.jsx)("ul",{...e,className:Se(e.className)})},li:function(e){return(0,me.A)().collectAnchor(e.id),(0,f.jsx)("li",{...e})},img:function(e){return(0,f.jsx)("img",{decoding:"async",loading:"lazy",...e,className:(t=e.className,(0,o.A)(t,Ce))});var t},h1:e=>(0,f.jsx)(Ie,{as:"h1",...e}),h2:e=>(0,f.jsx)(Ie,{as:"h2",...e}),h3:e=>(0,f.jsx)(Ie,{as:"h3",...e}),h4:e=>(0,f.jsx)(Ie,{as:"h4",...e}),h5:e=>(0,f.jsx)(Ie,{as:"h5",...e}),h6:e=>(0,f.jsx)(Ie,{as:"h6",...e}),admonition:qe.A,mermaid:Be.A}},6266:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var r=n(4586);function i(e={}){const{i18n:{currentLocale:t}}=(0,r.A)(),n=function(){const{i18n:{currentLocale:e,localeConfigs:t}}=(0,r.A)();return t[e].calendar}();return new Intl.DateTimeFormat(t,{calendar:n,...e})}},6816:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(4722).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]])},7256:(e,t,n)=>{"use strict";n.d(t,{NW:()=>oc});const r=e=>Array.isArray(e)?e:[e],i=Array,s=(e,t)=>e.includes(t),o=(e,t=0)=>[...new Array(e)].map((e,n)=>n+t),a=(e,t,n)=>void 0===e?void 0===t?[]:Array.isArray(t)?t:[t]:(n?.prepend?Array.isArray(t)?e.unshift(...t):e.unshift(t):Array.isArray(t)?e.push(...t):e.push(t),e),c=(e,t)=>null==t?e??[]:null==e?r(t):e.concat(t),l=(...e)=>e.reduce(c,[]),d=(e,t,n)=>{if(void 0===e)return Array.isArray(t)?t:[t];const i=n?.isEqual??((e,t)=>e===t);for(const s of r(t))e.some(e=>i(e,s))||e.push(s);return e},u=(e,t,n)=>e.length===t.length&&e.every(n?.isEqual?(e,r)=>n.isEqual(e,t[r]):(e,n)=>e===t[n]),h=(e,t)=>p(e)===t,p=e=>{const t=typeof e;return"object"===t?null===e?"null":"object":"function"===t?"object":t},f={boolean:"boolean",null:"null",undefined:"undefined",bigint:"a bigint",number:"a number",object:"an object",string:"a string",symbol:"a symbol"},m={...f,function:"a function"};class g extends Error{}const b=e=>y(e,g),y=(e,t=Error)=>{throw new t(e)};class x extends Error{name="ParseError"}const v=e=>y(e,x),$=e=>` ${e}`,k=Object.entries,w=(e,t)=>e in t,A=(e,t)=>t in e;class j{constructor(e){Object.assign(this,e)}}const N=class{};class I extends N{}const O=(e,t)=>{const n={},r={};let i;for(i in e)i in t?n[i]=e[i]:r[i]=e[i];return[n,r]},S=e=>0===Object.keys(e).length,C=e=>[...Object.entries(e),...Object.getOwnPropertySymbols(e).map(t=>[t,e[t]])],q=$("represents an uninitialized value"),B={Array:Array,Boolean:Boolean,Date:Date,Error:Error,Function:Function,Map:Map,Number:Number,Promise:Promise,RegExp:RegExp,Set:Set,String:String,WeakMap:WeakMap,WeakSet:WeakSet},R=globalThis.File??Blob,E={ArrayBuffer:ArrayBuffer,Blob:Blob,File:R,FormData:FormData,Headers:Headers,Request:Request,Response:Response,URL:URL},K={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,BigInt64Array:BigInt64Array,BigUint64Array:BigUint64Array},L={...B,...E,...K,String:String,Number:Number,Boolean:Boolean},D=e=>{let t=Object.getPrototypeOf(e);for(;t?.constructor&&(!w(t.constructor.name,L)||!(e instanceof L[t.constructor.name]));)t=Object.getPrototypeOf(t);const n=t?.constructor?.name;if(void 0!==n&&"Object"!==n)return n},M=e=>"object"==typeof e&&null!==e?D(e)??"object":p(e),z=Array.isArray,U={Array:"an array",Function:"a function",Date:"a Date",RegExp:"a RegExp",Error:"an Error",Map:"a Map",Set:"a Set",String:"a String object",Number:"a Number object",Boolean:"a Boolean object",Promise:"a Promise",WeakMap:"a WeakMap",WeakSet:"a WeakSet",ArrayBuffer:"an ArrayBuffer instance",Blob:"a Blob instance",File:"a File instance",FormData:"a FormData instance",Headers:"a Headers instance",Request:"a Request instance",Response:"a Response instance",URL:"a URL instance",Int8Array:"an Int8Array",Uint8Array:"a Uint8Array",Uint8ClampedArray:"a Uint8ClampedArray",Int16Array:"an Int16Array",Uint16Array:"a Uint16Array",Int32Array:"an Int32Array",Uint32Array:"a Uint32Array",Float32Array:"a Float32Array",Float64Array:"a Float64Array",BigInt64Array:"a BigInt64Array",BigUint64Array:"a BigUint64Array"},F=e=>{const t=Object(e).name??null;return t&&w(t,L)&&L[t]===e?t:null},T=(e,t)=>{let n=e.prototype;for(;null!==n;){if(n===t.prototype)return!0;n=Object.getPrototypeOf(n)}return!1},P=(e,t)=>{if("object"!=typeof e||null===e)return e;if(t?.has(e))return t.get(e);const n=F(e.constructor);if("Date"===n)return new Date(e.getTime());if(n&&"Array"!==n)return e;const r=Array.isArray(e)?e.slice():Object.create(Object.getPrototypeOf(e)),i=Object.getOwnPropertyDescriptors(e);if(t){t.set(e,r);for(const e in i){const n=i[e];"get"in n||"set"in n||(n.value=P(n.value,t))}}return Object.defineProperties(r,i),r},_=(e,t)=>{const n={},r=Array.isArray(e);let i=!1;for(const[s,o]of Object.entries(e).entries()){const e=r?t(s,o[1]):t(...o,s);i||="number"==typeof e[0];const c=Array.isArray(e[0])||0===e.length?e:[e];for(const[t,r]of c)"object"==typeof t?n[t.group]=a(n[t.group],r):n[t]=r}return i?Object.values(n):n},J=e=>"function"==typeof e&&0===e.length,V=class extends Function{constructor(...e){const t=e.slice(0,-1),n=e.at(-1);try{super(...t,n)}catch(r){return b(`Encountered an unexpected error while compiling your definition:\n                Message: ${r} \n                Source: (${e.slice(0,-1)}) => {\n                    ${e.at(-1)}\n                }`)}}};class W{constructor(e,...[t]){return Object.assign(Object.setPrototypeOf(e.bind(t?.bind??this),this.constructor.prototype),t?.attach)}}const H=(e=>{let t=q;return()=>t===q?t=e():t})(()=>{try{return new Function("return false")()}catch{return!0}});$("brand"),$("arkInferred"),$("args");class G{constructor(){}}const Z=()=>{try{const e=new Error,t=e.stack?.split("\n")[2]?.trim()||"";return(t.match(/\(?(.+?)(?::\d+:\d+)?\)?$/)?.[1]||"unknown").replace(/^file:\/\//,"")}catch{return"unknown"}},Y=(globalThis.process,e=>new RegExp(Q(e),"string"==typeof e?"":e.flags)),Q=e=>`^(?:${"string"==typeof e?e:e.source})$`,X=e=>`(?!${e})`,ee=e=>`(?:${e})`,te={" ":1,"\n":1,"\t":1},ne=/^-0\.?0*$/.source,re=/[1-9]\d*/.source,ie=/\.\d+/.source,se=e=>Y(X(ne)+ee("-?"+ee(ee("0|"+re)+ee(e.decimalPattern)+"?")+(e.allowDecimalOnly?"|"+e.decimalPattern:"")+"?")),oe=se({decimalPattern:/\.\d*[1-9]/.source,allowDecimalOnly:!1}),ae=oe.test.bind(oe),ce=se({decimalPattern:ie,allowDecimalOnly:!0}),le=(ce.test.bind(ce),/^-?\d*\.?\d*$/),de=Y(X("^-0$")+"-?"+ee(ee("0|"+re))),ue=de.test.bind(de),he=/^-?\d+$/,pe=he.test.bind(he),fe={number:"a number",bigint:"a bigint",integer:"an integer"},me=(e,t)=>`'${e}' was parsed as ${fe[t]} but could not be narrowed to a literal value. Avoid unnecessary leading or trailing zeros and other abnormal notation`,ge=(e,t)=>{return"number"===t?0!==(n=e).length&&le.test(n):pe(e);var n},be=(e,t,n)=>{const r=((e,t)=>"number"===t?Number(e):Number.parseInt(e))(e,t);return!Number.isNaN(r)&&ge(e,t)?n?.strict?((e,t)=>"number"===t?ae(e):ue(e))(e,t)?r:v(me(e,t)):r:n?.errorOnFail?v(!0===n?.errorOnFail?`Failed to parse ${fe[t]} from '${e}'`:n?.errorOnFail):void 0},ye={version:"0.46.0",filename:Z(),FileConstructor:R},xe=new Map,ve=Object.create(null),$e=e=>{const t=xe.get(e);if(t)return t;let n=we(e);return ve[n]?n=`${n}${ve[n]++}`:ve[n]=1,ye[n]=e,xe.set(e,n),n},ke=e=>/^[$A-Z_a-z][\w$]*$/.test(e),we=e=>{switch(typeof e){case"object":{if(null===e)break;const t=D(e)??"object";return t[0].toLowerCase()+t.slice(1)}case"function":return ke(e.name)?e.name:"fn";case"symbol":return e.description&&ke(e.description)?e.description:"symbol"}return b(`Unexpected attempt to register serializable value of type ${p(e)}`)},Ae=e=>"string"==typeof e?JSON.stringify(e):"bigint"==typeof e?`${e}n`:`${e}`,je=(e,t={})=>Se(e,{onUndefined:"$ark.undefined",onBigInt:e=>`$ark.bigint-${e}`,...t},[]),Ne=(e,t)=>{switch(p(e)){case"object":const n=e,r=n.constructor.name;return"Object"===r||"Array"===r?!1===t?.quoteKeys?Ie(n,t?.indent??0,""):JSON.stringify(Se(n,Oe,[]),null,t?.indent):Ie(n,t?.indent??0,"");case"symbol":return Oe.onSymbol(e);default:return Ae(e)}},Ie=(e,t,n)=>{if("function"==typeof e)return Oe.onFunction(e);if("object"!=typeof e||null===e)return Ae(e);const r=n+" ".repeat(t);if(Array.isArray(e)){if(0===e.length)return"[]";const i=e.map(e=>Ie(e,t,r)).join(",\n"+r);return t?`[\n${r}${i}\n${n}]`:`[${i}]`}const i=e.constructor.name;if("Object"===i){const i=C(e).map(([e,n])=>{const i="symbol"==typeof e?Oe.onSymbol(e):ke(e)?e:JSON.stringify(e),s=Ie(n,t,r);return`${r}${i}: ${s}`});return 0===i.length?"{}":t?`{\n${i.join(",\n")}\n${n}}`:`{${i.join(", ")}}`}return e instanceof Date?Ce(e):"expression"in e&&"string"==typeof e.expression?e.expression:i},Oe={onCycle:()=>"(cycle)",onSymbol:e=>`Symbol(${$e(e)})`,onFunction:e=>`Function(${$e(e)})`},Se=(e,t,n)=>{switch(p(e)){case"object":{const r=e;if("toJSON"in r&&"function"==typeof r.toJSON)return r.toJSON();if("function"==typeof r)return Oe.onFunction(r);if(n.includes(r))return"(cycle)";const i=[...n,r];if(Array.isArray(r))return r.map(e=>Se(e,t,i));if(r instanceof Date)return r.toDateString();const s={};for(const e in r)s[e]=Se(r[e],t,i);for(const e of Object.getOwnPropertySymbols(r))s[t.onSymbol?.(e)??e.toString()]=Se(r[e],t,i);return s}case"symbol":return Oe.onSymbol(e);case"bigint":return t.onBigInt?.(e)??`${e}n`;case"undefined":return t.onUndefined??"undefined";case"string":return e.replaceAll("\\","\\\\");default:return e}},Ce=e=>{const t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=e.getHours(),s=e.getMinutes(),o=e.getSeconds(),a=e.getMilliseconds();if(0===n&&1===r&&0===i&&0===s&&0===o&&0===a)return`${t}`;const c=`${qe[n]} ${r}, ${t}`;if(0===i&&0===s&&0===o&&0===a)return c;let l=e.toLocaleTimeString();const d=l.endsWith(" AM")||l.endsWith(" PM")?l.slice(-3):"";return d&&(l=l.slice(0,-d.length)),a?l+=`.${Re(a,3)}`:Be.test(l)&&(l=l.slice(0,-3)),`${l+d}, ${c}`},qe=["January","February","March","April","May","June","July","August","September","October","November","December"],Be=/:\d\d:00$/,Re=(e,t)=>String(e).padStart(t,"0"),Ee=(e,t,...[n])=>{const r=n?.stringifySymbol??Ne;let i=e;switch(typeof t){case"string":i=ke(t)?""===e?t:`${e}.${t}`:`${e}[${JSON.stringify(t)}]`;break;case"number":i=`${e}[${t}]`;break;case"symbol":i=`${e}[${r(t)}]`;break;default:n?.stringifyNonKey?i=`${e}[${n.stringifyNonKey(t)}]`:v(`${Ne(t)} must be a PropertyKey or stringifyNonKey must be passed to options`)}return i},Ke=(e,...t)=>e.reduce((e,n)=>Ee(e,n,...t),"");class Le extends i{cache={};constructor(...e){super(),this.push(...e)}toJSON(){if(this.cache.json)return this.cache.json;this.cache.json=[];for(let e=0;e<this.length;e++)this.cache.json.push("symbol"==typeof this[e]?Ne(this[e]):this[e]);return this.cache.json}stringify(){return this.cache.stringify?this.cache.stringify:this.cache.stringify=Ke(this)}stringifyAncestors(){if(this.cache.stringifyAncestors)return this.cache.stringifyAncestors;let e="";const t=[e];for(const n of this)e=Ee(e,n),t.push(e);return this.cache.stringifyAncestors=t}}class De{chars;i;def;constructor(e){this.def=e,this.chars=[...e],this.i=0}shift(){return this.chars[this.i++]??""}get lookahead(){return this.chars[this.i]??""}get nextLookahead(){return this.chars[this.i+1]??""}get length(){return this.chars.length}shiftUntil(e){let t="";for(;this.lookahead;){if(e(this,t)){if("\\"!==t[t.length-1])break;t=t.slice(0,-1)}t+=this.shift()}return t}shiftUntilLookahead(e){return"string"==typeof e?this.shiftUntil(t=>t.lookahead===e):this.shiftUntil(t=>t.lookahead in e)}shiftUntilNonWhitespace(){return this.shiftUntil(()=>!(this.lookahead in te))}jumpToIndex(e){this.i=e<0?this.length+e:e}jumpForward(e){this.i+=e}get location(){return this.i}get unscanned(){return this.chars.slice(this.i,this.length).join("")}get scanned(){return this.chars.slice(0,this.i).join("")}sliceChars(e,t){return this.chars.slice(e,t).join("")}lookaheadIs(e){return this.lookahead===e}lookaheadIsIn(e){return this.lookahead in e}}$("implementedTraits");Symbol.hasInstance;let Me="$ark",ze=2;for(;Me in globalThis;)Me="$ark"+ze++;const Ue=Me;globalThis[Ue]=ye;const Fe=ye,Te=e=>{return t=$e(e),`${Ue}.${t}`;var t};class Pe extends I{argNames;body="";constructor(...e){super(),this.argNames=e;for(const t of e){if(t in this)throw new Error(`Arg name '${t}' would overwrite an existing property on FunctionBody`);this[t]=t}}indentation=0;indent(){return this.indentation+=4,this}dedent(){return this.indentation-=4,this}prop(e,t=!1){return Je(e,t)}index(e,t=!1){return We(`${e}`,t)}line(e){return this.body+=`${" ".repeat(this.indentation)}${e}\n`,this}const(e,t){return this.line(`const ${e} = ${t}`),this}let(e,t){return this.line(`let ${e} = ${t}`)}set(e,t){return this.line(`${e} = ${t}`)}if(e,t){return this.block(`if (${e})`,t)}elseIf(e,t){return this.block(`else if (${e})`,t)}else(e){return this.block("else",e)}for(e,t,n=0){return this.block(`for (let i = ${n}; ${e}; i++)`,t)}forIn(e,t){return this.block(`for (const k in ${e})`,t)}block(e,t,n=""){return this.line(`${e} {`),this.indent(),t(this),this.dedent(),this.line(`}${n}`)}return(e=""){return this.line(`return ${e}`)}write(e="anonymous",t=0){return`${e}(${this.argNames.join(", ")}) { ${t?this.body.split("\n").map(e=>" ".repeat(t)+`${e}`).join("\n"):this.body} }`}compile(){return new V(...this.argNames,this.body)}}const _e=e=>h(e,"object")||"symbol"==typeof e?Te(e):Ae(e),Je=(e,t=!1)=>"string"==typeof e&&ke(e)?`${t?"?":""}.${e}`:We(Ve(e),t),Ve=e=>"symbol"==typeof e?Te(e):JSON.stringify(e),We=(e,t=!1)=>`${t?"?.":""}[${e}]`;class He extends Pe{traversalKind;optimistic;constructor(e){super("data","ctx"),this.traversalKind=e.kind,this.optimistic=!0===e.optimistic}invoke(e,t){const n=t?.arg??this.data,r="string"==typeof e||this.requiresContextFor(e),i="string"==typeof e?e:e.id;return r?`${this.referenceToId(i,t)}(${n}, ${this.ctx})`:`${this.referenceToId(i,t)}(${n})`}referenceToId(e,t){const n=`this.${e}${t?.kind??this.traversalKind}`;return t?.bind?`${n}.bind(${t?.bind})`:n}requiresContextFor(e){return"Apply"===this.traversalKind||e.allowsRequiresContext}initializeErrorCount(){return this.const("errorCount","ctx.currentErrorCount")}returnIfFail(){return this.if("ctx.currentErrorCount > errorCount",()=>this.return())}returnIfFailFast(){return this.if("ctx.failFast && ctx.currentErrorCount > errorCount",()=>this.return())}traverseKey(e,t,n){const r=this.requiresContextFor(n);return r&&this.line(`${this.ctx}.path.push(${e})`),this.check(n,{arg:t}),r&&this.line(`${this.ctx}.path.pop()`),this}check(e,t){return"Allows"===this.traversalKind?this.if(`!${this.invoke(e,t)}`,()=>this.return(!1)):this.line(this.invoke(e,t))}}const Ge=e=>_(e,(e,t)=>[e,z(t)?[...t]:t]),Ze=$("arkKind"),Ye=(e,t)=>e?.[Ze]===t,Qe=e=>Ye(e,"root")||Ye(e,"constraint"),Xe=["unit","proto","domain"],et=["required","optional","index","sequence"],tt=["pattern","divisor","exactLength","max","min","maxLength","minLength","before","after"],nt=[...tt,...et,"structure","predicate"],rt=["alias","union","morph","unit","intersection","proto","domain"],it=[...rt,...nt],st=_(nt,(e,t)=>[t,1]),ot=_([...et,"undeclared"],(e,t)=>[t,1]),at=_(it,(e,t)=>[t,e]),ct=e=>"string"==typeof e&&e in at;const lt=e=>at[e],dt=e=>rt.slice(lt(e)+1),ut=(dt("union"),dt("morph"),e=>"string"==typeof e||"boolean"==typeof e||null===e?e:"number"==typeof e?Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e:_e(e)),ht=e=>{let t="{ ";for(const[n,r]of Object.entries(e))t+=`${n}: ${_e(r)}, `;return t+" }"},pt=e=>{const t=e;return t.hasAssociatedError&&(t.defaults.expected??=e=>"description"in e?e.description:t.defaults.description(e),t.defaults.actual??=e=>Ne(e),t.defaults.problem??=e=>`must be ${e.expected}${e.actual?` (was ${e.actual})`:""}`,t.defaults.message??=e=>{if(0===e.path.length)return e.problem;const t=`${e.propString} ${e.problem}`;return"["===t[0]?`value at ${t}`:t}),t};class ft extends Error{name="ToJsonSchemaError";code;context;constructor(e,t){super(Ne(t,{quoteKeys:!1,indent:4})),this.code=e,this.context=t}hasCode(e){return this.code===e}}const mt={Error:ft,throw:(...e)=>{throw new mt.Error(...e)},throwInternalOperandError:(e,t)=>b(`Unexpected JSON Schema input for ${e}: ${Ne(t)}`),defaultConfig:{dialect:"https://json-schema.org/draft/2020-12/schema",useRefs:!1,fallback:{arrayObject:e=>mt.throw("arrayObject",e),arrayPostfix:e=>mt.throw("arrayPostfix",e),defaultValue:e=>mt.throw("defaultValue",e),domain:e=>mt.throw("domain",e),morph:e=>mt.throw("morph",e),patternIntersection:e=>mt.throw("patternIntersection",e),predicate:e=>mt.throw("predicate",e),proto:e=>mt.throw("proto",e),symbolKey:e=>mt.throw("symbolKey",e),unit:e=>mt.throw("unit",e),date:e=>mt.throw("date",e)}}};Fe.config??={};const gt=(e,t)=>{if(!t)return e;const n={...e};let r;for(r in t){const i={...e.keywords};if("keywords"===r){for(const e in t[r]){const n=t.keywords[e];void 0!==n&&(i[e]="string"==typeof n?{description:n}:n)}n.keywords=i}else"toJsonSchema"===r?n[r]=bt(e.toJsonSchema,t.toJsonSchema):ct(r)?n[r]={...e[r],...t[r]}:n[r]=t[r]}return n},bt=(e,t)=>{if(!e)return t??{};if(!t)return e;const n={...e};let r;for(r in t)"fallback"===r?n.fallback=yt(e.fallback,t.fallback):n[r]=t[r];return n},yt=(e,t)=>{e=xt(e),t=xt(t);const n={};let r;for(r in mt.defaultConfig.fallback)n[r]=t[r]??t.default??e[r]??e.default??mt.defaultConfig.fallback[r];return n},xt=e=>"function"==typeof e?{default:e}:e??{};class vt extends I{[Ze]="error";path;data;nodeConfig;input;ctx;constructor({prefixPath:e,relativePath:t,...n},r){var i,s;super(),this.input=n,this.ctx=r,i=this,s=n,Object.defineProperties(i,Object.getOwnPropertyDescriptors(s));const o=r.data;"union"===n.code&&(n.errors=n.errors.flatMap(n=>{const r=n.hasCode("union")?n.errors:[n];return e||t?r.map(n=>n.transform(n=>({...n,path:l(e,n.path,t)}))):r})),this.nodeConfig=r.config[this.code];const a=[...n.path??r.path];t&&a.push(...t),e&&a.unshift(...e),this.path=new Le(...a),this.data="data"in n?n.data:o}transform(e){return new vt(e({data:this.data,path:this.path,...this.input}),this.ctx)}hasCode(e){return this.code===e}get propString(){return Ke(this.path)}get expected(){if(this.input.expected)return this.input.expected;const e=this.meta?.expected??this.nodeConfig.expected;return"function"==typeof e?e(this.input):e}get actual(){if(this.input.actual)return this.input.actual;const e=this.meta?.actual??this.nodeConfig.actual;return"function"==typeof e?e(this.data):e}get problem(){if(this.input.problem)return this.input.problem;const e=this.meta?.problem??this.nodeConfig.problem;return"function"==typeof e?e(this):e}get message(){if(this.input.message)return this.input.message;const e=this.meta?.message??this.nodeConfig.message;return"function"==typeof e?e(this):e}get flat(){return this.hasCode("intersection")?[...this.errors]:[this]}toJSON(){return{data:this.data,path:this.path,...this.input,expected:this.expected,actual:this.actual,problem:this.problem,message:this.message}}toString(){return this.message}throw(){throw this}}class $t extends i{[Ze]="errors";ctx;constructor(e){super(),this.ctx=e}byPath=Object.create(null);get flatByPath(){return _(this.byPath,(e,t)=>[e,t.flat])}get flatProblemsByPath(){return _(this.byPath,(e,t)=>[e,t.flat.map(e=>e.problem)])}byAncestorPath=Object.create(null);count=0;mutable=this;throw(){throw this.toTraversalError()}toTraversalError(){return new kt(this)}add(e){this.includes(e)||this._add(e)}transform(e){const t=new $t(this.ctx);for(const n of this)t.add(e(n));return t}merge(e){for(const t of e)this.includes(t)||this._add(new vt({...t,path:[...this.ctx.path,...t.path]},this.ctx))}affectsPath(e){return 0!==this.length&&(e.stringifyAncestors().some(e=>e in this.byPath)||e.stringify()in this.byAncestorPath)}get summary(){return this.toString()}get issues(){return this}toJSON(){return[...this.map(e=>e.toJSON())]}toString(){return this.join("\n")}_add(e){const t=this.byPath[e.propString];if(t){if(t.hasCode("union")&&0===t.errors.length)return;const n=e.hasCode("union")&&0===e.errors.length?e:new vt({code:"intersection",errors:t.hasCode("intersection")?[...t.errors,e]:[t,e]},this.ctx),r=this.indexOf(t);this.mutable[-1===r?this.length:r]=n,this.byPath[e.propString]=n,this.addAncestorPaths(e)}else this.byPath[e.propString]=e,this.addAncestorPaths(e),this.mutable.push(e);this.count++}addAncestorPaths(e){for(const t of e.path.stringifyAncestors())this.byAncestorPath[t]=a(this.byAncestorPath[t],e)}}class kt extends Error{name="TraversalError";constructor(e){1===e.length?super(e.summary):super("\n"+e.map(e=>`  \u2022 ${wt(e)}`).join("\n")),Object.defineProperty(this,"arkErrors",{value:e,enumerable:!1})}}const wt=e=>e.toString().split("\n").join("\n  ");class At{path=[];errors=new $t(this);root;config;queuedMorphs=[];branches=[];seen={};constructor(e,t){this.root=e,this.config=t}get data(){let e=this.root;for(const t of this.path)e=e?.[t];return e}get propString(){return Ke(this.path)}reject(e){return this.error(e),!1}mustBe(e){return this.error(e),!1}error(e){const t="object"==typeof e?e.code?e:{...e,code:"predicate"}:{code:"predicate",expected:e};return this.errorFromContext(t)}hasError(){return 0!==this.currentErrorCount}get currentBranch(){return this.branches.at(-1)}queueMorphs(e){const t={path:new Le(...this.path),morphs:e};this.currentBranch?this.currentBranch.queuedMorphs.push(t):this.queuedMorphs.push(t)}finalize(e){return this.queuedMorphs.length&&("object"==typeof this.root&&null!==this.root&&this.config.clone&&(this.root=this.config.clone(this.root)),this.applyQueuedMorphs()),this.hasError()?e?e(this.errors):this.errors:this.root}get currentErrorCount(){return this.currentBranch?this.currentBranch.error?1:0:this.errors.count}get failFast(){return 0!==this.branches.length}pushBranch(){this.branches.push({error:void 0,queuedMorphs:[]})}popBranch(){return this.branches.pop()}get external(){return this}errorFromNodeContext(e){return this.errorFromContext(e)}errorFromContext(e){const t=new vt(e,this);return this.currentBranch?this.currentBranch.error=t:this.errors.add(t),t}applyQueuedMorphs(){for(;this.queuedMorphs.length;){const e=this.queuedMorphs;this.queuedMorphs=[];for(const{path:t,morphs:n}of e)this.errors.affectsPath(t)||this.applyMorphsAtPath(t,n)}}applyMorphsAtPath(e,t){const n=e.at(-1);let r;if(void 0!==n){r=this.root;for(let t=0;t<e.length-1;t++)r=r[e[t]]}this.path=[...e];for(const i of t){const e=Qe(i),t=i(void 0===r?this.root:r[n],this);if(t instanceof vt){this.errors.add(t);break}if(t instanceof $t){e||this.errors.merge(t);break}void 0===r?this.root=t:r[n]=t,this.applyQueuedMorphs()}}}const jt=(e,t,n)=>{if(!n)return t();n.path.push(e);const r=t();return n.path.pop(),r};class Nt extends W{attachments;$;onFail;includesTransform;includesContextualPredicate;isCyclic;allowsRequiresContext;rootApplyStrategy;contextFreeMorph;rootApply;referencesById;shallowReferences;flatRefs;flatMorphs;allows;get shallowMorphs(){return[]}constructor(e,t){super((e,t,n=this.onFail)=>t?(this.traverseApply(e,t),t.hasError()?t.errors:t.data):this.rootApply(e,n),{attach:e}),this.attachments=e,this.$=t,this.onFail=this.meta.onFail??this.$.resolvedConfig.onFail,this.includesTransform=this.hasKind("morph")||this.hasKind("structure")&&void 0!==this.structuralMorph,this.includesContextualPredicate=this.hasKind("predicate")&&1!==this.inner.predicate.length,this.isCyclic="alias"===this.kind,this.referencesById={[this.id]:this},this.shallowReferences=this.hasKind("structure")?[this,...this.children]:this.children.reduce((e,t)=>Kt(e,t.shallowReferences),[this]);const n=this.isStructural();this.flatRefs=[],this.flatMorphs=[];for(let r=0;r<this.children.length;r++){if(this.includesTransform||=this.children[r].includesTransform,this.includesContextualPredicate||=this.children[r].includesContextualPredicate,this.isCyclic||=this.children[r].isCyclic,!n){const e=this.children[r].flatRefs;for(let t=0;t<e.length;t++){const n=e[t];if(!this.flatRefs.some(e=>Rt(e,n))){this.flatRefs.push(n);for(const e of n.node.branches)(e.hasKind("morph")||e.hasKind("intersection")&&void 0!==e.structure?.structuralMorph)&&this.flatMorphs.push({path:n.path,propString:n.propString,node:e})}}}Object.assign(this.referencesById,this.children[r].referencesById)}this.flatRefs.sort((e,t)=>e.path.length>t.path.length?1:e.path.length<t.path.length?-1:e.propString>t.propString?1:e.propString<t.propString||e.node.expression<t.node.expression?-1:1),this.allowsRequiresContext=this.includesContextualPredicate||this.isCyclic,this.rootApplyStrategy=this.allowsRequiresContext||0!==this.flatMorphs.length?"contextual":0===this.shallowMorphs.length?"allows":this.shallowMorphs.every(e=>1===e.length||"$arkStructuralMorph"===e.name)?this.hasKind("union")?this.branches.some(e=>e.shallowMorphs.length>1)?"contextual":"branchedOptimistic":this.shallowMorphs.length>1?"contextual":"optimistic":"contextual",this.rootApply=this.createRootApply(),this.allows=this.allowsRequiresContext?e=>this.traverseAllows(e,new At(e,this.$.resolvedConfig)):e=>this.traverseAllows(e)}createRootApply(){switch(this.rootApplyStrategy){case"allows":return(e,t)=>{if(this.allows(e))return e;const n=new At(e,this.$.resolvedConfig);return this.traverseApply(e,n),n.finalize(t)};case"contextual":return(e,t)=>{const n=new At(e,this.$.resolvedConfig);return this.traverseApply(e,n),n.finalize(t)};case"optimistic":this.contextFreeMorph=this.shallowMorphs[0];const e=this.$.resolvedConfig.clone;return(t,n)=>{if(this.allows(t))return this.contextFreeMorph(e&&("object"==typeof t&&null!==t||"function"==typeof t)?e(t):t);const r=new At(t,this.$.resolvedConfig);return this.traverseApply(t,r),r.finalize(n)};case"branchedOptimistic":return this.createBranchedOptimisticRootApply();default:return this.rootApplyStrategy,b(`Unexpected rootApplyStrategy ${this.rootApplyStrategy}`)}}compiledMeta=qt(this.metaJson);cacheGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}get description(){return this.cacheGetter("description",this.meta?.description??this.$.resolvedConfig[this.kind].description(this))}get references(){return Object.values(this.referencesById)}precedence=lt(this.kind);precompilation;assert=(e,t)=>this(e,t,e=>e.throw());traverse(e,t){return this(e,t,null)}get in(){return this.cacheGetter("in",this.getIo("in"))}get out(){return this.cacheGetter("out",this.getIo("out"))}getIo(e){if(!this.includesTransform)return this;const t={};for(const[n,r]of this.innerEntries){const i=this.impl.keys[n];if(i.reduceIo)i.reduceIo(e,t,r);else if(i.child){const i=r;t[n]=z(i)?i.map(t=>t[e]):i[e]}else t[n]=r}return this.$.node(this.kind,t)}toJSON(){return this.json}toString(){return`Type<${this.expression}>`}equals(e){const t=Qe(e)?e:this.$.parseDefinition(e);return this.innerHash===t.innerHash}ifEquals(e){return this.equals(e)?this:void 0}hasKind(e){return this.kind===e}assertHasKind(e){return this.kind!==e&&y(`${this.kind} node was not of asserted kind ${e}`),this}hasKindIn(...e){return e.includes(this.kind)}assertHasKindIn(...e){return s(e,this.kind)||y(`${this.kind} node was not one of asserted kinds ${e}`),this}isBasis(){return s(Xe,this.kind)}isConstraint(){return s(nt,this.kind)}isStructural(){return s(et,this.kind)}isRefinement(){return s(tt,this.kind)}isRoot(){return s(rt,this.kind)}isUnknown(){return this.hasKind("intersection")&&0===this.children.length}isNever(){return this.hasKind("union")&&0===this.children.length}hasUnit(e){return this.hasKind("unit")&&this.allows(e)}hasOpenIntersection(){return this.impl.intersectionIsOpen}get nestableExpression(){return this.expression}select(e){const t=It.normalize(e);return this._select(t)}_select(e){let t=It.applyBoundary[e.boundary??"references"](this);return e.kind&&(t=t.filter(t=>t.kind===e.kind)),e.where&&(t=t.filter(e.where)),It.applyMethod[e.method??"filter"](t,this,e)}transform(e,t){return this._transform(e,this._createTransformContext(t))}_createTransformContext(e){return{root:this,selected:void 0,seen:{},path:[],parseOptions:{prereduced:e?.prereduced??!1},undeclaredKeyHandling:void 0,...e}}_transform(e,t){const n=t.bindScope??this.$;if(t.seen[this.id])return this.$.lazilyResolve(t.seen[this.id]);if(!1===t.shouldTransform?.(this,t))return this;let r;t.seen[this.id]=()=>r,this.hasKind("structure")&&this.undeclared!==t.undeclaredKeyHandling&&(t={...t,undeclaredKeyHandling:this.undeclared});const i=_(this.inner,(n,r)=>{if(!this.impl.keys[n].child)return[n,r];const i=r;if(!z(i)){const r=i._transform(e,t);return r?[n,r]:[]}if(0===i.length)return[n,r];const s=i.flatMap(n=>n._transform(e,t)??[]);return s.length?[n,s]:[]});delete t.seen[this.id];const s=Object.assign(i,{meta:this.meta}),o=t.selected&&!t.selected.includes(this)?s:e(this.kind,s,t);if(null===o)return null;if(Qe(o))return r=o;const a=Object.keys(o);return 0!==a.length&&(1!==a.length||"meta"!==a[0])||S(this.inner)?"required"!==this.kind&&"optional"!==this.kind&&"index"!==this.kind||"value"in o?("morph"===this.kind&&(o.in??=Fe.intrinsic.unknown),r=n.node(this.kind,o,t.parseOptions)):t.undeclaredKeyHandling?{...o,value:Fe.intrinsic.unknown}:null:null}configureReferences(e,t="references"){const n=It.normalize(t),i="string"==typeof e?(t,n)=>({...n,meta:{...n.meta,description:e}}):"function"==typeof e?(t,n)=>({...n,meta:e(n.meta)}):(t,n)=>({...n,meta:{...n.meta,...e}});if("self"===n.boundary)return this.$.node(this.kind,i(this.kind,{...this.inner,meta:this.meta}));const s=this._select(n),o=s&&r(s),a="child"===n.boundary?(e,t)=>t.root.children.includes(e):"shallow"===n.boundary?e=>"structure"!==e.kind:()=>!0;return this.$.finalize(this.transform(i,{shouldTransform:a,selected:o}))}}const It={applyBoundary:{self:e=>[e],child:e=>[...e.children],shallow:e=>[...e.shallowReferences],references:e=>[...e.references]},applyMethod:{filter:e=>e,assertFilter:(e,t,n)=>(0===e.length&&y(Ot(t,n)),e),find:e=>e[0],assertFind:(e,t,n)=>(0===e.length&&y(Ot(t,n)),e[0])},normalize:e=>"function"==typeof e?{boundary:"references",method:"filter",where:e}:"string"==typeof e?w(e,It.applyBoundary)?{method:"filter",boundary:e}:{boundary:"references",method:"filter",kind:e}:{boundary:"references",method:"filter",...e}},Ot=(e,t)=>`${e} had no references matching ${Ne(t)}.`,St=e=>Ke(e,{stringifyNonKey:e=>e.expression}),Ct=/"(\$ark\.[^"]+)"/g,qt=e=>JSON.stringify(e).replaceAll(Ct,"$1"),Bt=(e,t)=>({path:e,node:t,propString:St(e)}),Rt=(e,t)=>e.propString===t.propString&&e.node.equals(t.node),Et=(e,t)=>d(e,t,{isEqual:Rt}),Kt=(e,t)=>d(e,t,{isEqual:(e,t)=>e.equals(t)});class Lt extends Array{static init(e,t,n,r){return new Lt({kind:e,l:t,r:n,path:r?.path??[],optional:r?.optional??!1})}add(e,t,n,r){return this.push({kind:e,l:t,r:n,path:r?.path??[],optional:r?.optional??!1}),this}get summary(){return this.describeReasons()}describeReasons(){if(1===this.length){const{path:e,l:t,r:n}=this[0],r=Ke(e);return zt(`Intersection${r&&` at ${r}`} of ${Dt(t,n)}`)}return`The following intersections result in unsatisfiable types:\n\u2022 ${this.map(({path:e,l:t,r:n})=>`${e}: ${Dt(t,n)}`).join("\n\u2022 ")}`}throw(){return v(this.describeReasons())}invert(){const e=this.map(e=>({...e,l:e.r,r:e.l}));return e instanceof Lt?e:new Lt(...e)}withPrefixKey(e,t){return this.map(n=>({...n,path:[e,...n.path],optional:n.optional||"optional"===t}))}toNeverIfDisjoint(){return Fe.intrinsic.never}}const Dt=(e,t)=>`${Mt(e)} and ${Mt(t)}`,Mt=e=>Qe(e)?e.expression:z(e)?e.map(Mt).join(" | ")||"never":String(e),zt=e=>`${e} results in an unsatisfiable type`,Ut={},Ft=(e,t,n)=>Pt(e,t,{$:n,invert:!1,pipe:!1}),Tt=(e,t,n)=>Pt(e,t,{$:n,invert:!1,pipe:!0}),Pt=(e,t,n)=>{const r=n.pipe?"|>":"&",i=`${e.hash}${r}${t.hash}`;if(void 0!==Ut[i])return Ut[i];if(!n.pipe){const n=`${t.hash}${r}${e.hash}`;if(void 0!==Ut[n]){const e=Ut[n],t=e instanceof Lt?e.invert():e;return Ut[i]=t,t}}const s=!n.pipe||!e.includesTransform&&!t.includesTransform;if(s&&e.equals(t))return e;let o=s?_t(e,t,n):e.hasKindIn(...rt)?Jt(e,t,n):_t(e,t,n);return Qe(o)&&(e.equals(o)?o=e:t.equals(o)&&(o=t)),Ut[i]=o,o},_t=(e,t,n)=>{const r=e.precedence<t.precedence?e.kind:t.kind,i=e.impl.intersections[t.kind]??t.impl.intersections[e.kind];if(void 0===i)return null;if(r===e.kind)return i(e,t,n);{let r=i(t,e,{...n,invert:!n.invert});return r instanceof Lt&&(r=r.invert()),r}},Jt=(e,t,n)=>e.includesTransform||t.includesTransform?n.invert?Vt(t,e,n):Vt(e,t,n):_t(e,t,n),Vt=(e,t,n)=>e.distribute(e=>Wt(e,t,n),r=>{const i=r.filter(Qe);if(0===i.length)return Lt.init("union",e.branches,t.branches);if(i.length<e.branches.length||!e.branches.every((e,t)=>e.in.equals(i[t].in)))return n.$.parseSchema(i);if(1===i.length){const e=i[0];return e}const s={branches:i};return n.$.parseSchema(s)}),Wt=(e,t,n)=>{if(e.hasKind("morph")){const r=[...e.morphs];if(e.lastMorphIfNode){const i=Pt(e.lastMorphIfNode,t,n);if(i instanceof Lt)return i;r[r.length-1]=i}else r.push(t);return n.$.node("morph",{morphs:r,in:e.inner.in})}if(t.hasKind("morph")){const r=Pt(e,t.in,n);return r instanceof Lt?r:n.$.node("morph",{morphs:[t],in:r})}return n.$.node("morph",{morphs:[t],in:e})};class Ht extends Nt{constructor(e,t){super(e,t),Object.defineProperty(this,Ze,{value:"constraint",enumerable:!1})}impliedSiblings;intersect(e){return Ft(this,e,this.$)}}class Gt extends Ht{traverseApply=(e,t)=>{this.traverseAllows(e,t)||t.errorFromNodeContext(this.errorContext)};compile(e){"Allows"===e.traversalKind?e.return(this.compiledCondition):e.if(this.compiledNegation,()=>e.line(`${e.ctx}.errorFromNodeContext(${this.compiledErrorContext})`))}get errorContext(){return{code:this.kind,description:this.description,meta:this.meta,...this.inner}}get compiledErrorContext(){return ht(this.errorContext)}}const Zt=e=>(t,n)=>{if(z(t)){if(0===t.length)return;const r=t.map(t=>n.$.node(e,t));return"predicate"===e?r:r.sort((e,t)=>e.hash<t.hash?-1:1)}const r=n.$.node(e,t);return r.hasOpenIntersection()?[r]:r},Yt=e=>{const t=e.r.shift();if(!t){let t=0===e.l.length&&"structure"===e.kind?Fe.intrinsic.unknown.internal:e.ctx.$.node(e.kind,Object.assign(e.baseInner,Xt(e.l)),{prereduced:!0});for(const n of e.roots){if(t instanceof Lt)return t;t=Pt(n,t,e.ctx)}return t}let n=!1;for(let r=0;r<e.l.length;r++){const i=Pt(e.l[r],t,e.ctx);if(null!==i){if(i instanceof Lt)return i;if(n){if(!e.l.includes(i))return b(`Unexpectedly encountered multiple distinct intersection results for refinement ${i}`)}else{if(i.isRoot())return e.roots.push(i),e.l.splice(r),Yt(e);e.l[r]=i,n=!0}}}if(n||e.l.push(t),"intersection"===e.kind&&t.impliedSiblings)for(const r of t.impliedSiblings)d(e.r,r);return Yt(e)},Qt=e=>Object.entries(e).flatMap(([e,t])=>e in st?t:[]).sort((e,t)=>e.precedence<t.precedence?-1:e.precedence>t.precedence?1:"predicate"===e.kind&&"predicate"===t.kind?0:e.hash<t.hash?-1:1),Xt=e=>{const t={};for(const n of e)if(n.hasOpenIntersection())t[n.kind]=a(t[n.kind],n);else{if(t[n.kind])return b(`Unexpected intersection of closed refinements of kind ${n.kind}`);t[n.kind]=n}return t},en=(e,t,n)=>{const r=n.hasKind("morph")?"a morph":n.isUnknown()?"unknown":n.exclude(t).defaultShortDescription;return`${i=e,i[0].toUpperCase()+i.slice(1)} operand must be ${t.description} (was ${r})`;var i};class tn extends W{}class nn extends W{[Ze]="generic";paramDefs;bodyDef;$;arg$;baseInstantiation;hkt;description;constructor(e,t,n,r,i){super((...e)=>{const n=_(this.names,(t,n)=>{const r=this.arg$.parse(e[t]);return r.extends(this.constraints[t])||v(rn(n,this.constraints[t].expression,r.expression)),[n,r]});if(this.defIsLazy()){const e=this.bodyDef(n);return this.$.parse(e)}return this.$.parse(t,{args:n})}),this.paramDefs=e,this.bodyDef=t,this.$=n,this.arg$=r,this.hkt=i,this.description=i?(new i).description??`a generic type for ${i.constructor.name}`:"a generic type",this.baseInstantiation=this(...this.constraints)}defIsLazy(){return this.bodyDef instanceof tn}cacheGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}get json(){return this.cacheGetter("json",{params:this.params.map(e=>e[1].isUnknown()?e[0]:[e[0],e[1].json]),body:je(this.bodyDef)})}get params(){return this.cacheGetter("params",this.paramDefs.map(e=>"string"==typeof e?[e,Fe.intrinsic.unknown]:[e[0],this.$.parse(e[1])]))}get names(){return this.cacheGetter("names",this.params.map(e=>e[0]))}get constraints(){return this.cacheGetter("constraints",this.params.map(e=>e[1]))}get internal(){return this}get referencesById(){return this.baseInstantiation.internal.referencesById}get references(){return this.baseInstantiation.internal.references}}const rn=(e,t,n)=>`${e} must be assignable to ${t} (was ${n})`,sn=pt({kind:"predicate",hasAssociatedError:!0,collapsibleKey:"predicate",keys:{predicate:{}},normalize:e=>"function"==typeof e?{predicate:e}:e,defaults:{description:e=>`valid according to ${e.predicate.name||"an anonymous predicate"}`},intersectionIsOpen:!0,intersections:{predicate:()=>null}});const on={implementation:sn,Node:class extends Ht{serializedPredicate=Te(this.predicate);compiledCondition=`${this.serializedPredicate}(data, ctx)`;compiledNegation=`!${this.compiledCondition}`;impliedBasis=null;expression=this.serializedPredicate;traverseAllows=this.predicate;errorContext={code:"predicate",description:this.description,meta:this.meta};compiledErrorContext=ht(this.errorContext);traverseApply=(e,t)=>{this.predicate(e,t.external)||t.hasError()||t.errorFromNodeContext(this.errorContext)};compile(e){"Allows"!==e.traversalKind?e.if(`${this.compiledNegation} && !ctx.hasError()`,()=>e.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`)):e.return(this.compiledCondition)}reduceJsonSchema(e,t){return t.fallback.predicate({code:"predicate",base:e,predicate:this.predicate})}}},an=pt({kind:"divisor",collapsibleKey:"rule",keys:{rule:{parse:e=>Number.isInteger(e)?e:v(ln(e))}},normalize:e=>"number"==typeof e?{rule:e}:e,hasAssociatedError:!0,defaults:{description:e=>1===e.rule?"an integer":2===e.rule?"even":`a multiple of ${e.rule}`},intersections:{divisor:(e,t,n)=>n.$.node("divisor",{rule:Math.abs(e.rule*t.rule/dn(e.rule,t.rule))})},obviatesBasisDescription:!0});const cn={implementation:an,Node:class extends Gt{traverseAllows=e=>e%this.rule===0;compiledCondition=`data % ${this.rule} === 0`;compiledNegation=`data % ${this.rule} !== 0`;impliedBasis=Fe.intrinsic.number.internal;expression=`% ${this.rule}`;reduceJsonSchema(e){return e.type="integer",1===this.rule||(e.multipleOf=this.rule),e}}},ln=e=>`divisor must be an integer (was ${e})`,dn=(e,t)=>{let n,r=e,i=t;for(;0!==i;)n=i,i=r%i,r=n;return r};class un extends Gt{boundOperandKind=xn[this.kind];compiledActual="value"===this.boundOperandKind?"data":"length"===this.boundOperandKind?"data.length":"data.valueOf()";comparator=vn(this.kind,this.exclusive);numericLimit=this.rule.valueOf();expression=`${this.comparator} ${this.rule}`;compiledCondition=`${this.compiledActual} ${this.comparator} ${this.numericLimit}`;compiledNegation=`${this.compiledActual} ${hn[this.comparator]} ${this.numericLimit}`;stringLimit="date"===this.boundOperandKind?$n(this.numericLimit):`${this.numericLimit}`;limitKind="<"===this.comparator[0]?"upper":"lower";isStricterThan(e){return("upper"===this.limitKind?this.numericLimit<e.numericLimit:this.numericLimit>e.numericLimit)||this.numericLimit===e.numericLimit&&!0===this.exclusive&&!e.exclusive}overlapsRange(e){return!this.isStricterThan(e)&&(this.numericLimit!==e.numericLimit||!this.exclusive&&!e.exclusive)}overlapIsUnit(e){return this.numericLimit===e.numericLimit&&!this.exclusive&&!e.exclusive}}const hn={"<":">=","<=":">",">":"<=",">=":"<"},pn={min:"max",minLength:"maxLength",after:"before"},fn={parse:e=>e||void 0},mn=e=>t=>{if("number"==typeof t)return{rule:t};const{exclusive:n,...r}=t;return n?{...r,rule:"minLength"===e?r.rule+1:r.rule-1}:r},gn=e=>t=>{if("number"==typeof t||"string"==typeof t||t instanceof Date)return{rule:t};const{exclusive:n,...r}=t;if(!n)return r;const i="number"==typeof r.rule?r.rule:"string"==typeof r.rule?new Date(r.rule).valueOf():r.rule.valueOf();return n?{...r,rule:"after"===e?i+1:i-1}:r},bn=e=>"string"==typeof e||"number"==typeof e?new Date(e):e,yn=e=>t=>((!Number.isInteger(t)||t<0)&&v(((e,t)=>`${e} bound must be a positive integer (was ${t})`)(e,t)),t),xn={min:"value",max:"value",minLength:"length",maxLength:"length",after:"date",before:"date"},vn=(e,t)=>`${w(e,pn)?">":"<"}${t?"":"="}`,$n=e=>"string"==typeof e?e:new Date(e).toLocaleString(),kn=pt({kind:"after",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:bn,serialize:e=>e.toISOString()}},normalize:gn("after"),defaults:{description:e=>`${e.collapsibleLimitString} or later`,actual:Ce},intersections:{after:(e,t)=>e.isStricterThan(t)?e:t}});const wn={implementation:kn,Node:class extends un{impliedBasis=Fe.intrinsic.Date.internal;collapsibleLimitString=Ce(this.rule);traverseAllows=e=>e>=this.rule;reduceJsonSchema(e,t){return t.fallback.date({code:"date",base:e,after:this.rule})}}},An=pt({kind:"before",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:bn,serialize:e=>e.toISOString()}},normalize:gn("before"),defaults:{description:e=>`${e.collapsibleLimitString} or earlier`,actual:Ce},intersections:{before:(e,t)=>e.isStricterThan(t)?e:t,after:(e,t,n)=>e.overlapsRange(t)?e.overlapIsUnit(t)?n.$.node("unit",{unit:e.rule}):null:Lt.init("range",e,t)}});const jn={implementation:An,Node:class extends un{collapsibleLimitString=Ce(this.rule);traverseAllows=e=>e<=this.rule;impliedBasis=Fe.intrinsic.Date.internal;reduceJsonSchema(e,t){return t.fallback.date({code:"date",base:e,before:this.rule})}}},Nn=pt({kind:"exactLength",collapsibleKey:"rule",keys:{rule:{parse:yn("exactLength")}},normalize:e=>"number"==typeof e?{rule:e}:e,hasAssociatedError:!0,defaults:{description:e=>`exactly length ${e.rule}`,actual:e=>`${e.length}`},intersections:{exactLength:(e,t,n)=>Lt.init("unit",n.$.node("unit",{unit:e.rule}),n.$.node("unit",{unit:t.rule}),{path:["length"]}),minLength:(e,t)=>e.rule>=t.rule?e:Lt.init("range",e,t),maxLength:(e,t)=>e.rule<=t.rule?e:Lt.init("range",e,t)}});const In={implementation:Nn,Node:class extends Gt{traverseAllows=e=>e.length===this.rule;compiledCondition=`data.length === ${this.rule}`;compiledNegation=`data.length !== ${this.rule}`;impliedBasis=Fe.intrinsic.lengthBoundable.internal;expression=`== ${this.rule}`;reduceJsonSchema(e){switch(e.type){case"string":return e.minLength=this.rule,e.maxLength=this.rule,e;case"array":return e.minItems=this.rule,e.maxItems=this.rule,e;default:return mt.throwInternalOperandError("exactLength",e)}}}},On=pt({kind:"max",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{},exclusive:fn},normalize:e=>"number"==typeof e?{rule:e}:e,defaults:{description:e=>0===e.rule?e.exclusive?"negative":"non-positive":`${e.exclusive?"less than":"at most"} ${e.rule}`},intersections:{max:(e,t)=>e.isStricterThan(t)?e:t,min:(e,t,n)=>e.overlapsRange(t)?e.overlapIsUnit(t)?n.$.node("unit",{unit:e.rule}):null:Lt.init("range",e,t)},obviatesBasisDescription:!0});const Sn={implementation:On,Node:class extends un{impliedBasis=Fe.intrinsic.number.internal;traverseAllows=this.exclusive?e=>e<this.rule:e=>e<=this.rule;reduceJsonSchema(e){return this.exclusive?e.exclusiveMaximum=this.rule:e.maximum=this.rule,e}}},Cn=pt({kind:"maxLength",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:yn("maxLength")}},reduce:(e,t)=>0===e.rule?t.node("exactLength",e):void 0,normalize:mn("maxLength"),defaults:{description:e=>`at most length ${e.rule}`,actual:e=>`${e.length}`},intersections:{maxLength:(e,t)=>e.isStricterThan(t)?e:t,minLength:(e,t,n)=>e.overlapsRange(t)?e.overlapIsUnit(t)?n.$.node("exactLength",{rule:e.rule}):null:Lt.init("range",e,t)}});const qn={implementation:Cn,Node:class extends un{impliedBasis=Fe.intrinsic.lengthBoundable.internal;traverseAllows=e=>e.length<=this.rule;reduceJsonSchema(e){switch(e.type){case"string":return e.maxLength=this.rule,e;case"array":return e.maxItems=this.rule,e;default:return mt.throwInternalOperandError("maxLength",e)}}}},Bn=pt({kind:"min",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{},exclusive:fn},normalize:e=>"number"==typeof e?{rule:e}:e,defaults:{description:e=>0===e.rule?e.exclusive?"positive":"non-negative":`${e.exclusive?"more than":"at least"} ${e.rule}`},intersections:{min:(e,t)=>e.isStricterThan(t)?e:t},obviatesBasisDescription:!0});const Rn={implementation:Bn,Node:class extends un{impliedBasis=Fe.intrinsic.number.internal;traverseAllows=this.exclusive?e=>e>this.rule:e=>e>=this.rule;reduceJsonSchema(e){return this.exclusive?e.exclusiveMinimum=this.rule:e.minimum=this.rule,e}}},En=pt({kind:"minLength",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:yn("minLength")}},reduce:e=>0===e.rule?Fe.intrinsic.unknown:void 0,normalize:mn("minLength"),defaults:{description:e=>1===e.rule?"non-empty":`at least length ${e.rule}`,actual:e=>0===e.length?"":`${e.length}`},intersections:{minLength:(e,t)=>e.isStricterThan(t)?e:t}});const Kn={implementation:En,Node:class extends un{impliedBasis=Fe.intrinsic.lengthBoundable.internal;traverseAllows=e=>e.length>=this.rule;reduceJsonSchema(e){switch(e.type){case"string":return e.minLength=this.rule,e;case"array":return e.minItems=this.rule,e;default:return mt.throwInternalOperandError("minLength",e)}}}},Ln={min:Rn.implementation,max:Sn.implementation,minLength:Kn.implementation,maxLength:qn.implementation,exactLength:In.implementation,after:wn.implementation,before:jn.implementation},Dn={min:Rn.Node,max:Sn.Node,minLength:Kn.Node,maxLength:qn.Node,exactLength:In.Node,after:wn.Node,before:jn.Node},Mn=pt({kind:"pattern",collapsibleKey:"rule",keys:{rule:{},flags:{}},normalize:e=>"string"==typeof e?{rule:e}:e instanceof RegExp?e.flags?{rule:e.source,flags:e.flags}:{rule:e.source}:e,obviatesBasisDescription:!0,obviatesBasisExpression:!0,hasAssociatedError:!0,intersectionIsOpen:!0,defaults:{description:e=>`matched by ${e.rule}`},intersections:{pattern:()=>null}});const zn={implementation:Mn,Node:class extends Gt{instance=new RegExp(this.rule,this.flags);expression=`${this.instance}`;traverseAllows=this.instance.test.bind(this.instance);compiledCondition=`${this.expression}.test(data)`;compiledNegation=`!${this.compiledCondition}`;impliedBasis=Fe.intrinsic.string.internal;reduceJsonSchema(e,t){return e.pattern?t.fallback.patternIntersection({code:"patternIntersection",base:e,pattern:this.rule}):(e.pattern=this.rule,e)}}},Un=(e,t)=>{const n=Fn(e);return t&&!t.includes(n)?v(`Root of kind ${n} should be one of ${t}`):n},Fn=e=>{if(Ye(e,"root"))return e.kind;if("string"==typeof e)return"$"===e[0]?"alias":e in f?"domain":"proto";if("function"==typeof e)return"proto";if("object"!=typeof e||null===e)return v(Tn(e));if("morphs"in e)return"morph";if("branches"in e||z(e))return"union";if("unit"in e)return"unit";if("reference"in e)return"alias";const t=Object.keys(e);return 0===t.length||t.some(e=>e in st)?"intersection":"proto"in e?"proto":"domain"in e?"domain":v(Tn(e))},Tn=e=>`${Ne(e)} is not a valid type schema`,Pn={},_n=e=>z(e)?e.map(e=>e.collapsibleJson):e.collapsibleJson,Jn={};Fe.nodesByRegisteredId=Jn;const Vn=e=>(Pn[e]??=0,`${e}${++Pn[e]}`),Wn=e=>{const t=Oi[e.kind],n=t.applyConfig?.(e.def,e.$.resolvedConfig)??e.def,r={},{meta:i,...s}=n,o=void 0===i?{}:"string"==typeof i?{description:i}:i,a=k(s).sort(([e],[t])=>ct(e)?ct(t)?lt(e)-lt(t):1:ct(t)||e<t?-1:1).filter(([e,t])=>{if(e.startsWith("meta.")){const n=e.slice(5);return o[n]=t,!1}return!0});for(const c of a){const n=c[0],i=t.keys[n];if(!i)return v(`Key ${n} is not valid on ${e.kind} schema`);const s=i.parse?i.parse(c[1],e):c[1];s===q||void 0===s&&!i.preserveUndefined||(r[n]=s)}if(t.reduce&&!e.prereduced){const n=t.reduce(r,e.$);if(n)return n instanceof Lt?n.throw():Gn(n,o)}return Hn({id:e.id,kind:e.kind,inner:r,meta:o,$:e.$})},Hn=({id:e,kind:t,inner:n,meta:r,$:i,ignoreCache:s})=>{const o=Oi[t],a=k(n),c=[];let l={};for(const[b,y]of a){const e=o.keys[b],t=e.serialize??(e.child?_n:ut);if(l[b]=t(y),!0===e.child){const e=y;z(e)?c.push(...e):c.push(e)}else"function"==typeof e.child&&c.push(...e.child(y))}o.finalizeInnerJson&&(l=o.finalizeInnerJson(l));let d={...l},u={};S(r)||(u=_(r,(e,t)=>[e,"examples"===e?t:ut(t)]),d.meta=Zn(u,"description",!0)),l=Zn(l,o.collapsibleKey,!1);const h=JSON.stringify({kind:t,...l});d=Zn(d,o.collapsibleKey,!1);const p=Zn(d,o.collapsibleKey,!0),f=JSON.stringify({kind:t,...d});if(i.nodesByHash[f]&&!s)return i.nodesByHash[f];const m={id:e,kind:t,impl:o,inner:n,innerEntries:a,innerJson:l,innerHash:h,meta:r,metaJson:u,json:d,hash:f,collapsibleJson:p,children:c};if("intersection"!==t)for(const b in n)"in"!==b&&"out"!==b&&(m[b]=n[b]);const g=new Si[t](m,i);return i.nodesByHash[f]=g},Gn=(e,t,n)=>(n&&Qe(Jn[n])&&b(`Unexpected attempt to overwrite node id ${n}`),Hn({id:n??Vn(t.alias??e.kind),kind:e.kind,inner:e.inner,meta:t,$:e.$})),Zn=(e,t,n)=>{const r=Object.keys(e);if(1===r.length&&r[0]===t){const r=e[t];if(n)return r;if(h(r,"object")&&(1===Object.keys(r).length||Array.isArray(r)))return r}return e},Yn=(e,t,n)=>{if(e.key!==t.key)return null;const r=e.key;let i=Pt(e.value,t.value,n);const s=e.required||t.required?"required":"optional";if(i instanceof Lt){if("optional"!==s)return i.withPrefixKey(e.key,e.required&&t.required?"required":"optional");i=Fe.intrinsic.never.internal}if("required"===s)return n.$.node("required",{key:r,value:i});const o=e.hasDefault()?t.hasDefault()?e.default===t.default?e.default:v(Xn(e.default,t.default)):e.default:t.hasDefault()?t.default:q;return n.$.node("optional",{key:r,value:i,default:o})};class Qn extends Ht{required="required"===this.kind;optional="optional"===this.kind;impliedBasis=Fe.intrinsic.object.internal;serializedKey=_e(this.key);compiledKey="string"==typeof this.key?this.key:this.serializedKey;flatRefs=a(this.value.flatRefs.map(e=>Bt([this.key,...e.path],e.node)),Bt([this.key],this.value));_transform(e,t){t.path.push(this.key);const n=super._transform(e,t);return t.path.pop(),n}hasDefault(){return"default"in this.inner}traverseAllows=(e,t)=>this.key in e?jt(this.key,()=>this.value.traverseAllows(e[this.key],t),t):this.optional;traverseApply=(e,t)=>{this.key in e?jt(this.key,()=>this.value.traverseApply(e[this.key],t),t):this.hasKind("required")&&t.errorFromNodeContext(this.errorContext)};compile(e){e.if(`${this.serializedKey} in data`,()=>e.traverseKey(this.serializedKey,`data${e.prop(this.key)}`,this.value)),this.hasKind("required")&&e.else(()=>"Apply"===e.traversalKind?e.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`):e.return(!1)),"Allows"===e.traversalKind&&e.return(!0)}}const Xn=(e,t)=>`Invalid intersection of default values ${Ne(e)} & ${Ne(t)}`,er=pt({kind:"optional",hasAssociatedError:!1,intersectionIsOpen:!0,keys:{key:{},value:{child:!0,parse:(e,t)=>t.$.parseSchema(e)},default:{preserveUndefined:!0}},normalize:e=>e,reduce:(e,t)=>{if(!1===t.resolvedConfig.exactOptionalPropertyTypes&&!e.value.allows(void 0))return t.node("optional",{...e,value:e.value.or(rs.undefined)},{prereduced:!0})},defaults:{description:e=>`${e.compiledKey}?: ${e.value.description}`},intersections:{optional:Yn}});const tr={implementation:er,Node:class extends Qn{constructor(...e){super(...e),"default"in this.inner&&sr(this.value,this.inner.default,this.key)}get outProp(){if(!this.hasDefault())return this;const{default:e,...t}=this.inner;return this.cacheGetter("outProp",this.$.node("required",t,{prereduced:!0}))}expression=this.hasDefault()?`${this.compiledKey}: ${this.value.expression} = ${Ne(this.inner.default)}`:`${this.compiledKey}?: ${this.value.expression}`;defaultValueMorph=rr(this);defaultValueMorphRef=this.defaultValueMorph&&Te(this.defaultValueMorph)}},nr={},rr=e=>{if(!e.hasDefault())return;const t=`{${e.compiledKey}: ${e.value.id} = ${ut(e.default)}}`;return nr[t]??=ir(e.key,e.value,e.default)},ir=(e,t,n)=>{if("function"==typeof n)return t.includesTransform?(r,i)=>(jt(e,()=>t(r[e]=n(),i),i),r):t=>(t[e]=n(),t);const r=t.includesTransform?t.assert(n):n;return h(r,"object")?(r,i)=>(jt(e,()=>t(r[e]=n,i),i),r):t=>(t[e]=r,t)},sr=(e,t,n)=>{const r=J(t);h(t,"object")&&!r&&v(or(n));const i=e.in(r?t():t);if(i instanceof $t){null===n&&v(`Default ${i.summary}`);const e=i.transform(e=>e.transform(e=>({...e,prefixPath:[n]})));v(`Default for ${e.summary}`)}return t},or=e=>`Non-primitive default ${null===e?"":"number"==typeof e?`for value at [${e}] `:`for ${_e(e)} `}must be specified as a function like () => ({my: 'object'})`;class ar extends Nt{constructor(e,t){super(e,t),Object.defineProperty(this,Ze,{value:"root",enumerable:!1})}get internal(){return this}get"~standard"(){return{vendor:"arktype",version:1,validate:e=>{const t=this(e);return t instanceof $t?t:{value:t}}}}as(){return this}brand(e){return""===e?v(cr):this}readonly(){return this}branches=this.hasKind("union")?this.inner.branches:[this];distribute(e,t){const n=this.branches.map(e);return t?.(n)??n}get shortDescription(){return this.meta.description??this.defaultShortDescription}toJsonSchema(e={}){const t=bt(this.$.resolvedConfig.toJsonSchema,e);t.useRefs||=this.isCyclic;const n="string"==typeof t.dialect?{$schema:t.dialect}:{};return Object.assign(n,this.toJsonSchemaRecurse(t)),t.useRefs&&(n.$defs=_(this.references,(e,n)=>n.isRoot()&&!n.alwaysExpandJsonSchema?[n.id,n.toResolvedJsonSchema(t)]:[])),n}toJsonSchemaRecurse(e){return e.useRefs&&!this.alwaysExpandJsonSchema?{$ref:`#/$defs/${this.id}`}:this.toResolvedJsonSchema(e)}get alwaysExpandJsonSchema(){return this.isBasis()||"alias"===this.kind||this.hasKind("union")&&this.isBoolean}toResolvedJsonSchema(e){const t=this.innerToJsonSchema(e);return Object.assign(t,this.metaJson)}intersect(e){const t=this.$.parseDefinition(e),n=this.rawIntersect(t);return n instanceof Lt?n:this.$.finalize(n)}rawIntersect(e){return Ft(this,e,this.$)}toNeverIfDisjoint(){return this}and(e){const t=this.intersect(e);return t instanceof Lt?t.throw():t}rawAnd(e){const t=this.rawIntersect(e);return t instanceof Lt?t.throw():t}or(e){const t=this.$.parseDefinition(e);return this.$.finalize(this.rawOr(t))}rawOr(e){const t=[...this.branches,...e.branches];return this.$.node("union",t)}map(e){return this.$.schema(this.applyStructuralOperation("map",[e]))}pick(...e){return this.$.schema(this.applyStructuralOperation("pick",e))}omit(...e){return this.$.schema(this.applyStructuralOperation("omit",e))}required(){return this.$.schema(this.applyStructuralOperation("required",[]))}partial(){return this.$.schema(this.applyStructuralOperation("partial",[]))}_keyof;keyof(){if(this._keyof)return this._keyof;const e=this.applyStructuralOperation("keyof",[]).reduce((e,t)=>e.intersect(t).toNeverIfDisjoint(),Fe.intrinsic.unknown.internal);return 0===e.branches.length&&v(zt(`keyof ${this.expression}`)),this._keyof=this.$.finalize(e)}get props(){return 1!==this.branches.length?v(hr(this.expression)):[...this.applyStructuralOperation("props",[])[0]]}merge(e){const t=this.$.parseDefinition(e);return this.$.schema(t.distribute(e=>this.applyStructuralOperation("merge",[ur(e)??v(pr("merge",e.expression))])))}applyStructuralOperation(e,t){return this.distribute(n=>{if(n.equals(Fe.intrinsic.object)&&"merge"!==e)return n;const r=ur(n);if(r||v(pr(e,n.expression)),"keyof"===e)return r.keyof();if("get"===e)return r.get(...t);if("props"===e)return r.props;const i="required"===e?"require":"partial"===e?"optionalize":e;return this.$.node("intersection",{...n.inner,structure:r[i](...t)})})}get(...e){return void 0===e[0]?this:this.$.schema(this.applyStructuralOperation("get",e))}extract(e){const t=this.$.parseDefinition(e);return this.$.schema(this.branches.filter(e=>e.extends(t)))}exclude(e){const t=this.$.parseDefinition(e);return this.$.schema(this.branches.filter(e=>!e.extends(t)))}array(){return this.$.schema(this.isUnknown()?{proto:Array}:{proto:Array,sequence:this},{prereduced:!0})}overlaps(e){return!(this.intersect(e)instanceof Lt)}extends(e){const t=this.intersect(e);return!(t instanceof Lt)&&this.equals(t)}ifExtends(e){return this.extends(e)?this:void 0}subsumes(e){return this.$.parseDefinition(e).extends(this)}configure(e,t="shallow"){return this.configureReferences(e,t)}describe(e,t="shallow"){return this.configure({description:e},t)}optional(){return[this,"?"]}default(e){return sr(this,e,null),[this,"=",e]}from(e){return this.assert(e)}_pipe(...e){const t=e.reduce((e,t)=>e.rawPipeOnce(t),this);return this.$.finalize(t)}tryPipe(...e){const t=e.reduce((e,t)=>e.rawPipeOnce(Ye(t,"root")?t:(e,n)=>{try{return t(e,n)}catch(r){return n.error({code:"predicate",predicate:t,actual:`aborted due to error:\n    ${r}\n`})}}),this);return this.$.finalize(t)}pipe=Object.assign(this._pipe.bind(this),{try:this.tryPipe.bind(this)});to(e){return this.$.finalize(this.toNode(this.$.parseDefinition(e)))}toNode(e){const t=Tt(this,e,this.$);return t instanceof Lt?t.throw():t}rawPipeOnce(e){return Ye(e,"root")?this.toNode(e):this.distribute(t=>t.hasKind("morph")?this.$.node("morph",{in:t.inner.in,morphs:[...t.morphs,e]}):this.$.node("morph",{in:t,morphs:[e]}),this.$.parseSchema)}narrow(e){return this.constrainOut("predicate",e)}constrain(e,t){return this._constrain("root",e,t)}constrainIn(e,t){return this._constrain("in",e,t)}constrainOut(e,t){return this._constrain("out",e,t)}_constrain(e,t,n){const r=this.$.node(t,n);if(r.isRoot())return r.isUnknown()?this:b(`Unexpected constraint node ${r}`);const i="root"===e?this:this[e];if(i.hasKind("morph")||r.impliedBasis&&!i.extends(r.impliedBasis))return((...e)=>v(en(...e)))(t,r.impliedBasis,this);const s=this.$.node("intersection",{[r.kind]:r}),o="out"===e?Tt(this,s,this.$):Ft(this,s,this.$);return o instanceof Lt&&o.throw(),this.$.finalize(o)}onUndeclaredKey(e){const t="string"==typeof e?e:e.rule,n="string"!=typeof e&&e.deep;return this.$.finalize(this.transform((e,n)=>"structure"===e?"ignore"===t?O(n,{undeclared:1})[1]:{...n,undeclared:t}:n,n?void 0:{shouldTransform:e=>!s(et,e.kind)}))}hasEqualMorphs(e){return!this.includesTransform&&!e.includesTransform||!!u(this.shallowMorphs,e.shallowMorphs)&&!!u(this.flatMorphs,e.flatMorphs,{isEqual:(e,t)=>e.propString===t.propString&&(e.node.hasKind("morph")&&t.node.hasKind("morph")?e.node.hasEqualMorphs(t.node):!(!e.node.hasKind("intersection")||!t.node.hasKind("intersection"))&&e.node.structure?.structuralMorphRef===t.node.structure?.structuralMorphRef)})}onDeepUndeclaredKey(e){return this.onUndeclaredKey({rule:e,deep:!0})}filter(e){return this.constrainIn("predicate",e)}divisibleBy(e){return this.constrain("divisor",e)}matching(e){return this.constrain("pattern",e)}atLeast(e){return this.constrain("min",e)}atMost(e){return this.constrain("max",e)}moreThan(e){return this.constrain("min",lr(e))}lessThan(e){return this.constrain("max",lr(e))}atLeastLength(e){return this.constrain("minLength",e)}atMostLength(e){return this.constrain("maxLength",e)}moreThanLength(e){return this.constrain("minLength",lr(e))}lessThanLength(e){return this.constrain("maxLength",lr(e))}exactlyLength(e){return this.constrain("exactLength",e)}atOrAfter(e){return this.constrain("after",e)}atOrBefore(e){return this.constrain("before",e)}laterThan(e){return this.constrain("after",lr(e))}earlierThan(e){return this.constrain("before",lr(e))}}const cr="Expected a non-empty brand name after #",lr=e=>"object"!=typeof e||e instanceof Date?{rule:e,exclusive:!0}:{...e,exclusive:!0},dr=(e,t)=>Ye(t,"root")?Ye(e,"root")?e.extends(t):t.allows(e):Ye(e,"root")?e.hasUnit(t):t===e,ur=e=>e.hasKind("morph")?null:e.hasKind("intersection")?e.inner.structure??("object"===e.basis?.domain?e.$.bindReference(Fe.intrinsic.emptyStructure):null):e.isBasis()&&"object"===e.domain?e.$.bindReference(Fe.intrinsic.emptyStructure):null,hr=e=>`Props cannot be extracted from a union. Use .distribute to extract props from each branch instead. Received:\n${e}`,pr=(e,t)=>`${e} operand must be an object (was ${t})`,fr=(e,t)=>_(dt(e),(e,n)=>[n,t]),mr=e=>e instanceof Lt?Fe.intrinsic.never.internal:e,gr=pt({kind:"alias",hasAssociatedError:!1,collapsibleKey:"reference",keys:{reference:{serialize:e=>e.startsWith("$")?e:`$ark.${e}`},resolve:{}},normalize:e=>"string"==typeof e?{reference:e}:e,defaults:{description:e=>e.reference},intersections:{alias:(e,t,n)=>n.$.lazilyResolve(()=>mr(Pt(e.resolution,t.resolution,n)),`${e.reference}${n.pipe?"=>":"&"}${t.reference}`),...fr("alias",(e,t,n)=>t.isUnknown()?e:t.isNever()?t:t.isBasis()&&!t.overlaps(Fe.intrinsic.object)?Lt.init("assignability",Fe.intrinsic.object,t):n.$.lazilyResolve(()=>mr(Pt(e.resolution,t,n)),`${e.reference}${n.pipe?"=>":"&"}${t.id}`))}});const br=(e,t)=>`Alias '${e}' has a shallow resolution cycle: ${[...t,e].join("->")}`,yr={implementation:gr,Node:class extends ar{expression=this.reference;structure=void 0;get resolution(){const e=this._resolve();return Jn[this.id]=e}_resolve(){if(this.resolve)return this.resolve();if("$"===this.reference[0])return this.$.resolveRoot(this.reference.slice(1));const e=this.reference;let t=Jn[e];const n=[];for(;Ye(t,"context");){if(n.includes(t.id))return v(br(t.id,n));n.push(t.id),t=Jn[t.id]}return Ye(t,"root")?t:b(`Unexpected resolution for reference ${this.reference}\nSeen: [${n.join("->")}] \nResolution: ${Ne(t)}`)}get resolutionId(){if(this.reference.includes("&")||this.reference.includes("=>"))return this.resolution.id;if("$"!==this.reference[0])return this.reference;const e=this.reference.slice(1),t=this.$.resolutions[e];return"string"==typeof t?t:Ye(t,"root")?t.id:b(`Unexpected resolution for reference ${this.reference}: ${Ne(t)}`)}get defaultShortDescription(){return f.object}innerToJsonSchema(e){return this.resolution.toJsonSchemaRecurse(e)}traverseAllows=(e,t)=>{const n=t.seen[this.reference];return!!n?.includes(e)||(t.seen[this.reference]=a(n,e),this.resolution.traverseAllows(e,t))};traverseApply=(e,t)=>{const n=t.seen[this.reference];n?.includes(e)||(t.seen[this.reference]=a(n,e),this.resolution.traverseApply(e,t))};compile(e){const t=this.resolutionId;e.if(`ctx.seen.${t} && ctx.seen.${t}.includes(data)`,()=>e.return(!0)),e.if(`!ctx.seen.${t}`,()=>e.line(`ctx.seen.${t} = []`)),e.line(`ctx.seen.${t}.push(data)`),e.return(e.invoke(t))}}};class xr extends ar{traverseApply=(e,t)=>{this.traverseAllows(e,t)||t.errorFromNodeContext(this.errorContext)};get errorContext(){return{code:this.kind,description:this.description,meta:this.meta,...this.inner}}get compiledErrorContext(){return ht(this.errorContext)}compile(e){"Allows"===e.traversalKind?e.return(this.compiledCondition):e.if(this.compiledNegation,()=>e.line(`${e.ctx}.errorFromNodeContext(${this.compiledErrorContext})`))}}const vr=pt({kind:"domain",hasAssociatedError:!0,collapsibleKey:"domain",keys:{domain:{},numberAllowsNaN:{}},normalize:e=>"string"==typeof e?{domain:e}:A(e,"numberAllowsNaN")&&"number"!==e.domain?v($r.writeBadAllowNanMessage(e.domain)):e,applyConfig:(e,t)=>void 0===e.numberAllowsNaN&&"number"===e.domain&&t.numberAllowsNaN?{...e,numberAllowsNaN:!0}:e,defaults:{description:e=>f[e.domain],actual:e=>Number.isNaN(e)?"NaN":f[p(e)]},intersections:{domain:(e,t)=>"number"===e.domain&&"number"===t.domain?e.numberAllowsNaN?t:e:Lt.init("domain",e,t)}});const $r={implementation:vr,Node:class extends xr{requiresNaNCheck="number"===this.domain&&!this.numberAllowsNaN;traverseAllows=this.requiresNaNCheck?e=>"number"==typeof e&&!Number.isNaN(e):e=>p(e)===this.domain;compiledCondition="object"===this.domain?'((typeof data === "object" && data !== null) || typeof data === "function")':`typeof data === "${this.domain}"${this.requiresNaNCheck?" && !Number.isNaN(data)":""}`;compiledNegation="object"===this.domain?'((typeof data !== "object" || data === null) && typeof data !== "function")':`typeof data !== "${this.domain}"${this.requiresNaNCheck?" || Number.isNaN(data)":""}`;expression=this.numberAllowsNaN?"number | NaN":this.domain;get nestableExpression(){return this.numberAllowsNaN?`(${this.expression})`:this.expression}get defaultShortDescription(){return f[this.domain]}innerToJsonSchema(e){return"bigint"===this.domain||"symbol"===this.domain?e.fallback.domain({code:"domain",base:{},domain:this.domain}):{type:this.domain}}},writeBadAllowNanMessage:e=>`numberAllowsNaN may only be specified with domain "number" (was ${e})`},kr=pt({kind:"intersection",hasAssociatedError:!0,normalize:e=>{if(Qe(e))return e;const{structure:t,...n}=e,r=!!t,i=t??{},s=_(n,(e,t)=>w(e,ot)?(r&&v(`Flattened structure key ${e} cannot be specified alongside a root 'structure' key.`),i[e]=t,[]):[e,t]);return!Ye(i,"constraint")&&S(i)||(s.structure=i),s},finalizeInnerJson:({structure:e,...t})=>h(e,"object")?{...e,...t}:t,keys:{domain:{child:!0,parse:(e,t)=>t.$.node("domain",e)},proto:{child:!0,parse:(e,t)=>t.$.node("proto",e)},structure:{child:!0,parse:(e,t)=>t.$.node("structure",e),serialize:e=>{if(!e.sequence?.minLength)return e.collapsibleJson;const{sequence:t,...n}=e.collapsibleJson,{minVariadicLength:r,...i}=t;return{...n,sequence:i.variadic&&1===Object.keys(i).length?i.variadic:i}}},divisor:{child:!0,parse:Zt("divisor")},max:{child:!0,parse:Zt("max")},min:{child:!0,parse:Zt("min")},maxLength:{child:!0,parse:Zt("maxLength")},minLength:{child:!0,parse:Zt("minLength")},exactLength:{child:!0,parse:Zt("exactLength")},before:{child:!0,parse:Zt("before")},after:{child:!0,parse:Zt("after")},pattern:{child:!0,parse:Zt("pattern")},predicate:{child:!0,parse:Zt("predicate")}},reduce:(e,t)=>jr({},e,{$:t,invert:!1,pipe:!1}),defaults:{description:e=>{if(0===e.children.length)return"unknown";if(e.structure)return e.structure.description;const t=[];if(e.basis&&!e.refinements.some(e=>e.impl.obviatesBasisDescription)&&t.push(e.basis.description),e.refinements.length){const n=e.refinements.toSorted((e,t)=>"min"===e.kind&&"max"===t.kind?-1:0).map(e=>e.description);t.push(...n)}return e.inner.predicate&&t.push(...e.inner.predicate.map(e=>e.description)),t.join(" and ")},expected:e=>`  \u25e6 ${e.errors.map(e=>e.expected).join("\n  \u25e6 ")}`,problem:e=>`(${e.actual}) must be...\n${e.expected}`},intersections:{intersection:(e,t,n)=>jr(e.inner,t.inner,n),...fr("intersection",(e,t,n)=>{if(0===e.children.length)return t;const{domain:r,proto:i,...s}=e.inner,o=i??r,a=o?Pt(o,t,n):t;return a instanceof Lt?a:e?.basis?.equals(a)?e:e.$.node("intersection",{...s,[a.kind]:a},{prereduced:!0})})}});const wr={implementation:kr,Node:class extends ar{basis=this.inner.domain??this.inner.proto??null;refinements=this.children.filter(e=>e.isRefinement());structure=this.inner.structure;expression=Ar(this);get shallowMorphs(){return this.inner.structure?.structuralMorph?[this.inner.structure.structuralMorph]:[]}get defaultShortDescription(){return this.basis?.defaultShortDescription??"present"}innerToJsonSchema(e){return this.children.reduce((t,n)=>n.isBasis()?n.toJsonSchemaRecurse(e):n.reduceJsonSchema(t,e),{})}traverseAllows=(e,t)=>this.children.every(n=>n.traverseAllows(e,t));traverseApply=(e,t)=>{const n=t.currentErrorCount;if(!(this.basis&&(this.basis.traverseApply(e,t),t.currentErrorCount>n))){if(this.refinements.length){for(let r=0;r<this.refinements.length-1;r++)if(this.refinements[r].traverseApply(e,t),t.failFast&&t.currentErrorCount>n)return;if(this.refinements.at(-1).traverseApply(e,t),t.currentErrorCount>n)return}if(!(this.structure&&(this.structure.traverseApply(e,t),t.currentErrorCount>n))&&this.inner.predicate){for(let r=0;r<this.inner.predicate.length-1;r++)if(this.inner.predicate[r].traverseApply(e,t),t.failFast&&t.currentErrorCount>n)return;this.inner.predicate.at(-1).traverseApply(e,t)}}};compile(e){if("Allows"!==e.traversalKind){if(e.initializeErrorCount(),this.basis&&(e.check(this.basis),this.children.length>1&&e.returnIfFail()),this.refinements.length){for(let t=0;t<this.refinements.length-1;t++)e.check(this.refinements[t]),e.returnIfFailFast();e.check(this.refinements.at(-1)),(this.structure||this.inner.predicate)&&e.returnIfFail()}if(this.structure&&(e.check(this.structure),this.inner.predicate&&e.returnIfFail()),this.inner.predicate){for(let t=0;t<this.inner.predicate.length-1;t++)e.check(this.inner.predicate[t]),e.returnIfFail();e.check(this.inner.predicate.at(-1))}}else{for(const t of this.children)e.check(t);e.return(!0)}}}},Ar=e=>{let t=e.structure?.expression||`${e.basis&&!e.refinements.some(e=>e.impl.obviatesBasisExpression)?e.basis.nestableExpression+" ":""}${e.refinements.map(e=>e.expression).join(" & ")}`||"unknown";return"Array == 0"===t&&(t="[]"),t},jr=(e,t,n)=>{const r={},i=e.proto??e.domain,s=t.proto??t.domain,o=i?s?Pt(i,s,n):i:s;return o instanceof Lt?o:(o&&(r[o.kind]=o),Yt({kind:"intersection",baseInner:r,l:Qt(e),r:Qt(t),roots:[],ctx:n}))},Nr=pt({kind:"morph",hasAssociatedError:!1,keys:{in:{child:!0,parse:(e,t)=>t.$.parseSchema(e)},morphs:{parse:r,serialize:e=>e.map(e=>Ye(e,"root")?e.json:Te(e))},declaredIn:{child:!1,serialize:e=>e.json},declaredOut:{child:!1,serialize:e=>e.json}},normalize:e=>e,defaults:{description:e=>`a morph from ${e.in.description} to ${e.out?.description??"unknown"}`},intersections:{morph:(e,t,n)=>{if(!e.hasEqualMorphs(t))return v(Or(e.expression,t.expression));const r=Pt(e.in,t.in,n);if(r instanceof Lt)return r;const i={morphs:e.morphs};if(e.declaredIn||t.declaredIn){const r=Pt(e.in,t.in,n);if(r instanceof Lt)return r.throw();i.declaredIn=r}if(e.declaredOut||t.declaredOut){const r=Pt(e.out,t.out,n);if(r instanceof Lt)return r.throw();i.declaredOut=r}return r.distribute(e=>n.$.node("morph",{...i,in:e}),n.$.parseSchema)},...fr("morph",(e,t,n)=>{const r=e.inner.in?Pt(e.inner.in,t,n):t;return r instanceof Lt?r:r.equals(e.inner.in)?e:n.$.node("morph",{...e.inner,in:r})})}});const Ir={implementation:Nr,Node:class extends ar{serializedMorphs=this.morphs.map(Te);compiledMorphs=`[${this.serializedMorphs}]`;lastMorph=this.inner.morphs.at(-1);lastMorphIfNode=Ye(this.lastMorph,"root")?this.lastMorph:void 0;introspectableIn=this.inner.in;introspectableOut=this.lastMorphIfNode?Object.assign(this.referencesById,this.lastMorphIfNode.referencesById)&&this.lastMorphIfNode.out:void 0;get shallowMorphs(){return Array.isArray(this.inner.in?.shallowMorphs)?[...this.inner.in.shallowMorphs,...this.morphs]:this.morphs}get in(){return this.declaredIn??this.inner.in?.in??Fe.intrinsic.unknown.internal}get out(){return this.declaredOut??this.introspectableOut??Fe.intrinsic.unknown.internal}declareIn(e){return this.$.node("morph",{...this.inner,declaredIn:e})}declareOut(e){return this.$.node("morph",{...this.inner,declaredOut:e})}expression=`(In: ${this.in.expression}) => ${this.lastMorphIfNode?"To":"Out"}<${this.out.expression}>`;get defaultShortDescription(){return this.in.meta.description??this.in.defaultShortDescription}innerToJsonSchema(e){return e.fallback.morph({code:"morph",base:this.in.toJsonSchemaRecurse(e),out:this.introspectableOut?.toJsonSchemaRecurse(e)??null})}compile(e){if("Allows"!==e.traversalKind)this.introspectableIn&&e.line(e.invoke(this.introspectableIn)),e.line(`ctx.queueMorphs(${this.compiledMorphs})`);else{if(!this.introspectableIn)return;e.return(e.invoke(this.introspectableIn))}}traverseAllows=(e,t)=>!this.introspectableIn||this.introspectableIn.traverseAllows(e,t);traverseApply=(e,t)=>{this.introspectableIn&&this.introspectableIn.traverseApply(e,t),t.queueMorphs(this.morphs)};hasEqualMorphs(e){return u(this.morphs,e.morphs,{isEqual:(e,t)=>e===t||Ye(e,"root")&&Ye(t,"root")&&e.equals(t)})}}},Or=(e,t)=>`The intersection of distinct morphs at a single path is indeterminate:\nLeft: ${e}\nRight: ${t}`,Sr=pt({kind:"proto",hasAssociatedError:!0,collapsibleKey:"proto",keys:{proto:{serialize:e=>F(e)??ut(e)},dateAllowsInvalid:{}},normalize:e=>{const t="string"==typeof e?{proto:L[e]}:"function"==typeof e?Qe(e)?e:{proto:e}:"string"==typeof e.proto?{...e,proto:L[e.proto]}:e;return"function"!=typeof t.proto&&v(Cr.writeInvalidSchemaMessage(t.proto)),A(t,"dateAllowsInvalid")&&t.proto!==Date&&v(Cr.writeBadInvalidDateMessage(t.proto)),t},applyConfig:(e,t)=>void 0===e.dateAllowsInvalid&&e.proto===Date&&t.dateAllowsInvalid?{...e,dateAllowsInvalid:!0}:e,defaults:{description:e=>e.builtinName?U[e.builtinName]:`an instance of ${e.proto.name}`,actual:e=>e instanceof Date&&"Invalid Date"===e.toString()?"an invalid Date":M(e)},intersections:{proto:(e,t)=>e.proto===Date&&t.proto===Date?e.dateAllowsInvalid?t:e:T(e.proto,t.proto)?e:T(t.proto,e.proto)?t:Lt.init("proto",e,t),domain:(e,t)=>"object"===t.domain?e:Lt.init("domain",Fe.intrinsic.object.internal,t)}});const Cr={implementation:Sr,Node:class extends xr{builtinName=F(this.proto);serializedConstructor=this.json.proto;requiresInvalidDateCheck=this.proto===Date&&!this.dateAllowsInvalid;traverseAllows=this.requiresInvalidDateCheck?e=>e instanceof Date&&"Invalid Date"!==e.toString():e=>e instanceof this.proto;compiledCondition=`data instanceof ${this.serializedConstructor}${this.requiresInvalidDateCheck?' && data.toString() !== "Invalid Date"':""}`;compiledNegation=`!(${this.compiledCondition})`;innerToJsonSchema(e){switch(this.builtinName){case"Array":return{type:"array"};case"Date":return e.fallback.date?.({code:"date",base:{}})??e.fallback.proto({code:"proto",base:{},proto:this.proto});default:return e.fallback.proto({code:"proto",base:{},proto:this.proto})}}expression=this.dateAllowsInvalid?"Date | InvalidDate":this.proto.name;get nestableExpression(){return this.dateAllowsInvalid?`(${this.expression})`:this.expression}domain="object";get defaultShortDescription(){return this.description}},writeBadInvalidDateMessage:e=>`dateAllowsInvalid may only be specified with constructor Date (was ${e.name})`,writeInvalidSchemaMessage:e=>`instanceOf operand must be a function (was ${p(e)})`},qr=pt({kind:"union",hasAssociatedError:!0,collapsibleKey:"branches",keys:{ordered:{},branches:{child:!0,parse:(e,t)=>{const n=[];for(const r of e){const e=Ye(r,"root")?r.branches:t.$.parseSchema(r).branches;for(const r of e)if(r.hasKind("morph")){const e=n.findIndex(e=>e.hasKind("morph")&&e.hasEqualMorphs(r));if(-1===e)n.push(r);else{const i=n[e];n[e]=t.$.node("morph",{...i.inner,in:i.in.rawOr(r.in)})}}else n.push(r)}return t.def.ordered||n.sort((e,t)=>e.hash<t.hash?-1:1),n}}},normalize:e=>z(e)?{branches:e}:e,reduce:(e,t)=>{const n=Jr(e);return 1===n.length?n[0]:n.length!==e.branches.length?t.node("union",{...e,branches:n},{prereduced:!0}):void 0},defaults:{description:e=>e.distribute(e=>e.description,Pr),expected:e=>{const t=(n=e.errors,r="propString",n.reduce((e,t)=>{const n=t[r];return e[n]=a(e[n],t),e},{}));var n,r;const i=Object.entries(t).map(([e,t])=>{const n=[];for(const s of t)d(n,s.expected);const r=Pr(n),i=t.every(e=>e.actual===t[0].actual)?t[0].actual:Ne(t[0].data);return`${e&&`${e} `}must be ${r}${i&&` (was ${i})`}`});return Pr(i)},problem:e=>e.expected,message:e=>e.problem},intersections:{union:(e,t,n)=>{if(e.isNever!==t.isNever)return Lt.init("presence",e,t);let r;return e.ordered?(t.ordered&&v(Gr(e.expression,t.expression)),r=_r(t.branches,e.branches,n),r instanceof Lt&&r.invert()):r=_r(e.branches,t.branches,n),r instanceof Lt?r:n.$.parseSchema(e.ordered||t.ordered?{branches:r,ordered:!0}:{branches:r})},...fr("union",(e,t,n)=>{const r=_r(e.branches,[t],n);return r instanceof Lt?r:1===r.length?r[0]:n.$.parseSchema(e.ordered?{branches:r,ordered:!0}:{branches:r})})}});const Br=(e,t)=>{const n=e.sort((e,t)=>Object.keys(t.cases).length-Object.keys(e.cases).length)[0];return{best:n,location:{kind:n.kind,path:n.path,optionallyChainedPropString:Lr(n.path)},defaultEntries:t.branches.map((e,t)=>({originalIndex:t,branch:e})),node:t}},Rr=(e,t)=>{const n=e.best.cases[t],r=Kr(n.condition,e.location.path,e.node.$);let i=[];const s=[];for(let o=0;o<e.defaultEntries.length;o++){const t=e.defaultEntries[o];if(n.branchIndices.includes(t.originalIndex)){const n=Wr(e.node.branches[t.originalIndex],e.location);null===n?i=null:i?.push({originalIndex:t.originalIndex,branch:n})}else if(t.branch.hasKind("alias")&&r.hasKind("domain")&&"object"===r.domain)i?.push(t);else{if(t.branch.in.overlaps(r)){const n=Wr(t.branch,e.location);i?.push({originalIndex:t.originalIndex,branch:n})}s.push(t)}}return e.defaultEntries=s,i},Er=(e,t)=>e.filter(e=>{const n=Object.values(e.cases).map(e=>e.branchIndices);for(let r=0;r<n.length-1;r++){const e=n[r];for(let i=r+1;i<n.length;i++){const r=n[i];for(const n of e)for(const e of r)if(n>e&&t[n].overlaps(t[e]))return!1}}return!0}),Kr=(e,t,n)=>{let r="undefined"===e?n.node("unit",{unit:void 0}):"null"===e?n.node("unit",{unit:null}):"boolean"===e?n.units([!0,!1]):e;for(let i=t.length-1;i>=0;i--){const e=t[i];r=n.node("intersection","number"==typeof e?{proto:"Array",sequence:[...o(e).map(e=>({})),r]}:{domain:"object",required:[{key:e,value:r}]})}return r},Lr=e=>e.reduce((e,t)=>e+Je(t,!0),"data"),Dr=Te(m),Mr=Te(Ne),zr={implementation:qr,Node:class extends ar{isBoolean=2===this.branches.length&&this.branches[0].hasUnit(!1)&&this.branches[1].hasUnit(!0);get branchGroups(){const e=[];let t=-1;for(const n of this.branches)n.hasKind("unit")&&"boolean"===n.domain?-1===t?(t=e.length,e.push(n)):e[t]=Fe.intrinsic.boolean:e.push(n);return e}unitBranches=this.branches.filter(e=>e.in.hasKind("unit"));discriminant=this.discriminate();discriminantJson=this.discriminant?Ur(this.discriminant):null;expression=this.distribute(e=>e.nestableExpression,Tr);createBranchedOptimisticRootApply(){return(e,t)=>{const n=this.traverseOptimistic(e);if(n!==q)return n;const r=new At(e,this.$.resolvedConfig);return this.traverseApply(e,r),r.finalize(t)}}get shallowMorphs(){return this.branches.reduce((e,t)=>d(e,t.shallowMorphs),[])}get defaultShortDescription(){return this.distribute(e=>e.defaultShortDescription,Pr)}innerToJsonSchema(e){if(1===this.branchGroups.length&&this.branchGroups[0].equals(Fe.intrinsic.boolean))return{type:"boolean"};const t=this.branchGroups.map(t=>t.toJsonSchemaRecurse(e));return t.every(e=>1===Object.keys(e).length&&A(e,"const"))?{enum:t.map(e=>e.const)}:{anyOf:t}}traverseAllows=(e,t)=>this.branches.some(n=>n.traverseAllows(e,t));traverseApply=(e,t)=>{const n=[];for(let r=0;r<this.branches.length;r++){if(t.pushBranch(),this.branches[r].traverseApply(e,t),!t.hasError())return this.branches[r].includesTransform?t.queuedMorphs.push(...t.popBranch().queuedMorphs):t.popBranch();n.push(t.popBranch().error)}t.errorFromNodeContext({code:"union",errors:n,meta:this.meta})};traverseOptimistic=e=>{for(let t=0;t<this.branches.length;t++){const n=this.branches[t];if(n.traverseAllows(e))return n.contextFreeMorph?n.contextFreeMorph(e):e}return q};compile(e){if(!this.discriminant||this.unitBranches.length===this.branches.length&&2===this.branches.length)return this.compileIndiscriminable(e);let t=this.discriminant.optionallyChainedPropString;"domain"===this.discriminant.kind&&(t=`typeof ${t} === "object" ? ${t} === null ? "null" : "object" : typeof ${t} === "function" ? "object" : typeof ${t}`);const n=this.discriminant.cases,r=Object.keys(n),{optimistic:i}=e;if(e.optimistic=!1,e.block(`switch(${t})`,()=>{for(const t in n){const r=n[t],s="default"===t?t:`case ${t}`;e.line(`${s}: return ${!0===r?i?e.data:r:i?`${e.invoke(r)} ? ${r.contextFreeMorph?`${Te(r.contextFreeMorph)}(${e.data})`:e.data} : "${q}"`:e.invoke(r)}`)}return e}),"Allows"===e.traversalKind)return void e.return(!!i&&`"${q}"`);const s=Pr("domain"===this.discriminant.kind?r.map(e=>{const t=e.slice(1,-1);return"function"===t?f.object:f[t]}):r),o=this.discriminant.path.map(e=>"symbol"==typeof e?Te(e):JSON.stringify(e)),a=JSON.stringify(s),c="domain"===this.discriminant.kind?`${Dr}[${t}]`:`${Mr}(${t})`;e.line(`ctx.errorFromNodeContext({\n\tcode: "predicate",\n\texpected: ${a},\n\tactual: ${c},\n\trelativePath: [${o}],\n\tmeta: ${this.compiledMeta}\n})`)}compileIndiscriminable(e){if("Apply"===e.traversalKind){e.const("errors","[]");for(const t of this.branches)e.line("ctx.pushBranch()").line(e.invoke(t)).if("!ctx.hasError()",()=>e.return(t.includesTransform?"ctx.queuedMorphs.push(...ctx.popBranch().queuedMorphs)":"ctx.popBranch()")).line("errors.push(ctx.popBranch().error)");e.line(`ctx.errorFromNodeContext({ code: "union", errors, meta: ${this.compiledMeta} })`)}else{const{optimistic:t}=e;e.optimistic=!1;for(const n of this.branches)e.if(`${e.invoke(n)}`,()=>e.return(!t||(n.contextFreeMorph?`${Te(n.contextFreeMorph)}(${e.data})`:e.data)));e.return(!!t&&`"${q}"`)}}get nestableExpression(){return this.isBoolean?"boolean":`(${this.expression})`}discriminate(){if(this.branches.length<2||this.isCyclic)return null;if(this.unitBranches.length===this.branches.length){return{kind:"unit",path:[],optionallyChainedPropString:"data",cases:_(this.unitBranches,(e,t)=>[`${t.in.serializedValue}`,!t.hasKind("morph")||t])}}const e=[];for(let i=0;i<this.branches.length-1;i++){const t=this.branches[i];for(let n=i+1;n<this.branches.length;n++){const r=this.branches[n],s=Ft(t.in,r.in,t.$);if(s instanceof Lt)for(const t of s){if(!t.kind||t.optional)continue;let r,s;if("domain"===t.kind){const e=t.l,n=t.r;r=`"${"string"==typeof e?e:e.domain}"`,s=`"${"string"==typeof n?n:n.domain}"`}else{if("unit"!==t.kind)continue;r=t.l.serializedValue,s=t.r.serializedValue}const o=e.find(e=>u(e.path,t.path)&&e.kind===t.kind);o?(o.cases[r]?o.cases[r].branchIndices=d(o.cases[r].branchIndices,i):o.cases[r]??={branchIndices:[i],condition:t.l},o.cases[s]?o.cases[s].branchIndices=d(o.cases[s].branchIndices,n):o.cases[s]??={branchIndices:[n],condition:t.r}):e.push({kind:t.kind,cases:{[r]:{branchIndices:[i],condition:t.l},[s]:{branchIndices:[n],condition:t.r}},path:t.path})}}}const t=this.ordered?Er(e,this.branches):e;if(!t.length)return null;const n=Br(t,this),r={};for(const i in n.best.cases){const e=Rr(n,i);if(null===e){r[i]=!0;continue}if(e.length===this.branches.length)return null;this.ordered&&e.sort((e,t)=>e.originalIndex-t.originalIndex);const t=e.map(e=>e.branch),s=1===t.length?t[0]:this.$.node("union",this.ordered?{branches:t,ordered:!0}:t);Object.assign(this.referencesById,s.referencesById),r[i]=s}if(n.defaultEntries.length){const e=n.defaultEntries.map(e=>e.branch);r.default=this.$.node("union",this.ordered?{branches:e,ordered:!0}:e,{prereduced:!0}),Object.assign(this.referencesById,r.default.referencesById)}return Object.assign(n.location,{cases:r})}}},Ur=e=>({kind:e.kind,path:e.path.map(e=>"string"==typeof e?e:_e(e)),cases:_(e.cases,(e,t)=>[e,!0===t?t:t.hasKind("union")&&t.discriminantJson?t.discriminantJson:t.json])}),Fr={delimiter:" | ",finalDelimiter:" | "},Tr=e=>Pr(e,Fr),Pr=(e,t)=>{const n=t?.delimiter??", ",r=t?.finalDelimiter??" or ";if(0===e.length)return"never";if(1===e.length)return e[0];if(2===e.length&&"false"===e[0]&&"true"===e[1]||"true"===e[0]&&"false"===e[1])return"boolean";const i={},s=e.filter(e=>!i[e]&&(i[e]=!0)),o=s.pop();return`${s.join(n)}${s.length?r:""}${o}`},_r=(e,t,n)=>{const r=t.map(()=>[]);for(let s=0;s<e.length;s++){let i={};for(let o=0;o<t.length;o++){if(null===r[o])continue;if(e[s].equals(t[o])){r[o]=null,i={};break}const a=Pt(e[s],t[o],n);if(!(a instanceof Lt)){if(a.equals(e[s])){r[o].push(e[s]),i={};break}a.equals(t[o])?r[o]=null:i[o]=a}}for(const e in i)r[e][s]=i[e]}const i=r.flatMap((e,n)=>e?.flatMap(e=>e.branches)??t[n]);return 0===i.length?Lt.init("union",e,t):i},Jr=({branches:e,ordered:t})=>{if(e.length<2)return e;const n=e.map(()=>!0);for(let r=0;r<e.length;r++)for(let i=r+1;i<e.length&&n[r]&&n[i];i++){if(e[r].equals(e[i])){n[i]=!1;continue}const s=Ft(e[r].in,e[i].in,e[0].$);s instanceof Lt||(t||Vr(e[r],e[i]),s.equals(e[r].in)?n[r]=!!t:s.equals(e[i].in)&&(n[i]=!1))}return e.filter((e,t)=>n[t])},Vr=(e,t)=>{(e.includesTransform||t.includesTransform)&&(u(e.shallowMorphs,t.shallowMorphs)||v(Hr(e.expression,t.expression)),u(e.flatMorphs,t.flatMorphs,{isEqual:(e,t)=>e.propString===t.propString&&(e.node.hasKind("morph")&&t.node.hasKind("morph")?e.node.hasEqualMorphs(t.node):!(!e.node.hasKind("intersection")||!t.node.hasKind("intersection"))&&e.node.structure?.structuralMorphRef===t.node.structure?.structuralMorphRef)})||v(Hr(e.expression,t.expression)))},Wr=(e,t)=>e.transform((e,t)=>"domain"===e||"unit"===e?null:t,{shouldTransform:(e,n)=>{const r=Lr(n.path);return!!t.optionallyChainedPropString.startsWith(r)&&(!(!e.hasKind("domain")||"object"!==e.domain)||(!(!e.hasKind("domain")&&"unit"!==t.kind||r!==t.optionallyChainedPropString)||0!==e.children.length&&"index"!==e.kind))}}),Hr=(e,t)=>`An unordered union of a type including a morph and a type with overlapping input is indeterminate:\nLeft: ${e}\nRight: ${t}`,Gr=(e,t)=>`The intersection of two ordered unions is indeterminate:\nLeft: ${e}\nRight: ${t}`,Zr=pt({kind:"unit",hasAssociatedError:!0,keys:{unit:{preserveUndefined:!0,serialize:e=>e instanceof Date?e.toISOString():ut(e)}},normalize:e=>e,defaults:{description:e=>Ne(e.unit),problem:({expected:e,actual:t})=>""+(e===t?`must be reference equal to ${e} (serialized to the same value)`:`must be ${e} (was ${t})`)},intersections:{unit:(e,t)=>Lt.init("unit",e,t),...fr("unit",(e,t)=>{if(t.allows(e.unit))return e;const n=t.hasKind("intersection")?t.basis:t;if(n){const t=n.hasKind("domain")?n:Fe.intrinsic.object;if(e.domain!==t.domain){const n="undefined"===e.domain||"null"===e.domain||"boolean"===e.domain?e.domain:Fe.intrinsic[e.domain];return Lt.init("domain",n,t)}}return Lt.init("assignability",e,t.hasKind("intersection")?t.children.find(t=>!t.allows(e.unit)):t)})}});const Yr={implementation:Zr,Node:class extends xr{compiledValue=this.json.unit;serializedValue="string"==typeof this.unit||this.unit instanceof Date?JSON.stringify(this.compiledValue):`${this.compiledValue}`;compiledCondition=Qr(this.unit,this.serializedValue);compiledNegation=Qr(this.unit,this.serializedValue,"negated");expression=Ne(this.unit);domain=p(this.unit);get defaultShortDescription(){return"object"===this.domain?f.object:this.description}innerToJsonSchema(e){return null===this.unit?{type:"null"}:Fe.intrinsic.jsonPrimitive.allows(this.unit)?{const:this.unit}:e.fallback.unit({code:"unit",base:{},unit:this.unit})}traverseAllows=this.unit instanceof Date?e=>e instanceof Date&&e.toISOString()===this.compiledValue:Number.isNaN(this.unit)?e=>Number.isNaN(e):e=>e===this.unit}},Qr=(e,t,n)=>{if(e instanceof Date){const e=`data instanceof Date && data.toISOString() === ${t}`;return n?`!(${e})`:e}return Number.isNaN(e)?(n?"!":"")+"Number.isNaN(data)":`data ${n?"!":"="}== ${t}`},Xr=pt({kind:"index",hasAssociatedError:!1,intersectionIsOpen:!0,keys:{signature:{child:!0,parse:(e,t)=>{const n=t.$.parseSchema(e);if(!n.extends(Fe.intrinsic.key))return v(ni(n.expression));const r=n.branches.filter(e=>e.hasKind("unit"));return r.length?v(ti(r.map(e=>Ne(e.unit)))):n}},value:{child:!0,parse:(e,t)=>t.$.parseSchema(e)}},normalize:e=>e,defaults:{description:e=>`[${e.signature.expression}]: ${e.value.description}`},intersections:{index:(e,t,n)=>{if(e.signature.equals(t.signature)){const r=Pt(e.value,t.value,n),i=r instanceof Lt?Fe.intrinsic.never.internal:r;return n.$.node("index",{signature:e.signature,value:i})}return e.signature.extends(t.signature)&&e.value.subsumes(t.value)?t:t.signature.extends(e.signature)&&t.value.subsumes(e.value)?e:null}}});const ei={implementation:Xr,Node:class extends Ht{impliedBasis=Fe.intrinsic.object.internal;expression=`[${this.signature.expression}]: ${this.value.expression}`;flatRefs=a(this.value.flatRefs.map(e=>Bt([this.signature,...e.path],e.node)),Bt([this.signature],this.value));traverseAllows=(e,t)=>C(e).every(e=>!this.signature.traverseAllows(e[0],t)||jt(e[0],()=>this.value.traverseAllows(e[1],t),t));traverseApply=(e,t)=>{for(const n of C(e))this.signature.traverseAllows(n[0],t)&&jt(n[0],()=>this.value.traverseApply(n[1],t),t)};_transform(e,t){t.path.push(this.signature);const n=super._transform(e,t);return t.path.pop(),n}compile(){}}},ti=e=>`Index keys ${e.join(", ")} should be specified as named props.`,ni=e=>`Indexed key definition '${e}' must be a string or symbol`,ri=pt({kind:"required",hasAssociatedError:!0,intersectionIsOpen:!0,keys:{key:{},value:{child:!0,parse:(e,t)=>t.$.parseSchema(e)}},normalize:e=>e,defaults:{description:e=>`${e.compiledKey}: ${e.value.description}`,expected:e=>e.missingValueDescription,actual:()=>"missing"},intersections:{required:Yn,optional:Yn}});const ii={implementation:ri,Node:class extends Qn{expression=`${this.compiledKey}: ${this.value.expression}`;errorContext=Object.freeze({code:"required",missingValueDescription:this.value.defaultShortDescription,relativePath:[this.key],meta:this.meta});compiledErrorContext=ht(this.errorContext)}},si=pt({kind:"sequence",hasAssociatedError:!1,collapsibleKey:"variadic",keys:{prefix:{child:!0,parse:(e,t)=>{if(0!==e.length)return e.map(e=>t.$.parseSchema(e))}},optionals:{child:!0,parse:(e,t)=>{if(0!==e.length)return e.map(e=>t.$.parseSchema(e))}},defaultables:{child:e=>e.map(e=>e[0]),parse:(e,t)=>{if(0!==e.length)return e.map(e=>{const n=t.$.parseSchema(e[0]);return sr(n,e[1],null),[n,e[1]]})},serialize:e=>e.map(e=>[e[0].collapsibleJson,ut(e[1])])},variadic:{child:!0,parse:(e,t)=>t.$.parseSchema(e,t)},minVariadicLength:{parse:e=>0===e?void 0:e},postfix:{child:!0,parse:(e,t)=>{if(0!==e.length)return e.map(e=>t.$.parseSchema(e))}}},normalize:e=>{if("string"==typeof e)return{variadic:e};if("variadic"in e||"prefix"in e||"defaultables"in e||"optionals"in e||"postfix"in e||"minVariadicLength"in e){if(e.postfix?.length){if(!e.variadic)return v(hi);if(e.optionals?.length||e.defaultables?.length)return v(ui)}return e.minVariadicLength&&!e.variadic?v("minVariadicLength may not be specified without a variadic element"):e}return{variadic:e}},reduce:(e,t)=>{let n=e.minVariadicLength??0;const r=e.prefix?.slice()??[],i=e.defaultables?.slice()??[],s=e.optionals?.slice()??[],o=e.postfix?.slice()??[];if(e.variadic){for(;s.at(-1)?.equals(e.variadic);)s.pop();if(0===s.length&&0===i.length)for(;r.at(-1)?.equals(e.variadic);)r.pop(),n++;for(;o[0]?.equals(e.variadic);)o.shift(),n++}else 0===s.length&&0===i.length&&r.push(...o.splice(0));if(n!==e.minVariadicLength||e.prefix&&e.prefix.length!==r.length)return t.node("sequence",{...e,prefix:r,defaultables:i,optionals:s,postfix:o,minVariadicLength:n},{prereduced:!0})},defaults:{description:e=>{if(e.isVariadicOnly)return`${e.variadic.nestableExpression}[]`;return`[${e.tuple.map(e=>"defaultables"===e.kind?`${e.node.nestableExpression} = ${Ne(e.default)}`:"optionals"===e.kind?`${e.node.nestableExpression}?`:"variadic"===e.kind?`...${e.node.nestableExpression}[]`:e.node.expression).join(", ")}]`}},intersections:{sequence:(e,t,n)=>{const r=pi({l:e.tuple,r:t.tuple,disjoint:new Lt,result:[],fixedVariants:[],ctx:n}),i=0===r.disjoint.length?[r,...r.fixedVariants]:r.fixedVariants;return 0===i.length?r.disjoint:1===i.length?n.$.node("sequence",di(i[0].result)):n.$.node("union",i.map(e=>({proto:Array,sequence:di(e.result)})))}}});const oi={},ai=e=>{if(!e.defaultables)return[];const t=[];let n="[";const r=e.prefixLength+e.defaultablesLength-1;for(let i=e.prefixLength;i<=r;i++){const[r,s]=e.defaultables[i-e.prefixLength];t.push(ir(i,r,s)),n+=`${i}: ${r.id} = ${ut(s)}, `}return n+="]",oi[n]??=t},ci={implementation:si,Node:class extends Ht{impliedBasis=Fe.intrinsic.Array.internal;tuple=li(this.inner);prefixLength=this.prefix?.length??0;defaultablesLength=this.defaultables?.length??0;optionalsLength=this.optionals?.length??0;postfixLength=this.postfix?.length??0;defaultablesAndOptionals=[];prevariadic=this.tuple.filter(e=>"defaultables"===e.kind||"optionals"===e.kind?(this.defaultablesAndOptionals.push(e.node),!0):"prefix"===e.kind);variadicOrPostfix=c(this.variadic&&[this.variadic],this.postfix);flatRefs=this.addFlatRefs();addFlatRefs(){return Et(this.flatRefs,this.prevariadic.flatMap((e,t)=>a(e.node.flatRefs.map(e=>Bt([`${t}`,...e.path],e.node)),Bt([`${t}`],e.node)))),Et(this.flatRefs,this.variadicOrPostfix.flatMap(e=>a(e.flatRefs.map(e=>Bt([Fe.intrinsic.nonNegativeIntegerString.internal,...e.path],e.node)),Bt([Fe.intrinsic.nonNegativeIntegerString.internal],e)))),this.flatRefs}isVariadicOnly=this.prevariadic.length+this.postfixLength===0;minVariadicLength=this.inner.minVariadicLength??0;minLength=this.prefixLength+this.minVariadicLength+this.postfixLength;minLengthNode=0===this.minLength?null:this.$.node("minLength",this.minLength);maxLength=this.variadic?null:this.tuple.length;maxLengthNode=null===this.maxLength?null:this.$.node("maxLength",this.maxLength);impliedSiblings=this.minLengthNode?this.maxLengthNode?[this.minLengthNode,this.maxLengthNode]:[this.minLengthNode]:this.maxLengthNode?[this.maxLengthNode]:[];defaultValueMorphs=ai(this);defaultValueMorphsReference=this.defaultValueMorphs.length?Te(this.defaultValueMorphs):void 0;elementAtIndex(e,t){if(t<this.prevariadic.length)return this.tuple[t];const n=e.length-this.postfixLength;return t>=n?{kind:"postfix",node:this.postfix[t-n]}:{kind:"variadic",node:this.variadic??b(`Unexpected attempt to access index ${t} on ${this}`)}}traverseAllows=(e,t)=>{for(let n=0;n<e.length;n++)if(!this.elementAtIndex(e,n).node.traverseAllows(e[n],t))return!1;return!0};traverseApply=(e,t)=>{let n=0;for(;n<e.length;n++)jt(n,()=>this.elementAtIndex(e,n).node.traverseApply(e[n],t),t)};get element(){return this.cacheGetter("element",this.$.node("union",this.children))}compile(e){if(this.prefix)for(const[t,n]of this.prefix.entries())e.traverseKey(`${t}`,`data[${t}]`,n);for(const[t,n]of this.defaultablesAndOptionals.entries()){const r=`${t+this.prefixLength}`;e.if(`${r} >= ${e.data}.length`,()=>"Allows"===e.traversalKind?e.return(!0):e.return()),e.traverseKey(r,`data[${r}]`,n)}if(this.variadic&&(this.postfix&&e.const("firstPostfixIndex",`${e.data}.length${this.postfix?`- ${this.postfix.length}`:""}`),e.for("i < "+(this.postfix?"firstPostfixIndex":"data.length"),()=>e.traverseKey("i","data[i]",this.variadic),this.prevariadic.length),this.postfix))for(const[t,n]of this.postfix.entries()){const r=`firstPostfixIndex + ${t}`;e.traverseKey(r,`data[${r}]`,n)}"Allows"===e.traversalKind&&e.return(!0)}_transform(e,t){t.path.push(Fe.intrinsic.nonNegativeIntegerString.internal);const n=super._transform(e,t);return t.path.pop(),n}expression=this.description;reduceJsonSchema(e,t){if(this.prevariadic.length&&(e.prefixItems=this.prevariadic.map(e=>{const n=e.node.toJsonSchemaRecurse(t);if("defaultables"===e.kind){const r="function"==typeof e.default?e.default():e.default;n.default=Fe.intrinsic.jsonData.allows(r)?r:t.fallback.defaultValue({code:"defaultValue",base:n,value:r})}return n})),this.minLength&&(e.minItems=this.minLength),this.variadic){const n=Object.assign(e,{items:this.variadic.toJsonSchemaRecurse(t)});if(this.maxLength&&(n.maxItems=this.maxLength),this.postfix){const r=this.postfix.map(e=>e.toJsonSchemaRecurse(t));e=t.fallback.arrayPostfix({code:"arrayPostfix",base:n,elements:r})}}else e.items=!1,delete e.maxItems;return e}}},li=e=>{const t=[];if(e.prefix)for(const n of e.prefix)t.push({kind:"prefix",node:n});if(e.defaultables)for(const[n,r]of e.defaultables)t.push({kind:"defaultables",node:n,default:r});if(e.optionals)for(const n of e.optionals)t.push({kind:"optionals",node:n});if(e.variadic&&t.push({kind:"variadic",node:e.variadic}),e.postfix)for(const n of e.postfix)t.push({kind:"postfix",node:n});return t},di=e=>e.reduce((e,t)=>("variadic"===t.kind?e.variadic=t.node:"defaultables"===t.kind?e.defaultables=a(e.defaultables,[[t.node,t.default]]):e[t.kind]=a(e[t.kind],t.node),e),{}),ui="A postfix required element cannot follow an optional or defaultable element",hi="A postfix element requires a variadic element",pi=e=>{const[t,...n]=e.l,[r,...i]=e.r;if(!t||!r)return e;const s="postfix"===n.at(-1)?.kind,o="postfix"===i.at(-1)?.kind,a="prefix"===t.kind||"prefix"===r.kind?"prefix":"postfix"===t.kind||"postfix"===r.kind?"postfix":"variadic"===t.kind&&"variadic"===r.kind?"variadic":s||o?"prefix":"defaultables"===t.kind||"defaultables"===r.kind?"defaultables":"optionals";if("prefix"===t.kind&&"variadic"===r.kind&&o){const t=pi({...e,fixedVariants:[],r:i.map(e=>({...e,kind:"prefix"}))});0===t.disjoint.length&&e.fixedVariants.push(t)}else if("prefix"===r.kind&&"variadic"===t.kind&&s){const t=pi({...e,fixedVariants:[],l:n.map(e=>({...e,kind:"prefix"}))});0===t.disjoint.length&&e.fixedVariants.push(t)}const c=Pt(t.node,r.node,e.ctx);if(c instanceof Lt){if("prefix"!==a&&"postfix"!==a)return"optionals"===a||"defaultables"===a?e:pi({...e,fixedVariants:[],l:n.map(e=>({...e,kind:"prefix"})),r:n.map(e=>({...e,kind:"prefix"}))});e.disjoint.push(...c.withPrefixKey("prefix"===a?e.result.length:`-${n.length+1}`,"required")),e.result=[...e.result,{kind:a,node:Fe.intrinsic.never.internal}]}else"defaultables"===a?("defaultables"===t.kind&&"defaultables"===r.kind&&t.default!==r.default&&v(Xn(t.default,r.default)),e.result=[...e.result,{kind:a,node:c,default:"defaultables"===t.kind?t.default:"defaultables"===r.kind?r.default:b(`Unexpected defaultable intersection from ${t.kind} and ${r.kind} elements.`)}]):e.result=[...e.result,{kind:a,node:c}];const l=e.l.length,d=e.r.length;return("variadic"!==t.kind||l>=d&&("variadic"===r.kind||1===d))&&(e.l=n),("variadic"!==r.kind||d>=l&&("variadic"===t.kind||1===l))&&(e.r=i),pi(e)},fi=e=>t=>{if(t.props.length||t.index){const n=t.index?.map(t=>t[e])??[];for(const i of t.props)n.push(i[e]);t.undeclared&&n.push(`+ (undeclared): ${t.undeclared}`);const r=`{ ${n.join(", ")} }`;return t.sequence?`${r} & ${t.sequence.description}`:r}return t.sequence?.description??"{}"},mi=fi("description"),gi=fi("expression"),bi=(e,t,n)=>{const r=e.required?"required":"optional";if(!t.signature.allows(e.key))return null;const i=Ft(e.value,t.value,n);return i instanceof Lt?"optional"===r?n.node("optional",{key:e.key,value:Fe.intrinsic.never.internal}):i.withPrefixKey(e.key,e.kind):null},yi=pt({kind:"structure",hasAssociatedError:!1,normalize:e=>e,applyConfig:(e,t)=>e.undeclared||"ignore"===t.onUndeclaredKey?e:{...e,undeclared:t.onUndeclaredKey},keys:{required:{child:!0,parse:Zt("required"),reduceIo:(e,t,n)=>{t.required=a(t.required,n.map(t=>t[e]))}},optional:{child:!0,parse:Zt("optional"),reduceIo:(e,t,n)=>{if("in"!==e)for(const r of n)t[r.outProp.kind]=a(t[r.outProp.kind],r.outProp.out);else t.optional=n.map(e=>e.in)}},index:{child:!0,parse:Zt("index")},sequence:{child:!0,parse:Zt("sequence")},undeclared:{parse:e=>"ignore"===e?void 0:e,reduceIo:(e,t,n)=>{"delete"===n&&("in"===e?delete t.undeclared:t.undeclared="reject")}}},defaults:{description:mi},intersections:{structure:(e,t,n)=>{const r={...e.inner},i={...t.inner},s=new Lt;if(e.undeclared){const r=e.keyof();for(const e of t.requiredKeys)r.allows(e)||s.add("presence",Fe.intrinsic.never.internal,t.propsByKey[e].value,{path:[e]});i.optional&&(i.optional=i.optional.filter(e=>r.allows(e.key))),i.index&&(i.index=i.index.flatMap(e=>{if(e.signature.extends(r))return e;const t=Ft(r,e.signature,n.$);if(t instanceof Lt)return[];const s=ji(t,e.value,n.$);return s.required&&(i.required=c(i.required,s.required)),s.optional&&(i.optional=c(i.optional,s.optional)),s.index??[]}))}if(t.undeclared){const i=t.keyof();for(const t of e.requiredKeys)i.allows(t)||s.add("presence",e.propsByKey[t].value,Fe.intrinsic.never.internal,{path:[t]});r.optional&&(r.optional=r.optional.filter(e=>i.allows(e.key))),r.index&&(r.index=r.index.flatMap(e=>{if(e.signature.extends(i))return e;const t=Ft(i,e.signature,n.$);if(t instanceof Lt)return[];const s=ji(t,e.value,n.$);return s.required&&(r.required=c(r.required,s.required)),s.optional&&(r.optional=c(r.optional,s.optional)),s.index??[]}))}const o={};(e.undeclared||t.undeclared)&&(o.undeclared="reject"===e.undeclared||"reject"===t.undeclared?"reject":"delete");const a=Yt({kind:"structure",baseInner:o,l:Qt(r),r:Qt(i),roots:[],ctx:n});return a instanceof Lt&&s.push(...a),s.length?s:a}},reduce:(e,t)=>{if(e.index){if(!e.required&&!e.optional)return;let n=!1;const r=e.required??[],i=e.optional??[],s=[...i];for(const o of e.index){for(const e of r){const n=bi(e,o,t);if(n instanceof Lt)return n}for(const[e,r]of i.entries()){const i=bi(r,o,t);if(i instanceof Lt)return i;null!==i&&(s[e]=i,n=!0)}}if(n)return t.node("structure",{...e,optional:s},{prereduced:!0})}}});const xi={},vi=e=>{const t=(e=>{let t="";for(let n=0;n<e.defaultable.length;n++)t+=e.defaultable[n].defaultValueMorphRef;if(e.sequence?.defaultValueMorphsReference&&(t+=e.sequence?.defaultValueMorphsReference),"delete"===e.undeclared){if(t+="delete !(",e.required)for(const n of e.required)t+=n.compiledKey+" | ";if(e.optional)for(const n of e.optional)t+=n.compiledKey+" | ";if(e.index)for(const n of e.index)t+=n.signature.id+" | ";if(e.sequence)if(null===e.sequence.maxLength)t+=rs.nonNegativeIntegerString.id;else for(let n=0;n<e.sequence.tuple.length;n++)t+=n+" | ";t+=")"}return t})(e);if(!t)return;if(xi[t])return xi[t];return xi[t]=(t,n)=>{for(let r=0;r<e.defaultable.length;r++)e.defaultable[r].key in t||e.defaultable[r].defaultValueMorph(t,n);if(e.sequence?.defaultables)for(let r=t.length-e.sequence.prefixLength;r<e.sequence.defaultables.length;r++)e.sequence.defaultValueMorphs[r](t,n);if("delete"===e.undeclared)for(const r in t)e.declaresKey(r)||delete t[r];return t}},$i=(e,t)=>{const n=`(data${t.defaultable.some(e=>2===e.defaultValueMorph.length)||t.sequence?.defaultValueMorphs.some(e=>2===e.length)?", ctx":""})`;return e.block(`${n} => `,e=>{for(let r=0;r<t.defaultable.length;r++){const{serializedKey:i,defaultValueMorphRef:s}=t.defaultable[r];e.if(`!(${i} in data)`,e=>e.line(`${s}${n}`))}return t.sequence?.defaultables&&e.for(`i < ${t.sequence.defaultables.length}`,e=>e.set("data[i]",5),`data.length - ${t.sequence.prefixLength}`),"delete"===t.undeclared&&e.forIn("data",e=>e.if(`!(${t._compileDeclaresKey(e)})`,e=>e.line("delete data[k]"))),e.return("data")})},ki={implementation:yi,Node:class extends Ht{impliedBasis=Fe.intrinsic.object.internal;impliedSiblings=this.children.flatMap(e=>e.impliedSiblings??[]);props=c(this.required,this.optional);propsByKey=_(this.props,(e,t)=>[t.key,t]);propsByKeyReference=Te(this.propsByKey);expression=gi(this);requiredKeys=this.required?.map(e=>e.key)??[];optionalKeys=this.optional?.map(e=>e.key)??[];literalKeys=[...this.requiredKeys,...this.optionalKeys];_keyof;keyof(){if(this._keyof)return this._keyof;let e=this.$.units(this.literalKeys).branches;if(this.index)for(const{signature:t}of this.index)e=e.concat(t.branches);return this._keyof=this.$.node("union",e)}map(e){return this.$.node("structure",this.props.flatMap(e).reduce((e,t)=>{const n=this.propsByKey[t.key];if(Qe(t))return"required"!==t.kind&&"optional"!==t.kind?v(`Map result must have kind "required" or "optional" (was ${t.kind})`):(e[t.kind]=a(e[t.kind],t),e);const r=t.kind??n?.kind??"required",i=_(t,(e,t)=>e in tr.implementation.keys?[e,t]:[]);return e[r]=a(e[r],this.$.node(r,i)),e},{}))}assertHasKeys(e){const t=e.filter(e=>!dr(e,this.keyof()));if(t.length)return v(Ii(this.expression,t))}get(e,...t){let n,r=!1;const i=wi(e);if("string"!=typeof i&&"symbol"!=typeof i||!this.propsByKey[i]||(n=this.propsByKey[i].value,r=this.propsByKey[i].required),this.index)for(const o of this.index)dr(i,o.signature)&&(n=n?.and(o.value)??o.value);if(this.sequence&&dr(i,Fe.intrinsic.nonNegativeIntegerString))if(Ye(i,"root"))this.sequence.variadic&&(n=n?.and(this.sequence.element)??this.sequence.element);else{const e=Number.parseInt(i);if(e<this.sequence.prevariadic.length){const t=this.sequence.prevariadic[e].node;n=n?.and(t)??t,r||=e<this.sequence.prefixLength}else if(this.sequence.variadic){const e=this.$.node("union",this.sequence.variadicOrPostfix);n=n?.and(e)??e}}if(!n)return this.sequence?.variadic&&Ye(i,"root")&&i.extends(Fe.intrinsic.number)?v(Ai(i.expression,this.sequence.expression)):v(Ii(this.expression,[i]));const s=n.get(...t);return r?s:s.or(Fe.intrinsic.undefined)}pick(...e){return this.assertHasKeys(e),this.$.node("structure",this.filterKeys("pick",e))}omit(...e){return this.assertHasKeys(e),this.$.node("structure",this.filterKeys("omit",e))}optionalize(){const{required:e,...t}=this.inner;return this.$.node("structure",{...t,optional:this.props.map(e=>e.hasKind("required")?this.$.node("optional",e.inner):e)})}require(){const{optional:e,...t}=this.inner;return this.$.node("structure",{...t,required:this.props.map(e=>e.hasKind("optional")?{key:e.key,value:e.value}:e)})}merge(e){const t=this.filterKeys("omit",[e.keyof()]);return e.required&&(t.required=a(t.required,e.required)),e.optional&&(t.optional=a(t.optional,e.optional)),e.index&&(t.index=a(t.index,e.index)),e.sequence&&(t.sequence=e.sequence),e.undeclared?t.undeclared=e.undeclared:delete t.undeclared,this.$.node("structure",t)}filterKeys(e,t){const n=Ge(this.inner),r=n=>{const r=t.some(e=>dr(n,e));return"pick"===e?r:!r};return n.required&&(n.required=n.required.filter(e=>r(e.key))),n.optional&&(n.optional=n.optional.filter(e=>r(e.key))),n.index&&(n.index=n.index.filter(e=>r(e.signature))),n}traverseAllows=(e,t)=>this._traverse("Allows",e,t);traverseApply=(e,t)=>this._traverse("Apply",e,t);_traverse=(e,t,n)=>{const r=n?.currentErrorCount??0;for(let i=0;i<this.props.length;i++)if("Allows"===e){if(!this.props[i].traverseAllows(t,n))return!1}else if(this.props[i].traverseApply(t,n),n.failFast&&n.currentErrorCount>r)return!1;if(this.sequence)if("Allows"===e){if(!this.sequence.traverseAllows(t,n))return!1}else if(this.sequence.traverseApply(t,n),n.failFast&&n.currentErrorCount>r)return!1;if(this.index||"reject"===this.undeclared){const i=Object.keys(t);i.push(...Object.getOwnPropertySymbols(t));for(let s=0;s<i.length;s++){const o=i[s];if(this.index)for(const i of this.index)if(i.signature.traverseAllows(o,n))if("Allows"===e){if(!jt(o,()=>i.value.traverseAllows(t[o],n),n))return!1}else if(jt(o,()=>i.value.traverseApply(t[o],n),n),n.failFast&&n.currentErrorCount>r)return!1;if("reject"===this.undeclared&&!this.declaresKey(o)){if("Allows"===e)return!1;if(n.errorFromNodeContext({code:"predicate",expected:"removed",actual:"",relativePath:[o],meta:this.meta}),n.failFast)return!1}}}return this.structuralMorph&&n&&!n.hasError()&&n.queueMorphs([this.structuralMorph]),!0};get defaultable(){return this.cacheGetter("defaultable",this.optional?.filter(e=>e.hasDefault())??[])}declaresKey=e=>e in this.propsByKey||this.index?.some(t=>t.signature.allows(e))||void 0!==this.sequence&&Fe.intrinsic.nonNegativeIntegerString.allows(e);_compileDeclaresKey(e){const t=[];if(this.props.length&&t.push(`k in ${this.propsByKeyReference}`),this.index)for(const n of this.index)t.push(e.invoke(n.signature,{kind:"Allows",arg:"k"}));return this.sequence&&t.push("$ark.intrinsic.nonNegativeIntegerString.allows(k)"),t.join(" || ")||"false"}get structuralMorph(){return this.cacheGetter("structuralMorph",vi(this))}structuralMorphRef=this.structuralMorph&&Te(this.structuralMorph);compile(e){"Apply"===e.traversalKind&&e.initializeErrorCount();for(const t of this.props)e.check(t),"Apply"===e.traversalKind&&e.returnIfFailFast();if(this.sequence&&(e.check(this.sequence),"Apply"===e.traversalKind&&e.returnIfFailFast()),(this.index||"reject"===this.undeclared)&&(e.const("keys","Object.keys(data)"),e.line("keys.push(...Object.getOwnPropertySymbols(data))"),e.for("i < keys.length",()=>this.compileExhaustiveEntry(e))),"Allows"===e.traversalKind)return e.return(!0);this.structuralMorphRef&&e.if("ctx && !ctx.hasError()",()=>(e.line("ctx.queueMorphs(["),$i(e,this),e.line("])")))}compileExhaustiveEntry(e){if(e.const("k","keys[i]"),this.index)for(const t of this.index)e.if(`${e.invoke(t.signature,{arg:"k",kind:"Allows"})}`,()=>e.traverseKey("k","data[k]",t.value));return"reject"===this.undeclared&&e.if(`!(${this._compileDeclaresKey(e)})`,()=>"Allows"===e.traversalKind?e.return(!1):e.line(`ctx.errorFromNodeContext({ code: "predicate", expected: "removed", actual: "", relativePath: [k], meta: ${this.compiledMeta} })`).if("ctx.failFast",()=>e.return())),e}reduceJsonSchema(e,t){switch(e.type){case"object":return this.reduceObjectJsonSchema(e,t);case"array":const n=this.sequence?.reduceJsonSchema(e,t)??e;return this.props.length||this.index?t.fallback.arrayObject({code:"arrayObject",base:n,object:this.reduceObjectJsonSchema({type:"object"},t)}):n;default:return mt.throwInternalOperandError("structure",e)}}reduceObjectJsonSchema(e,t){if(this.props.length){e.properties={};for(const n of this.props){const r=n.value.toJsonSchemaRecurse(t);if("symbol"!=typeof n.key){if(n.hasDefault()){const e="function"==typeof n.default?n.default():n.default;r.default=Fe.intrinsic.jsonData.allows(e)?e:t.fallback.defaultValue({code:"defaultValue",base:r,value:e})}e.properties[n.key]=r}else t.fallback.symbolKey({code:"symbolKey",base:e,key:n.key,value:r,optional:n.optional})}this.requiredKeys.length&&e.properties&&(e.required=this.requiredKeys.filter(t=>"string"==typeof t&&t in e.properties))}if(this.index)for(const n of this.index){const r=n.value.toJsonSchemaRecurse(t);if(n.signature.equals(Fe.intrinsic.string))e.additionalProperties=r;else for(const i of n.signature.branches){if(!i.extends(Fe.intrinsic.string)){e=t.fallback.symbolKey({code:"symbolKey",base:e,key:null,value:r,optional:!1});continue}let n={type:"string"};if(i.hasKind("morph")&&(n=t.fallback.morph({code:"morph",base:i.in.toJsonSchemaRecurse(t),out:i.out.toJsonSchemaRecurse(t)})),!i.hasKind("intersection"))return b(`Unexpected index branch kind ${i.kind}.`);const{pattern:s}=i.inner;if(s){const i=Object.assign(n,{pattern:s[0].rule});for(let e=1;e<s.length;e++)n=t.fallback.patternIntersection({code:"patternIntersection",base:i,pattern:s[e].rule});e.patternProperties??={},e.patternProperties[i.pattern]=r}}}return this.undeclared&&!e.additionalProperties&&(e.additionalProperties=!1),e}}},wi=e=>(Ye(e,"root")&&e.hasKind("unit")&&(e=e.unit),"number"==typeof e&&(e=`${e}`),e),Ai=(e,t)=>`${e} is not allowed as an array index on ${t}. Use the 'nonNegativeIntegerString' keyword instead.`,ji=(e,t,n)=>{const[r,i]=((e,t)=>{const n=[[],[]];for(const r of e)t(r)?n[0].push(r):n[1].push(r);return n})(e.branches,e=>e.hasKind("unit"));if(!r.length)return{index:n.node("index",{signature:e,value:t})};const s={};for(const o of r){const e=n.node("required",{key:o.unit,value:t});s[e.kind]=a(s[e.kind],e)}return i.length&&(s.index=n.node("index",{signature:i,value:t})),s},Ni=e=>Ye(e,"root")?e.expression:Ne(e),Ii=(e,t)=>`Key${1===t.length?"":"s"} ${t.map(Ni).join(", ")} ${1===t.length?"does":"do"} not exist on ${e}`,Oi={...Ln,alias:yr.implementation,domain:$r.implementation,unit:Yr.implementation,proto:Cr.implementation,union:zr.implementation,morph:Ir.implementation,intersection:wr.implementation,divisor:cn.implementation,pattern:zn.implementation,predicate:on.implementation,required:ii.implementation,optional:tr.implementation,index:ei.implementation,sequence:ci.implementation,structure:ki.implementation};Fe.defaultConfig=(e=>{const t=Object.keys(e).sort(),n={};for(let r=0;r<t.length;r++)n[t[r]]=e[t[r]];return n})(Object.assign(_(Oi,(e,t)=>[e,t.defaults]),{jitless:H(),clone:e=>P(e,new Map),onUndeclaredKey:"ignore",exactOptionalPropertyTypes:!0,numberAllowsNaN:!1,dateAllowsInvalid:!1,onFail:null,keywords:{},toJsonSchema:mt.defaultConfig})),Fe.resolvedConfig=gt(Fe.defaultConfig,Fe.config);const Si={...Dn,alias:yr.Node,domain:$r.Node,unit:Yr.Node,proto:Cr.Node,union:zr.Node,morph:Ir.Node,intersection:wr.Node,divisor:cn.Node,pattern:zn.Node,predicate:on.Node,required:ii.Node,optional:tr.Node,index:ei.Node,sequence:ci.Node,structure:ki.Node};class Ci extends j{get[Ze](){return"module"}}const qi=(e,t)=>new Ci(_(e,(e,n)=>[e,Ye(n,"module")?qi(n,t):t.bindReference(n)])),Bi=e=>`#${e} duplicates public alias ${e}`,Ri={};let Ei;Fe.ambient??={};const Ki="function $",Li=(e,t)=>{const n=t.write(Ki,4),r=t.compile()();for(const i of e)i.precompilation||(i.traverseAllows=r[`${i.id}Allows`].bind(r),i.isRoot()&&!i.allowsRequiresContext&&(i.allows=i.traverseAllows),i.traverseApply=r[`${i.id}Apply`].bind(r),r[`${i.id}Optimistic`]&&(i.traverseOptimistic=r[`${i.id}Optimistic`].bind(r)),i.precompilation=n)},Di=e=>(new Pe).return(e.reduce((e,t)=>{const n=new He({kind:"Allows"}).indent();t.compile(n);const r=n.write(`${t.id}Allows`),i=new He({kind:"Apply"}).indent();t.compile(i);const s=`${e}${r},\n${i.write(`${t.id}Apply`)},\n`;if(!t.hasKind("union"))return s;const o=new He({kind:"Allows",optimistic:!0}).indent();t.compile(o);return`${s}${o.write(`${t.id}Optimistic`)},\n`},"{\n")+"}");class Mi{config;resolvedConfig;name;get[Ze](){return"scope"}referencesById={};references=[];resolutions={};exportedNames=[];aliases={};resolved=!1;nodesByHash={};intrinsic;constructor(e,t){this.config=gt(Fe.config,t),this.resolvedConfig=gt(Fe.resolvedConfig,t),this.name=this.resolvedConfig.name??`anonymousScope${Object.keys(Ri).length}`,this.name in Ri&&v(`A Scope already named ${this.name} already exists`),Ri[this.name]=this;const n=Object.entries(e).map(e=>this.preparseOwnAliasEntry(...e));for(const[r,i]of n){let e=r;if("#"===r[0]?(e=r.slice(1),e in this.aliases&&v(Bi(e)),this.aliases[e]=i):(e in this.aliases&&v(Bi(r)),this.aliases[e]=i,this.exportedNames.push(e)),!Ye(i,"module")&&!Ye(i,"generic")&&!J(i)){const t=this.preparseOwnDefinitionFormat(i,{alias:e});this.resolutions[e]=Ye(t,"root")?this.bindReference(t):this.createParseContext(t).id}}Ei??=this.node("union",{branches:["string","number","object","bigint","symbol",{unit:!0},{unit:!1},{unit:void 0},{unit:null}]},{prereduced:!0}),this.nodesByHash[Ei.hash]=this.node("intersection",{},{prereduced:!0}),this.intrinsic=Fe.intrinsic?_(Fe.intrinsic,(e,t)=>e.startsWith("json")?[]:[e,this.bindReference(t)]):{}}cacheGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}get internal(){return this}_json;get json(){return this._json||this.export(),this._json}defineSchema(e){return e}generic=(...e)=>{const t=this;return(n,r)=>new nn(e,r?new tn(n):n,t,t,r??null)};units=(e,t)=>{const n=[];for(const i of e)n.includes(i)||n.push(i);const r=n.map(e=>this.node("unit",{unit:e},t));return this.node("union",r,{...t,prereduced:!0})};lazyResolutions=[];lazilyResolve(e,t){const n=this.node("alias",{reference:t??"synthetic",resolve:e},{prereduced:!0});return this.resolved||this.lazyResolutions.push(n),n}schema=(e,t)=>this.finalize(this.parseSchema(e,t));parseSchema=(e,t)=>this.node(Un(e),e,t);preparseNode(e,t,n){let r="string"==typeof e?e:Un(t,e);if(Qe(t)&&t.kind===r)return t;if("alias"!==r||n?.prereduced){if("union"===r&&h(t,"object")){const e=(e=>z(e)?e:"branches"in e&&z(e.branches)?e.branches:void 0)(t);1===e?.length&&(t=e[0],r=Un(t))}}else{const{reference:e}=yr.implementation.normalize(t,this);if(e.startsWith("$")){const n=this.resolveRoot(e.slice(1));t=n,r=n.kind}}if(Qe(t)&&t.kind===r)return t;const i=Oi[r],s=i.normalize?.(t,this)??t;return Qe(s)?s.kind===r?s:(o=r,a=s.kind,v(`Node of kind ${a} is not valid as a ${o} definition`)):{...n,$:this,kind:r,def:s,prefix:n.alias??r};var o,a}bindReference(e){let t;return t=Qe(e)?e.$===this?e:new e.constructor(e.attachments,this):e.$===this?e:new nn(e.params,e.bodyDef,e.$,this,e.hkt),this.resolved||Object.assign(this.referencesById,t.referencesById),t}resolveRoot(e){return this.maybeResolveRoot(e)??v(Vi(e))}maybeResolveRoot(e){const t=this.maybeResolve(e);if(!Ye(t,"generic"))return t}maybeResolveSubalias(e){return Ti(this.aliases,e)??Ti(this.ambient,e)}get ambient(){return Fe.ambient}maybeResolve(e){const t=this.resolutions[e];if(t){if("string"!=typeof t)return this.bindReference(t);const n=Jn[t];if(Ye(n,"root"))return this.resolutions[e]=n;if(Ye(n,"context")){if("resolving"===n.phase)return this.node("alias",{reference:`$${e}`},{prereduced:!0});if("resolved"===n.phase)return b(`Unexpected resolved context for was uncached by its scope: ${Ne(n)}`);n.phase="resolving";const t=this.bindReference(this.parseOwnDefinitionFormat(n.def,n));return n.phase="resolved",Jn[t.id]=t,Jn[n.id]=t,this.resolutions[e]=t}return b(`Unexpected nodesById entry for ${t}: ${Ne(n)}`)}let n=this.aliases[e]??this.ambient?.[e];return n?(n=this.normalizeRootScopeValue(n),Ye(n,"generic")?this.resolutions[e]=this.bindReference(n):Ye(n,"module")?(n.root||v(Hi(e)),this.resolutions[e]=this.bindReference(n.root)):this.resolutions[e]=this.parse(n,{alias:e})):this.maybeResolveSubalias(e)}createParseContext(e){const t=e.id??Vn(e.prefix);return Jn[t]=Object.assign(e,{[Ze]:"context",$:this,id:t,phase:"unresolved"})}traversal(e){return new At(e,this.resolvedConfig)}import(...e){return new Ci(_(this.export(...e),(e,t)=>[`#${e}`,t]))}precompilation;_exportedResolutions;_exports;export(...e){if(!this._exports){this._exports={};for(const e of this.exportedNames){const t=this.aliases[e];this._exports[e]=Ye(t,"module")?qi(t,this):Ui(this.maybeResolve(e))}for(const e of this.lazyResolutions)e.resolution;if(this._exportedResolutions=Ji(this,this._exports),this._json=Fi(this._exportedResolutions),Object.assign(this.resolutions,this._exportedResolutions),this.references=Object.values(this.referencesById),!this.resolvedConfig.jitless){const e=Di(this.references);this.precompilation=e.write(Ki,4),Li(this.references,e)}this.resolved=!0}const t=e.length?e:this.exportedNames;return new Ci(_(t,(e,t)=>[t,this._exports[t]]))}resolve(e){return this.export()[e]}node=(e,t,n={})=>{const r=this.preparseNode(e,t,n);if(Qe(r))return this.bindReference(r);const i=this.createParseContext(r),s=Wn(i),o=this.bindReference(s);return Jn[i.id]=o};parse=(e,t={})=>this.finalize(this.parseDefinition(e,t));parseDefinition(e,t={}){if(Ye(e,"root"))return this.bindReference(e);const n=this.preparseOwnDefinitionFormat(e,t);if(Ye(n,"root"))return this.bindReference(n);const r=this.createParseContext(n);Jn[r.id]=r;let i=this.bindReference(this.parseOwnDefinitionFormat(e,r));return i.isCyclic&&(i=((e,t)=>e.id===t?e:(Qe(Jn[t])&&b(`Unexpected attempt to overwrite node id ${t}`),Hn({id:t,kind:e.kind,inner:e.inner,meta:e.meta,$:e.$,ignoreCache:!0})))(i,r.id)),Jn[r.id]=i,i}finalize(e){var t;return Ui(e),e.precompilation||this.resolvedConfig.jitless||(t=e.references,Li(t,Di(t))),e}}class zi extends Mi{parseOwnDefinitionFormat(e,t){return Wn(t)}preparseOwnDefinitionFormat(e,t){return this.preparseNode(Un(e),e,t)}preparseOwnAliasEntry(e,t){return[e,t]}normalizeRootScopeValue(e){return e}}const Ui=e=>{const t=e.references.filter(e=>e.hasKind("alias"));for(const n of t){Object.assign(n.referencesById,n.resolution.referencesById);for(const t of e.references)n.id in t.referencesById&&Object.assign(t.referencesById,n.referencesById)}return e},Fi=e=>_(e,(e,t)=>[e,Ye(t,"root")||Ye(t,"generic")?t.json:Ye(t,"module")?Fi(t):b(`Unexpected resolution ${Ne(t)}`)]),Ti=(e,t)=>{const n=t.indexOf(".");if(-1===n)return;const r=t.slice(0,n),i=e[r];if(void 0===i)return;if(!Ye(i,"module"))return v(Wi(r));const s=t.slice(n+1),o=i[s];return void 0===o?Ti(i,s):Ye(o,"root")||Ye(o,"generic")?o:Ye(o,"module")?o.root??v(Hi(t)):void b(`Unexpected resolution for alias '${t}': ${Ne(o)}`)},Pi=(e,t)=>new zi(e,t),_i=new zi({}),Ji=(e,t)=>{const n={};for(const r in t){const i=t[r];if(Ye(i,"module")){const t=Ji(e,i),s=_(t,(e,t)=>[`${r}.${e}`,t]);Object.assign(n,s)}else Ye(i,"root")||Ye(i,"generic")?n[r]=i:b(`Unexpected scope resolution ${Ne(i)}`)}return n},Vi=e=>`'${e}' is unresolvable`,Wi=e=>`'${e}' must reference a module to be accessed using dot syntax`,Hi=e=>`Reference to submodule '${e}' must specify an alias`;_i.export();const Gi=_i.schema,Zi=_i.node,Yi=(_i.defineSchema,_i.generic),Qi="^(?:0|[1-9]\\d*)$",Xi=new RegExp(Qi),es=(Te(Xi),Pi({bigint:"bigint",boolean:[{unit:!1},{unit:!0}],false:{unit:!1},never:[],null:{unit:null},number:"number",object:"object",string:"string",symbol:"symbol",true:{unit:!0},unknown:{},undefined:{unit:void 0},Array:Array,Date:Date},{prereducedAliases:!0}).export());Fe.intrinsic={...es};const ts=Pi({integer:{domain:"number",divisor:1},lengthBoundable:["string",Array],key:["string","symbol"],nonNegativeIntegerString:{domain:"string",pattern:Qi}},{prereducedAliases:!0}).export();Object.assign(Fe.intrinsic,ts);const ns=Pi({jsonPrimitive:["string","number",{unit:!0},{unit:!1},{unit:null}],jsonObject:{domain:"object",index:{signature:"string",value:"$jsonData"}},jsonData:["$jsonPrimitive","$jsonObject"]},{prereducedAliases:!0}).export(),rs={...es,...ts,...ns,emptyStructure:Zi("structure",{},{prereduced:!0})};Fe.intrinsic={...rs};const is=e=>"string"==typeof e&&"d"===e[0]&&("'"===e[1]||'"'===e[1])&&e.at(-1)===e[1],ss=e=>"Invalid Date"!==e.toString(),os=e=>`'${e}' could not be parsed by the Date constructor`,as=(e,t)=>{const n=new Date(e);if(ss(n))return n;const r=be(e,"number",i);var i;if(void 0!==r){const e=new Date(r);if(ss(e))return e}return t?v(!0===t?os(e):t):void 0},cs=(e,t)=>{const n=e.scanner.shiftUntil(hs[us[t]]);if(""===e.scanner.lookahead)return e.error(fs(n,t));if(e.scanner.shift(),"/"===t){try{new RegExp(n)}catch(s){v(String(s))}e.root=e.ctx.$.node("intersection",{domain:"string",pattern:n},{prereduced:!0})}else if(w(t,ls))e.root=e.ctx.$.node("unit",{unit:n});else{const t=(r=n,i=os(n),as(r,i));e.root=e.ctx.$.node("unit",{meta:n,unit:t})}var r,i},ls={"'":1,'"':1},ds={"/":1,"'":1,'"':1},us={"d'":"'",'d"':'"',"'":"'",'"':'"',"/":"/"},hs={"'":e=>"'"===e.lookahead,'"':e=>'"'===e.lookahead,"/":e=>"/"===e.lookahead},ps={'"':"double-quote","'":"single-quote","/":"forward slash"},fs=(e,t)=>`${t}${e} requires a closing ${ps[us[t]]}`,ms="Optional definitions like 'string?' are only valid as properties in an object or tuple",gs="Defaultable definitions like 'number = 0' are only valid as properties in an object or tuple",bs={">":!0,">=":!0},ys={"<":!0,"<=":!0},xs={"<":">",">":"<","<=":">=",">=":"<=","==":"=="},vs=e=>`Missing ${e}`,$s=e=>`Left-bounded expressions must specify their limits using < or <= (was ${e})`,ks=(e,t,n,r)=>{const i=n.parseUntilFinalizer();return r.push(i.root),">"===i.finalizer?r.length!==t.params.length?n.error(ws(e,t.names,r.map(e=>e.expression))):r:","===i.finalizer?ks(e,t,n,r):i.error(vs(">"))},ws=(e,t,n)=>`${e}<${t.join(", ")}> requires exactly ${t.length} args (got ${n.length}${0===n.length?"":`: ${n.join(", ")}`})`,As=e=>{const t=e.scanner.shiftUntilNextTerminator();"keyof"===t?e.addPrefix("keyof"):e.root=Ns(e,t)},js=(e,t,n)=>{n.scanner.shiftUntilNonWhitespace();if("<"!==n.scanner.shift())return n.error(ws(e,t.names,[]));const r=((e,t,n)=>ks(e,t,n,[]))(e,t,n);return t(...r)},Ns=(e,t)=>Is(e,t)??Os(e,t)??e.error(""===t?"#"===e.scanner.lookahead?`Private type references should not include '#'. Use '${e.shiftedByOne().scanner.shiftUntilNextTerminator()}' instead.`:Ss(e):Vi(t)),Is=(e,t)=>{if(e.ctx.args?.[t]){const n=e.ctx.args[t];return"string"!=typeof n?n:e.ctx.$.node("alias",{reference:n},{prereduced:!0})}const n=e.ctx.$.maybeResolve(t);return Ye(n,"root")?n:void 0!==n?Ye(n,"generic")?js(t,n,e):v(`Unexpected resolution ${Ne(n)}`):void 0},Os=(e,t)=>{const n=((e,t)=>be(e,"number",{...t,strict:!0}))(t);if(void 0!==n)return e.ctx.$.node("unit",{unit:n});const r=(e=>{if("n"!==e[e.length-1])return;const t=e.slice(0,-1);let n;try{n=BigInt(t)}catch{return}return de.test(t)?n:he.test(t)?v(me(e,"bigint")):void 0})(t);return void 0!==r?e.ctx.$.node("unit",{unit:r}):void 0},Ss=e=>{const t=e.previousOperator();return t?Cs(t,e.scanner.unscanned):qs(e.scanner.unscanned)},Cs=(e,t="")=>`Token '${e}' requires a right operand${t?` before '${t}'`:""}`,qs=e=>"Expected an expression"+(e?` before '${e}'`:""),Bs=e=>""===e.scanner.lookahead?e.error(Ss(e)):"("===e.scanner.lookahead?e.shiftedByOne().reduceGroupOpen():e.scanner.lookaheadIsIn(ds)?cs(e,e.scanner.shift()):e.scanner.lookaheadIsIn(te)?Bs(e.shiftedByOne()):"d"===e.scanner.lookahead&&e.scanner.nextLookahead in ls?cs(e,`${e.scanner.shift()}${e.scanner.shift()}`):As(e);class Rs extends De{shiftUntilNextTerminator(){return this.shiftUntilNonWhitespace(),this.shiftUntil(()=>this.lookahead in Rs.terminatingChars)}static terminatingChars={"<":1,">":1,"=":1,"|":1,"&":1,")":1,"[":1,"%":1,",":1,":":1,"?":1,"#":1,...te};static finalizingLookaheads={">":1,",":1,"":1,"=":1,"?":1};static lookaheadIsFinalizing=(e,t)=>">"===e?"="===t[0]?"="===t[1]:""===t.trimStart()||w(t.trimStart()[0],Rs.terminatingChars):"="===e?"="!==t[0]:","===e||"?"===e}const Es={"<":1,">":1,"=":1},Ks=(e,t)=>e.scanner.lookaheadIs("=")?`${t}${e.scanner.shift()}`:t,Ls=(e,t,n,r)=>n.extends(Fe.intrinsic.number)?"number"!=typeof t?v(Ms(e,t,r)):"=="===e?["min","max"]:">"===e[0]?["min"]:["max"]:n.extends(Fe.intrinsic.lengthBoundable)?"number"!=typeof t?v(Ms(e,t,r)):"=="===e?["exactLength"]:">"===e[0]?["minLength"]:["maxLength"]:n.extends(Fe.intrinsic.Date)?"=="===e?["after","before"]:">"===e[0]?["after"]:["before"]:v((e=>`Bounded expression ${e} must be exactly one of number, string, Array, or Date`)(n.expression)),Ds=(e,t)=>{const n=e.unsetRoot(),r=e.scanner.location;e.parseOperand();const i=e.unsetRoot(),s=e.scanner.sliceChars(r,e.scanner.location);if(e.root=n,!i.hasKind("unit")||"number"!=typeof i.unit&&!(i.unit instanceof Date))return e.error(Ms(t,s,"right"));const o=i.unit,a=1===t.length,c=Ls(t,"number"==typeof o?o:s,n,"right");for(const h of c)e.constrainRoot(h,"=="===t?{rule:o}:{rule:o,exclusive:a});if(!e.branches.leftBound)return;if(!w(t,ys))return e.error($s(t));const l=Ls(e.branches.leftBound.comparator,e.branches.leftBound.limit,n,"left");var d,u;e.constrainRoot(l[0],(d=e.branches.leftBound,{rule:is(d.limit)?(u=d.limit,u.slice(2,-1)):d.limit,exclusive:1===d.comparator.length})),e.branches.leftBound=null},Ms=(e,t,n)=>`Comparator ${"left"===n?xs[e]:e} must be ${"left"===n?"preceded":"followed"} by a corresponding literal (was ${t})`,zs=e=>{const t=e.scanner.shiftUntilNextTerminator(),n=(r=t,i={errorOnFail:Us(t)},be(r,"integer",i));var r,i;0===n&&e.error(Us(0)),e.root=e.root.constrain("divisor",n)},Us=e=>`% operator must be followed by a non-zero integer literal (was ${e})`,Fs=e=>{const t=e.scanner.shift();return""===t?e.finalize(""):"["===t?"]"===e.scanner.shift()?e.setRoot(e.root.array()):e.error(Ps):"|"===t?">"===e.scanner.lookahead?e.shiftedByOne().pushRootToBranch("|>"):e.pushRootToBranch(t):"&"===t?e.pushRootToBranch(t):")"===t?e.finalizeGroup():Rs.lookaheadIsFinalizing(t,e.scanner.unscanned)?e.finalize(t):w(t,Es)?((e,t)=>{const n=Ks(e,t);if(e.root.hasKind("unit")){if("number"==typeof e.root.unit)return e.reduceLeftBound(e.root.unit,n),void e.unsetRoot();if(e.root.unit instanceof Date){const t=`d'${e.root.description??e.root.unit.toISOString()}'`;return e.unsetRoot(),void e.reduceLeftBound(t,n)}}return Ds(e,n)})(e,t):"%"===t?zs(e):"#"===t?(e=>{e.scanner.shiftUntilNonWhitespace();const t=e.scanner.shiftUntilNextTerminator();e.root=e.root.brand(t)})(e):t in te?Fs(e):e.error(Ts(t))},Ts=(e,t="")=>`'${e}' is not allowed here${t&&` (should be ${t})`}`,Ps="Missing expected ']'",_s=e=>`Default value '${e}' must a literal value`,Js=(e,t)=>{const n=t.$.maybeResolveRoot(e);if(n)return n;if(e.endsWith("[]")){const n=t.$.maybeResolveRoot(e.slice(0,-2));if(n)return n.array()}const r=new Gs(new Rs(e),t),i=Vs(r);return">"===r.finalizer&&v(Ts(">")),i},Vs=e=>{e.parseOperand();let t=Ws(e).root;return t?("="===e.finalizer?t=(e=>{const t=e.unsetRoot();e.parseOperand();const n=e.unsetRoot();return n.hasKind("unit")?[t,"=",n.unit instanceof Date?()=>new Date(n.unit):n.unit]:e.error(_s(n.expression))})(e):"?"===e.finalizer&&(t=[t,"?"]),e.scanner.shiftUntilNonWhitespace(),e.scanner.lookahead&&v(Ts(e.scanner.lookahead)),t):b(`Root was unexpectedly unset after parsing string '${e.scanner.scanned}'`)},Ws=e=>{for(;void 0===e.finalizer;)Hs(e);return e},Hs=e=>e.hasRoot()?e.parseOperator():e.parseOperand();class Gs{root;branches={prefixes:[],leftBound:null,intersection:null,union:null,pipe:null};finalizer;groups=[];scanner;ctx;constructor(e,t){this.scanner=e,this.ctx=t}error(e){return v(e)}hasRoot(){return void 0!==this.root}setRoot(e){this.root=e}unsetRoot(){const e=this.root;return this.root=void 0,e}constrainRoot(...e){this.root=this.root.constrain(e[0],e[1])}finalize(e){if(this.groups.length)return this.error(vs(")"));this.finalizeBranches(),this.finalizer=e}reduceLeftBound(e,t){const n=xs[t];return w(n,bs)?this.branches.leftBound?this.error(((e,t,n,r)=>`An expression may have at most one left bound (parsed ${e}${xs[t]}, ${n}${xs[r]})`)(this.branches.leftBound.limit,this.branches.leftBound.comparator,e,n)):void(this.branches.leftBound={comparator:n,limit:e}):this.error($s(t))}finalizeBranches(){return this.assertRangeUnset(),this.branches.pipe?(this.pushRootToBranch("|>"),void(this.root=this.branches.pipe)):this.branches.union?(this.pushRootToBranch("|"),void(this.root=this.branches.union)):this.branches.intersection?(this.pushRootToBranch("&"),void(this.root=this.branches.intersection)):void this.applyPrefixes()}finalizeGroup(){this.finalizeBranches();const e=this.groups.pop();if(!e)return this.error("Unmatched )"+(""===(t=this.scanner.unscanned)?"":` before ${t}`));var t;this.branches=e}addPrefix(e){this.branches.prefixes.push(e)}applyPrefixes(){for(;this.branches.prefixes.length;){const e=this.branches.prefixes.pop();this.root="keyof"===e?this.root.keyof():b(`Unexpected prefix '${e}'`)}}pushRootToBranch(e){this.assertRangeUnset(),this.applyPrefixes();const t=this.root;this.root=void 0,this.branches.intersection=this.branches.intersection?.rawAnd(t)??t,"&"!==e&&(this.branches.union=this.branches.union?.rawOr(this.branches.intersection)??this.branches.intersection,this.branches.intersection=null,"|"!==e&&(this.branches.pipe=this.branches.pipe?.rawPipeOnce(this.branches.union)??this.branches.union,this.branches.union=null))}parseUntilFinalizer(){return Ws(new Gs(this.scanner,this.ctx))}parseOperator(){return Fs(this)}parseOperand(){return Bs(this)}assertRangeUnset(){if(this.branches.leftBound)return this.error((e=this.branches.leftBound.limit,`Left bounds are only valid when paired with right bounds (try ...${this.branches.leftBound.comparator}${e})`));var e}reduceGroupOpen(){this.groups.push(this.branches),this.branches={prefixes:[],leftBound:null,union:null,intersection:null,pipe:null}}previousOperator(){return this.branches.leftBound?.comparator??this.branches.prefixes.at(-1)??(this.branches.intersection?"&":this.branches.union?"|":this.branches.pipe?"|>":void 0)}shiftedByOne(){return this.scanner.shift(),this}}const Zs=(e,t,n)=>{e.shiftUntilNonWhitespace();const r=e.shiftUntilNextTerminator();return""===r?""===e.lookahead&&t.length?t:v("An empty string is not a valid generic parameter name"):(e.shiftUntilNonWhitespace(),Qs(e,r,t,n))},Ys="extends ",Qs=(e,t,n,r)=>{if(e.shiftUntilNonWhitespace(),!e.unscanned.startsWith(Ys))return","===e.lookahead&&e.shift(),n.push(t),Zs(e,n,r);e.jumpForward(8);const i=Ws(new Gs(e,r));return n.push([t,i.root]),Zs(e,n,r)};class Xs extends W{$;constructor(e){super((...t)=>new eo(e)(...t),{bind:e}),this.$=e}in(e){return new eo(this.$,void 0===e?void 0:this.$.parse(e))}at(e,t){return new eo(this.$).at(e,t)}case(e,t){return new eo(this.$).case(e,t)}}class eo extends W{$;in;key;branches=[];constructor(e,t){super(e=>this.caseEntries(Object.entries(e).map(([e,t])=>"default"===e?[e,t]:[this.$.parse(e),t]))),this.$=e,this.in=t}at(e,t){return this.key&&v(ro),this.branches.length&&v(no),this.key=e,t?this.match(t):this}case(e,t){return this.caseEntry(this.$.parse(e),t)}caseEntry(e,t){const n=(this.key?this.$.parse({[this.key]:e}):e).pipe(t);return this.branches.push(n),this}match(e){return this(e)}strings(e){return this.caseEntries(Object.entries(e).map(([e,t])=>"default"===e?[e,t]:[this.$.node("unit",{unit:e}),t]))}caseEntries(e){for(let t=0;t<e.length;t++){const[n,r]=e[t];if("default"===n)return t!==e.length-1&&v("default may only be specified as the last key of a switch definition"),this.default(r);if("function"!=typeof r)return v(`Value for case "${n}" must be a function (was ${p(r)})`);this.caseEntry(n,r)}return this}default(e){"function"==typeof e&&this.case(rs.unknown,e);const t={branches:this.branches,ordered:!0};"never"!==e&&"assert"!==e||(t.meta={onFail:to});const n=this.$.node("union",t);if(!this.in)return this.$.finalize(n);let r=this.in.pipe(n);return"never"!==e&&"assert"!==e||(r=r.configureReferences({onFail:to},"self")),this.$.finalize(r)}}const to=e=>e.throw(),no="A key matcher must be specified before the first case i.e. match.at('foo') or match.in<object>().at('bar')",ro="At most one key matcher may be specified per expression",io=(e,t)=>{if(z(e)){if("="===e[1])return[t.$.parseOwnDefinitionFormat(e[0],t),"=",e[2]];if("?"===e[1])return[t.$.parseOwnDefinitionFormat(e[0],t),"?"]}return So(e,t)},so=(e,t,n,r)=>{e[t]=a(e[t],r.$.node(t,n))},oo=e=>`Value of '+' key must be 'reject', 'delete', or 'ignore' (was ${Ne(e)})`,ao="Spread operator may only be used as the first key in an object",co=e=>"symbol"==typeof e?{kind:"required",normalized:e}:"?"===e.at(-1)?"\\"===e.at(-2)?{kind:"required",normalized:`${e.slice(0,-2)}?`}:{kind:"optional",normalized:e.slice(0,-1)}:"["===e[0]&&"]"===e.at(-1)?{kind:"index",normalized:e.slice(1,-1)}:"\\"===e[0]&&"["===e[1]&&"]"===e.at(-1)?{kind:"required",normalized:e.slice(1)}:"..."===e?{kind:"spread"}:"+"===e?{kind:"undeclared"}:{kind:"required",normalized:"\\..."===e?"...":"\\+"===e?"+":e},lo=e=>`Spread operand must resolve to an object literal type (was ${e})`,uo=(e,t)=>{if(void 0===e[2])return v(Cs(e[1],""));const n=t.$.parseOwnDefinitionFormat(e[0],t),r=t.$.parseOwnDefinitionFormat(e[2],t);if("|"===e[1])return t.$.node("union",{branches:[n,r]});const i="&"===e[1]?Ft(n,r,t.$):Tt(n,r,t.$);return i instanceof Lt?i.throw():i},ho=(e,t)=>`${":"===e?"Narrow":"Morph"} expression requires a function following '${e}' (was ${typeof t})`,po={...{"[]":(e,t)=>t.$.parseOwnDefinitionFormat(e[0],t).array(),"?":()=>v(ms)},...{"|":uo,"&":uo,":":(e,t)=>"function"!=typeof e[2]?v(ho(":",e[2])):t.$.parseOwnDefinitionFormat(e[0],t).constrain("predicate",e[2]),"=>":(e,t)=>"function"!=typeof e[2]?v(ho("=>",e[2])):t.$.parseOwnDefinitionFormat(e[0],t).pipe(e[2]),"|>":uo,"@":(e,t)=>t.$.parseOwnDefinitionFormat(e[0],t).configureReferences(e[2],"shallow"),"=":()=>v(gs)}},fo=e=>void 0!==po[e[1]],mo={keyof:(e,t)=>t.$.parseOwnDefinitionFormat(e[1],t).keyof(),instanceof:(e,t)=>{if("function"!=typeof e[1])return v(bo(M(e[1])));const n=e.slice(1).map(e=>"function"==typeof e?t.$.node("proto",{proto:e}):v(bo(M(e))));return 1===n.length?n[0]:t.$.node("union",{branches:n})},"===":(e,t)=>t.$.units(e.slice(1))},go=e=>void 0!==mo[e[0]],bo=e=>`Expected a constructor following 'instanceof' operator (was ${e})`,yo=(e,t)=>e.defaultables||e.optionals?v(e.variadic?ui:jo):(e.variadic?e.postfix=a(e.postfix,t):e.prefix=a(e.prefix,t),e),xo=(e,t)=>e.variadic?v(No):(e.optionals=a(e.optionals,t),e),vo=(e,t,n)=>e.variadic?v(No):e.optionals?v(Io):(e.defaultables=a(e.defaultables,[[t,n]]),e),$o=(e,t)=>(e.postfix&&v(Ao),e.variadic?e.variadic.equals(t)||v(Ao):e.variadic=t.internal,e),ko=(e,t)=>{const n=t.select({method:"find",kind:"sequence"});if(!n)return $o(e,Fe.intrinsic.unknown);if(n.prefix)for(const r of n.prefix)yo(e,r);if(n.optionals)for(const r of n.optionals)xo(e,r);if(n.variadic&&$o(e,n.variadic),n.postfix)for(const r of n.postfix)yo(e,r);return e},wo=e=>`Spread element must be an array (was ${e})`,Ao="A tuple may have at most one variadic element",jo="A required element may not follow an optional element",No="An optional element may not follow a variadic element",Io="A defaultable element may not follow an optional element without a default",Oo={},So=(e,t)=>{if("string"==typeof e){if(t.args&&Object.keys(t.args).some(t=>e.includes(t)))return Js(e,t);const n=Oo[t.$.name]??={};return n[e]??=Js(e,t)}return h(e,"object")?Co(e,t):v(Bo(p(e)))},Co=(e,t)=>{const n=D(e);switch(n){case void 0:return Ye(e,"root")?e:((e,t)=>{let n;const r={},i=C(e);for(const[o,c]of i){const e=co(o);if("spread"===e.kind){if(!S(r))return v(ao);const e=t.$.parseOwnDefinitionFormat(c,t);if(e.equals(rs.object))continue;if(!e.hasKind("intersection")||!e.basis?.equals(rs.object))return v(lo(e.expression));n=e.structure;continue}if("undeclared"===e.kind){"reject"!==c&&"delete"!==c&&"ignore"!==c&&v(oo(c)),r.undeclared=c;continue}const i=io(c,t),s=e;if("required"===e.kind){z(i)?so(r,"optional","="===i[1]?{key:e.normalized,value:i[0],default:i[2]}:{key:e.normalized,value:i[0]},t):so(r,"required",{key:e.normalized,value:i},t);continue}if(z(i)&&("?"===i[1]&&v("Only required keys may make their values optional, e.g. { [mySymbol]: ['number', '?'] }"),"="===i[1]&&v("Only required keys may specify default values, e.g. { value: 'number = 0' }")),"optional"===e.kind){so(r,"optional",{key:e.normalized,value:i},t);continue}const l=t.$.parseOwnDefinitionFormat(s.normalized,t),d=ji(l,i,t.$);d.index&&(r.index=a(r.index,d.index)),d.required&&(r.required=a(r.required,d.required))}const s=t.$.node("structure",r);return t.$.parseSchema({domain:"object",structure:n?.merge(s)??s})})(e,t);case"Array":return qo(e,t);case"RegExp":return t.$.node("intersection",{domain:"string",pattern:e},{prereduced:!0});case"Function":{const t=J(e)?e():e;return Ye(t,"root")?t:v(Bo("Function"))}default:return v(Bo(n??Ne(e)))}},qo=(e,t)=>((e,t)=>go(e)?mo[e[0]](e,t):fo(e)?po[e[1]](e,t):null)(e,t)??((e,t)=>{let n=[{}],r=0;for(;r<e.length;){let i=!1;"..."===e[r]&&r<e.length-1&&(i=!0,r++);const s=io(e[r],t),[o,a,c]=z(s)?s:[s];if(r++,i){if(!o.extends(Fe.intrinsic.Array))return v(wo(o.expression));n=n.flatMap(e=>o.distribute(t=>ko(Ge(e),t)))}else n=n.map(e=>"?"===a?xo(e,o):"="===a?vo(e,o,c):yo(e,o))}return t.$.parseSchema(n.map(e=>S(e)?{proto:Array,exactLength:0}:{proto:Array,sequence:e}))})(e,t),Bo=e=>`Type definitions must be strings or objects (was ${e})`;class Ro extends W{constructor(e){const t=Object.assign({errors:$t,hkt:G,$:e,raw:e.parse,module:e.constructor.module,scope:e.constructor.scope,define:e.define,match:e.match,generic:e.generic,schema:e.schema,keywords:e.ambient,unit:e.unit,enumerated:e.enumerated,instanceOf:e.instanceOf,valueOf:e.valueOf,or:e.or,and:e.and,merge:e.merge,pipe:e.pipe},e.ambientAttachments);super((...t)=>{if(1===t.length)return e.parse(t[0]);if(2===t.length&&"string"==typeof t[0]&&"<"===t[0][0]&&">"===t[0].at(-1)){const n=t[0].slice(1,-1),r=e.parseGenericParams(n,{});return new nn(r,t[1],e,e,null)}return e.parse(t)},{bind:e,attach:t})}}const Eo=Fe;class Ko extends Mi{get ambientAttachments(){if(Eo.typeAttachments)return this.cacheGetter("ambientAttachments",_(Eo.typeAttachments,(e,t)=>[e,this.bindReference(t)]))}preparseOwnAliasEntry(e,t){const n=e.indexOf("<");if(-1===n){if(Ye(t,"module")||Ye(t,"generic"))return[e,t];const n="ark"===this.name?e:"root"===e?this.name:`${this.name}.${e}`,r=this.resolvedConfig.keywords?.[n];return r&&(t=[t,"@",r]),[e,t]}">"!==e.at(-1)&&v("'>' must be the last character of a generic declaration in a scope");const r=e.slice(0,n),i=e.slice(n+1,-1);return[r,()=>{const e=this.parseGenericParams(i,{alias:r});var n;return new nn(e,t,n=this,n,null)}]}parseGenericParams(e,t){return Zs(new Rs(e),[],this.createParseContext({...t,def:e,prefix:"generic"}))}normalizeRootScopeValue(e){return J(e)&&!Ye(e,"generic")?e():e}preparseOwnDefinitionFormat(e,t){return{...t,def:e,prefix:t.alias??"type"}}parseOwnDefinitionFormat(e,t){t.alias&&t.alias in this.aliases||t.args||(t.args={this:t.id});const n=So(e,t);if(z(n)){if("="===n[1])return v(gs);if("?"===n[1])return v(ms)}return n}unit=e=>this.units([e]);valueOf=e=>this.units((e=>Object.values(e).filter(t=>"number"==typeof t||"number"!=typeof e[t]))(e));enumerated=(...e)=>this.units(e);instanceOf=e=>this.node("proto",{proto:e},{prereduced:!0});or=(...e)=>this.schema(e.map(e=>this.parse(e)));and=(...e)=>e.reduce((e,t)=>e.and(this.parse(t)),this.intrinsic.unknown);merge=(...e)=>e.reduce((e,t)=>e.merge(this.parse(t)),this.intrinsic.object);pipe=(...e)=>this.intrinsic.unknown.pipe(...e);match=new Xs(this);declare=()=>({type:this.type});define(e){return e}type=new Ro(this);static scope=(e,t={})=>new Ko(e,t);static module=(e,t={})=>this.scope(e,t).export()}const Lo=Object.assign(Ko.scope,{define:e=>e}),Do=Ko;const Mo=Yi(["base",rs.object],["props",rs.object])(e=>e.base.merge(e.props),class extends G{description='merge an object\'s properties onto another like `Merge(User, { isAdmin: "true" })`'}),zo=Do.module({Key:rs.key,Merge:Mo});const Uo=Yi("element")(e=>{const t=e.element.exclude(rs.Array),n=t.array();return t.rawOr(n).pipe(r).distribute(e=>e.assertHasKind("morph").declareOut(n),Gi)},class extends G{}),Fo=Do.module({root:rs.Array,readonly:"root",index:rs.nonNegativeIntegerString,liftFrom:Uo},{name:"Array"}),To=Gi(["string",ye.FileConstructor]),Po=To.rawOr(To.array()),_o=Gi({meta:"an object representing parsed form data",domain:"object",index:{signature:"string",value:Po}}),Jo=Do.module({root:["instanceof",FormData],value:To,parsed:_o,parse:Gi({in:FormData,morphs:e=>{const t={};for(const[n,r]of e)if(n in t){const e=t[n];"string"==typeof e||e instanceof ye.FileConstructor?t[n]=[e,r]:e.push(r)}else t[n]=r;return t},declaredOut:_o})},{name:"FormData"}),Vo=Do.module({Int8:["instanceof",Int8Array],Uint8:["instanceof",Uint8Array],Uint8Clamped:["instanceof",Uint8ClampedArray],Int16:["instanceof",Int16Array],Uint16:["instanceof",Uint16Array],Int32:["instanceof",Int32Array],Uint32:["instanceof",Uint32Array],Float32:["instanceof",Float32Array],Float64:["instanceof",Float64Array],BigInt64:["instanceof",BigInt64Array],BigUint64:["instanceof",BigUint64Array]},{name:"TypedArray"}),Wo={Boolean:1,Number:1,String:1},Ho=Do.module({..._({...B,...E},(e,t)=>e in Wo?[]:[e,["instanceof",t]]),Array:Fo,TypedArray:Vo,FormData:Jo}),Go=Gi({domain:{domain:"number",meta:"a number representing a Unix timestamp"},divisor:{rule:1,meta:"an integer representing a Unix timestamp"},min:{rule:-864e13,meta:"a Unix timestamp after -8640000000000000"},max:{rule:864e13,meta:"a Unix timestamp before 8640000000000000"},meta:"an integer representing a safe Unix timestamp"}),Zo=Gi({domain:"number",divisor:1}),Yo=Do.module({root:rs.number,integer:Zo,epoch:Go,safe:Gi({domain:{domain:"number",numberAllowsNaN:!1},min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER}),NaN:["===",Number.NaN],Infinity:["===",Number.POSITIVE_INFINITY],NegativeInfinity:["===",Number.NEGATIVE_INFINITY]},{name:"number"}),Qo=(e,t,n)=>{const r={domain:"string",pattern:{rule:e.source,flags:e.flags,meta:t}};return n&&(r.meta={format:n}),Zi("intersection",r)},Xo=Qo(de,"a well-formed integer string"),ea=Do.module({root:Xo,parse:Gi({in:Xo,morphs:(e,t)=>{const n=Number.parseInt(e);return Number.isSafeInteger(n)?n:t.error("an integer in the range Number.MIN_SAFE_INTEGER to Number.MAX_SAFE_INTEGER")},declaredOut:rs.integer})},{name:"string.integer"}),ta=Qo(/^[\dA-Fa-f]+$/,"hex characters only"),na=Do.module({root:Qo(/^(?:[\d+/A-Za-z]{4})*(?:[\d+/A-Za-z]{2}==|[\d+/A-Za-z]{3}=)?$/,"base64-encoded"),url:Qo(/^(?:[\w-]{4})*(?:[\w-]{2}(?:==|%3D%3D)?|[\w-]{3}(?:=|%3D)?)?$/,"base64url-encoded")},{name:"string.base64"}),ra=Qo(/^[A-Z].*$/,"capitalized"),ia=Do.module({root:Gi({in:"string",morphs:e=>e.charAt(0).toUpperCase()+e.slice(1),declaredOut:ra}),preformatted:ra},{name:"string.capitalize"}),sa=Gi({domain:"string",pattern:{meta:"a credit card number",rule:/^(?:4\d{12}(?:\d{3,6})?|5[1-5]\d{14}|(222[1-9]|22[3-9]\d|2[3-6]\d{2}|27[01]\d|2720)\d{12}|6(?:011|5\d\d)\d{12,15}|3[47]\d{13}|3(?:0[0-5]|[68]\d)\d{11}|(?:2131|1800|35\d{3})\d{11}|6[27]\d{14}|^(81\d{14,17}))$/.source},predicate:{meta:"a credit card number",predicate:e=>{const t=e.replaceAll(/[ -]+/g,"");let n,r,i=0,s=!1;for(let o=t.length-1;o>=0;o--)n=t.substring(o,o+1),r=Number.parseInt(n,10),s?(r*=2,i+=r>=10?r%10+1:r):i+=r,s=!s;return!(i%10!=0||!t)}}}),oa=/^([+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))(T((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([,.]\d+(?!:))?)?(\17[0-5]\d([,.]\d+)?)?([Zz]|([+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,aa=Gi({domain:"string",predicate:{meta:"a parsable date",predicate:e=>!Number.isNaN(new Date(e).valueOf())}}).assertHasKind("intersection"),ca=ea.root.internal.narrow((e,t)=>{const n=Number.parseInt(e),r=Yo.epoch(n);return!(r instanceof $t)||(t.errors.merge(r),!1)}).configure({description:"an integer string representing a safe Unix timestamp"},"self").assertHasKind("intersection"),la=Do.module({root:ca,parse:Gi({in:ca,morphs:e=>new Date(e),declaredOut:rs.Date})},{name:"string.date.epoch"}),da=Qo(oa,"an ISO 8601 (YYYY-MM-DDTHH:mm:ss.sssZ) date").internal.assertHasKind("intersection"),ua=Do.module({root:da,parse:Gi({in:da,morphs:e=>new Date(e),declaredOut:rs.Date})},{name:"string.date.iso"}),ha=Do.module({root:aa,parse:Gi({declaredIn:aa,in:"string",morphs:(e,t)=>{const n=new Date(e);return Number.isNaN(n.valueOf())?t.error("a parsable date"):n},declaredOut:rs.Date}),iso:ua,epoch:la},{name:"string.date"}),pa=Qo(/^[\w%+.-]+@[\d.A-Za-z-]+\.[A-Za-z]{2,}$/,"an email address","email"),fa="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",ma=`(${fa}[.]){3}${fa}`,ga=new RegExp(`^${ma}$`),ba="(?:[0-9a-fA-F]{1,4})",ya=new RegExp(`^((?:${ba}:){7}(?:${ba}|:)|(?:${ba}:){6}(?:${ma}|:${ba}|:)|(?:${ba}:){5}(?::${ma}|(:${ba}){1,2}|:)|(?:${ba}:){4}(?:(:${ba}){0,1}:${ma}|(:${ba}){1,3}|:)|(?:${ba}:){3}(?:(:${ba}){0,2}:${ma}|(:${ba}){1,4}|:)|(?:${ba}:){2}(?:(:${ba}){0,3}:${ma}|(:${ba}){1,5}|:)|(?:${ba}:){1}(?:(:${ba}){0,4}:${ma}|(:${ba}){1,6}|:)|(?::((?::${ba}){0,5}:${ma}|(?::${ba}){1,7}|:)))(%[0-9a-zA-Z.]{1,})?$`),xa=Do.module({root:["v4 | v6","@","an IP address"],v4:Qo(ga,"an IPv4 address","ipv4"),v6:Qo(ya,"an IPv6 address","ipv6")},{name:"string.ip"}),va="a JSON string",$a=e=>{if(!(e instanceof SyntaxError))throw e;return`must be ${va} (${e})`},ka=Gi({meta:va,domain:"string",predicate:{meta:va,predicate:(e,t)=>{try{return JSON.parse(e),!0}catch(n){return t.reject({code:"predicate",expected:va,problem:$a(n)})}}}}),wa=Do.module({root:ka,parse:Gi({meta:"safe JSON string parser",in:"string",morphs:(e,t)=>{if(0===e.length)return t.error({code:"predicate",expected:va,actual:"empty"});try{return JSON.parse(e)}catch(n){return t.error({code:"predicate",expected:va,problem:$a(n)})}},declaredOut:rs.jsonObject})},{name:"string.json"}),Aa=Qo(/^[a-z]*$/,"only lowercase letters"),ja=Do.module({root:Gi({in:"string",morphs:e=>e.toLowerCase(),declaredOut:Aa}),preformatted:Aa},{name:"string.lower"}),Na=["NFC","NFD","NFKC","NFKD"],Ia=_(Na,(e,t)=>[t,Gi({domain:"string",predicate:e=>e.normalize(t)===e,meta:`${t}-normalized unicode`})]),Oa=_(Na,(e,t)=>[t,Gi({in:"string",morphs:e=>e.normalize(t),declaredOut:Ia[t]})]),Sa=Do.module({root:Oa.NFC,preformatted:Ia.NFC},{name:"string.normalize.NFC"}),Ca=Do.module({root:Oa.NFD,preformatted:Ia.NFD},{name:"string.normalize.NFD"}),qa=Do.module({root:Oa.NFKC,preformatted:Ia.NFKC},{name:"string.normalize.NFKC"}),Ba=Do.module({root:Oa.NFKD,preformatted:Ia.NFKD},{name:"string.normalize.NFKD"}),Ra=Do.module({root:"NFC",NFC:Sa,NFD:Ca,NFKC:qa,NFKD:Ba},{name:"string.normalize"}),Ea=Qo(ce,"a well-formed numeric string"),Ka=Do.module({root:Ea,parse:Gi({in:Ea,morphs:e=>Number.parseFloat(e),declaredOut:rs.number})},{name:"string.numeric"}),La="a regex pattern",Da=Gi({domain:"string",predicate:{meta:La,predicate:(e,t)=>{try{return new RegExp(e),!0}catch(n){return t.reject({code:"predicate",expected:La,problem:String(n)})}}},meta:{format:"regex"}}),Ma=Qo(/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[A-Za-z-][\dA-Za-z-]*)(?:\.(?:0|[1-9]\d*|\d*[A-Za-z-][\dA-Za-z-]*))*))?(?:\+([\dA-Za-z-]+(?:\.[\dA-Za-z-]+)*))?$/,"a semantic version (see https://semver.org/)"),za=Qo(/^\S.*\S$|^\S?$/,"trimmed"),Ua=Do.module({root:Gi({in:"string",morphs:e=>e.trim(),declaredOut:za}),preformatted:za},{name:"string.trim"}),Fa=Qo(/^[A-Z]*$/,"only uppercase letters"),Ta=Do.module({root:Gi({in:"string",morphs:e=>e.toUpperCase(),declaredOut:Fa}),preformatted:Fa},{name:"string.upper"}),Pa=Gi({domain:"string",predicate:{meta:"a URL string",predicate:e=>{if(URL.canParse)return URL.canParse(e);try{return new URL(e),!0}catch{return!1}}},meta:{format:"uri"}}),_a=Do.module({root:Pa,parse:Gi({declaredIn:Pa,in:"string",morphs:(e,t)=>{try{return new URL(e)}catch{return t.error("a URL string")}},declaredOut:Gi(URL)})},{name:"string.url"}),Ja=Do.module({root:["versioned | nil | max","@",{description:"a UUID",format:"uuid"}],"#nil":"'00000000-0000-0000-0000-000000000000'","#max":"'ffffffff-ffff-ffff-ffff-ffffffffffff'","#versioned":/[\da-f]{8}-[\da-f]{4}-[1-8][\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}/i,v1:Qo(/^[\da-f]{8}-[\da-f]{4}-1[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv1"),v2:Qo(/^[\da-f]{8}-[\da-f]{4}-2[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv2"),v3:Qo(/^[\da-f]{8}-[\da-f]{4}-3[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv3"),v4:Qo(/^[\da-f]{8}-[\da-f]{4}-4[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv4"),v5:Qo(/^[\da-f]{8}-[\da-f]{4}-5[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv5"),v6:Qo(/^[\da-f]{8}-[\da-f]{4}-6[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv6"),v7:Qo(/^[\da-f]{8}-[\da-f]{4}-7[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv7"),v8:Qo(/^[\da-f]{8}-[\da-f]{4}-8[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv8")},{name:"string.uuid"}),Va=Do.module({root:rs.string,alpha:Qo(/^[A-Za-z]*$/,"only letters"),alphanumeric:Qo(/^[\dA-Za-z]*$/,"only letters and digits 0-9"),hex:ta,base64:na,capitalize:ia,creditCard:sa,date:ha,digits:Qo(/^\d*$/,"only digits 0-9"),email:pa,integer:ea,ip:xa,json:wa,lower:ja,normalize:Ra,numeric:Ka,regex:Da,semver:Ma,trim:Ua,upper:Ta,url:_a,uuid:Ja},{name:"string"}),Wa=Do.module({bigint:rs.bigint,boolean:rs.boolean,false:rs.false,never:rs.never,null:rs.null,number:rs.number,object:rs.object,string:rs.string,symbol:rs.symbol,true:rs.true,unknown:rs.unknown,undefined:rs.undefined}),Ha=Do.module({root:rs.unknown,any:rs.unknown},{name:"unknown"}),Ga=Do.module({root:rs.jsonObject,stringify:Zi("morph",{in:rs.jsonObject,morphs:e=>JSON.stringify(e),declaredOut:rs.string})},{name:"object.json"}),Za=Do.module({root:rs.object,json:Ga},{name:"object"});const Ya=Yi(["K",rs.key],"V")(e=>({domain:"object",index:{signature:e.K,value:e.V}}),class extends G{description='instantiate an object from an index signature and corresponding value type like `Record("string", "number")`'});const Qa=Yi(["T",rs.object],["K",rs.key])(e=>e.T.pick(e.K),class extends G{description='pick a set of properties from an object like `Pick(User, "name | age")`'});const Xa=Yi(["T",rs.object],["K",rs.key])(e=>e.T.omit(e.K),class extends G{description='omit a set of properties from an object like `Omit(User, "age")`'});const ec=Yi(["T",rs.object])(e=>e.T.partial(),class extends G{description="make all named properties of an object optional like `Partial(User)`"});const tc=Yi(["T",rs.object])(e=>e.T.required(),class extends G{description="make all named properties of an object required like `Required(User)`"});const nc=Yi("T","U")(e=>e.T.exclude(e.U),class extends G{description='exclude branches of a union like `Exclude("boolean", "true")`'});const rc=Yi("T","U")(e=>e.T.extract(e.U),class extends G{description='extract branches of a union like `Extract("0 | false | 1", "number")`'}),ic=Lo({...Wa,...Do.module({Exclude:nc,Extract:rc,Omit:Xa,Partial:ec,Pick:Qa,Record:Ya,Required:tc}),...Ho,...zo,string:Va,number:Yo,object:Za,unknown:Ha},{prereducedAliases:!0,name:"ark"}),sc=ic.export();Object.assign(Eo.ambient,sc),Eo.typeAttachments={string:sc.string.root,number:sc.number.root,bigint:sc.bigint,boolean:sc.boolean,symbol:sc.symbol,undefined:sc.undefined,null:sc.null,object:sc.object.root,unknown:sc.unknown.root,false:sc.false,true:sc.true,never:sc.never,arrayIndex:sc.Array.index,Key:sc.Key,Record:sc.Record,Array:sc.Array.root,Date:sc.Date};const oc=Object.assign(ic.type,Eo.typeAttachments);ic.match,ic.generic,ic.schema,ic.define,ic.declare},7293:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var r=n(6540),i=n(4848);function s(e){const{mdxAdmonitionTitle:t,rest:n}=function(e){const t=r.Children.toArray(e),n=t.find(e=>r.isValidElement(e)&&"mdxAdmonitionTitle"===e.type),s=t.filter(e=>e!==n),o=n?.props.children;return{mdxAdmonitionTitle:o,rest:s.length>0?(0,i.jsx)(i.Fragment,{children:s}):null}}(e.children),s=e.title??t;return{...e,...s&&{title:s},children:n}}var o=n(4164),a=n(1312),c=n(7559);const l="admonition_xJq3",d="admonitionHeading_Gvgb",u="admonitionIcon_Rf37",h="admonitionContent_BuS1";function p({type:e,className:t,children:n}){return(0,i.jsx)("div",{className:(0,o.A)(c.G.common.admonition,c.G.common.admonitionType(e),l,t),children:n})}function f({icon:e,title:t}){return(0,i.jsxs)("div",{className:d,children:[(0,i.jsx)("span",{className:u,children:e}),t]})}function m({children:e}){return e?(0,i.jsx)("div",{className:h,children:e}):null}function g(e){const{type:t,icon:n,title:r,children:s,className:o}=e;return(0,i.jsxs)(p,{type:t,className:o,children:[r||n?(0,i.jsx)(f,{title:r,icon:n}):null,(0,i.jsx)(m,{children:s})]})}function b(e){return(0,i.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const y={icon:(0,i.jsx)(b,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function x(e){return(0,i.jsx)(g,{...y,...e,className:(0,o.A)("alert alert--secondary",e.className),children:e.children})}function v(e){return(0,i.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const $={icon:(0,i.jsx)(v,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function k(e){return(0,i.jsx)(g,{...$,...e,className:(0,o.A)("alert alert--success",e.className),children:e.children})}function w(e){return(0,i.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const A={icon:(0,i.jsx)(w,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function j(e){return(0,i.jsx)(g,{...A,...e,className:(0,o.A)("alert alert--info",e.className),children:e.children})}function N(e){return(0,i.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const I={icon:(0,i.jsx)(N,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function O(e){return(0,i.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const S={icon:(0,i.jsx)(O,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const C={icon:(0,i.jsx)(N,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const q={...{note:x,tip:k,info:j,warning:function(e){return(0,i.jsx)(g,{...I,...e,className:(0,o.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,i.jsx)(g,{...S,...e,className:(0,o.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,i.jsx)(x,{title:"secondary",...e}),important:e=>(0,i.jsx)(j,{title:"important",...e}),success:e=>(0,i.jsx)(k,{title:"success",...e}),caution:function(e){return(0,i.jsx)(g,{...C,...e,className:(0,o.A)("alert alert--warning",e.className),children:e.children})}}};function B(e){const t=s(e),n=(r=t.type,q[r]||(console.warn(`No admonition component found for admonition type "${r}". Using Info as fallback.`),q.info));var r;return(0,i.jsx)(n,{...t})}},7910:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});n(6540);var r=n(8453),i=n(6720),s=n(4848);function o({children:e}){return(0,s.jsx)(r.x,{components:i.A,children:e})}},8046:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});n(6540);var r=n(4164),i=n(1312),s=n(8774);const o={tag:"tag_zVej",tagRegular:"tagRegular_sFm0",tagWithCount:"tagWithCount_h2kH"};var a=n(4848);function c({permalink:e,label:t,count:n,description:i}){return(0,a.jsxs)(s.A,{rel:"tag",href:e,title:i,className:(0,r.A)(o.tag,n?o.tagWithCount:o.tagRegular),children:[t,n&&(0,a.jsx)("span",{children:n})]})}const l={tags:"tags_jXut",tag:"tag_QGVx"};function d({tags:e}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("b",{children:(0,a.jsx)(i.A,{id:"theme.tags.tagsListLabel",description:"The label alongside a tag list",children:"Tags:"})}),(0,a.jsx)("ul",{className:(0,r.A)(l.tags,"padding--none","margin-left--sm"),children:e.map(e=>(0,a.jsx)("li",{className:l.tag,children:(0,a.jsx)(c,{...e})},e.permalink))})]})}},8426:(e,t)=>{function n(e){let t,n=[];for(let r of e.split(",").map(e=>e.trim()))if(/^-?\d+$/.test(r))n.push(parseInt(r,10));else if(t=r.match(/^(-?\d+)(-|\.\.\.?|\u2025|\u2026|\u22EF)(-?\d+)$/)){let[e,r,i,s]=t;if(r&&s){r=parseInt(r),s=parseInt(s);const e=r<s?1:-1;"-"!==i&&".."!==i&&"\u2025"!==i||(s+=e);for(let t=r;t!==s;t+=e)n.push(t)}}return n}t.default=n,e.exports=n},8453:(e,t,n)=>{"use strict";n.d(t,{R:()=>o,x:()=>a});var r=n(6540);const i={},s=r.createContext(i);function o(e){const t=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:t},e.children)}},9022:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});n(6540);var r=n(4164),i=n(8774),s=n(4848);function o(e){const{permalink:t,title:n,subLabel:o,isNext:a}=e;return(0,s.jsxs)(i.A,{className:(0,r.A)("pagination-nav__link",a?"pagination-nav__link--next":"pagination-nav__link--prev"),to:t,children:[o&&(0,s.jsx)("div",{className:"pagination-nav__sublabel",children:o}),(0,s.jsx)("div",{className:"pagination-nav__label",children:n})]})}}}]);